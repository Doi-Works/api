{"version":3,"sources":["meteor://ðŸ’»app/imports/api/opt-ins/server/publications.js","meteor://ðŸ’»app/imports/api/opt-ins/methods.js","meteor://ðŸ’»app/imports/api/opt-ins/opt-ins.js","meteor://ðŸ’»app/imports/api/recipients/server/publications.js","meteor://ðŸ’»app/imports/api/recipients/recipients.js","meteor://ðŸ’»app/imports/api/doichain/entries.js","meteor://ðŸ’»app/imports/api/doichain/methods.js","meteor://ðŸ’»app/imports/api/languages/methods.js","meteor://ðŸ’»app/imports/api/meta/meta.js","meteor://ðŸ’»app/imports/api/senders/senders.js","meteor://ðŸ’»app/imports/api/version/publications.js","meteor://ðŸ’»app/imports/modules/server/dapps/export_dois.js","meteor://ðŸ’»app/imports/modules/server/dapps/fetch_doi-mail-data.js","meteor://ðŸ’»app/imports/modules/server/dapps/get_doi-mail-data.js","meteor://ðŸ’»app/imports/modules/server/dns/get_opt-in-key.js","meteor://ðŸ’»app/imports/modules/server/dns/get_opt-in-provider.js","meteor://ðŸ’»app/imports/modules/server/doichain/add_entry_and_fetch_data.js","meteor://ðŸ’»app/imports/modules/server/doichain/check_new_transactions.js","meteor://ðŸ’»app/imports/modules/server/doichain/decrypt_message.js","meteor://ðŸ’»app/imports/modules/server/doichain/encrypt_message.js","meteor://ðŸ’»app/imports/modules/server/doichain/generate_name-id.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_address.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_balance.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_data-hash.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_key-pair.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_private-key_from_wif.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_publickey_and_address_by_domain.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_signature.js","meteor://ðŸ’»app/imports/modules/server/doichain/insert.js","meteor://ðŸ’»app/imports/modules/server/doichain/update.js","meteor://ðŸ’»app/imports/modules/server/doichain/verify_signature.js","meteor://ðŸ’»app/imports/modules/server/doichain/write_to_blockchain.js","meteor://ðŸ’»app/imports/modules/server/emails/decode_doi-hash.js","meteor://ðŸ’»app/imports/modules/server/emails/generate_doi-hash.js","meteor://ðŸ’»app/imports/modules/server/emails/parse_template.js","meteor://ðŸ’»app/imports/modules/server/emails/send.js","meteor://ðŸ’»app/imports/modules/server/jobs/add_check_new_transactions.js","meteor://ðŸ’»app/imports/modules/server/jobs/add_fetch-doi-mail-data.js","meteor://ðŸ’»app/imports/modules/server/jobs/add_insert_blockchain.js","meteor://ðŸ’»app/imports/modules/server/jobs/add_send_mail.js","meteor://ðŸ’»app/imports/modules/server/jobs/add_update_blockchain.js","meteor://ðŸ’»app/imports/modules/server/languages/get.js","meteor://ðŸ’»app/imports/modules/server/meta/addOrUpdate.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/add.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/add_and_write_to_blockchain.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/confirm.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/generate_doi-token.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/update_status.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/verify.js","meteor://ðŸ’»app/imports/modules/server/recipients/add.js","meteor://ðŸ’»app/imports/modules/server/senders/add.js","meteor://ðŸ’»app/imports/startup/server/dapp-configuration.js","meteor://ðŸ’»app/imports/startup/server/dns-configuration.js","meteor://ðŸ’»app/imports/startup/server/doichain-configuration.js","meteor://ðŸ’»app/imports/startup/server/email-configuration.js","meteor://ðŸ’»app/imports/startup/server/fixtures.js","meteor://ðŸ’»app/imports/startup/server/index.js","meteor://ðŸ’»app/imports/startup/server/jobs.js","meteor://ðŸ’»app/imports/startup/server/log-configuration.js","meteor://ðŸ’»app/imports/startup/server/register-api.js","meteor://ðŸ’»app/imports/startup/server/security.js","meteor://ðŸ’»app/imports/startup/server/type-configuration.js","meteor://ðŸ’»app/imports/startup/server/useraccounts-configuration.js","meteor://ðŸ’»app/server/api/rest/imports/confirm.js","meteor://ðŸ’»app/server/api/rest/imports/debug.js","meteor://ðŸ’»app/server/api/rest/imports/send.js","meteor://ðŸ’»app/server/api/rest/imports/status.js","meteor://ðŸ’»app/server/api/rest/imports/user.js","meteor://ðŸ’»app/server/api/rest/imports/verify.js","meteor://ðŸ’»app/server/api/rest/rest.js","meteor://ðŸ’»app/server/api/blockchain_jobs.js","meteor://ðŸ’»app/server/api/dapp_jobs.js","meteor://ðŸ’»app/server/api/dns.js","meteor://ðŸ’»app/server/api/doichain.js","meteor://ðŸ’»app/server/api/http.js","meteor://ðŸ’»app/server/api/index.js","meteor://ðŸ’»app/server/api/mail_jobs.js","meteor://ðŸ’»app/server/main.js"],"names":["Meteor","module","link","v","Roles","OptIns","publish","OptInsAll","userId","ready","userIsInRole","find","ownerId","fields","publicFields","DDPRateLimiter","i18n","_i18n","ValidatedMethod","_","addOptIn","default","add","name","validate","run","recipientMail","senderMail","data","error","Error","__","optIn","OPTIONS_METHODS","pluck","isServer","addRule","contains","connectionId","export","Mongo","SimpleSchema","OptInsCollection","Collection","insert","callback","ourOptIn","recipient_sender","recipient","sender","createdAt","Date","result","update","selector","modifier","remove","deny","schema","_id","type","String","regEx","RegEx","Id","optional","denyUpdate","index","Integer","nameId","txId","masterDoi","confirmedAt","confirmedBy","IP","confirmationToken","attachSchema","Recipients","recipientGet","pipeline","push","$redact","$cond","if","$cmp","then","else","$lookup","from","localField","foreignField","as","$unwind","$project","aggregate","rIds","forEach","element","RecipientEmail","recipientsAll","RecipientsCollection","ourRecipient","email","privateKey","unique","publicKey","DoichainEntries","DoichainEntriesCollection","entry","value","address","getKeyPairM","getBalanceM","getKeyPair","getBalance","logVal","OPTINS_METHODS","getLanguages","getAllLanguages","Meta","MetaCollection","ourData","key","Senders","SendersCollection","ourSender","version","DOI_MAIL_FETCH_URL","logSend","ExportDoisDataSchema","status","role","userid","id","exportDois","$match","$exists","$ne","undefined","concat","optIns","exportDoiData","JSON","stringify","exception","exportDefault","DOI_FETCH_ROUTE","DOI_CONFIRMATION_ROUTE","API_PATH","VERSION","getUrl","CONFIRM_CLIENT","CONFIRM_ADDRESS","getHttpGET","signMessage","parseTemplate","generateDoiToken","generateDoiHash","addSendMailJob","logConfirm","logError","FetchDoiMailDataSchema","domain","fetchDoiMailData","url","signature","query","encodeURIComponent","response","responseData","includes","optInId","findOne","token","confirmationHash","redirect","confirmationUrl","template","content","confirmation_url","to","subject","message","returnPath","getOptInProvider","getOptInKey","verifySignature","Accounts","GetDoiMailDataSchema","name_id","userProfileSchema","Email","templateURL","getDoiMailData","parts","split","length","provider","doiMailData","defaultReturnData","returnData","owner","users","mailTemplate","profile","resolveTxt","FALLBACK_PROVIDER","isRegtest","isTestnet","OPT_IN_KEY","OPT_IN_KEY_TESTNET","GetOptInKeySchema","ourOPT_IN_KEY","foundKey","dnskey","useFallback","PROVIDER_KEY","PROVIDER_KEY_TESTNET","GetOptInProviderSchema","ourPROVIDER_KEY","providerKey","getWif","addFetchDoiMailDataJob","getPrivateKeyFromWif","decryptMessage","AddDoichainEntrySchema","addDoichainEntry","ourEntry","ety","parse","wif","namePos","indexOf","substring","expiresIn","expired","listSinceBlock","nameShow","getRawTransaction","addOrUpdateMeta","TX_NAME_START","LAST_CHECKED_BLOCK_KEY","checkNewTransaction","txid","job","lastCheckedBlock","ret","transactions","txs","lastblock","addressTxs","filter","tx","startsWith","txName","addTx","done","vout","scriptPubKey","nameOp","op","addresses","crypto","ecies","DecryptMessageSchema","Buffer","ecdh","createECDH","setPrivateKey","decrypt","toString","EncryptMessageSchema","encryptMessage","encrypt","GenerateNameIdSchema","generateNameId","$set","CryptoJS","Base58","VERSION_BYTE","VERSION_BYTE_REGTEST","GetAddressSchema","getAddress","_getAddress","pubKey","lib","WordArray","create","SHA256","RIPEMD160","versionByte","checksum","encode","get_Balance","bal","GetDataHashSchema","getDataHash","hash","randomBytes","secp256k1","privKey","privateKeyVerify","publicKeyCreate","toUpperCase","GetPrivateKeyFromWifSchema","_getPrivateKeyFromWif","decode","endsWith","GetPublicKeySchema","getPublicKeyAndAddress","destAddress","bitcore","Message","GetSignatureSchema","getSignature","sign","PrivateKey","SEND_CLIENT","logBlockchain","feeDoi","nameDoi","InsertSchema","dataHash","soiDate","publicKeyAndAddress","nameValue","feeDoiTx","nameDoiTx","getTransaction","DOI_CONFIRMATION_NOTIFY_ROUTE","getHttpPUT","UpdateSchema","host","fromHostUrl","name_data","rerun","our_transaction","confirmations","ourfromHostUrl","updateData","cancel","restart","err","logVerify","NETWORK","Networks","alias","pubkeyhash","privatekey","scripthash","networkMagic","VerifySignatureSchema","Address","fromPublicKey","PublicKey","verify","addInsertBlockchainJob","WriteToBlockchainSchema","writeToBlockchain","HashIds","DecodeDoiHashSchema","decodeDoiHash","ourHash","hex","decodeHex","obj","GenerateDoiHashSchema","json","encodeHex","PLACEHOLDER_REGEX","ParseTemplateSchema","Object","blackbox","_match","exec","_replacePlaceholder","replace","rep","DOI_MAIL_DEFAULT_EMAIL_FROM","SendMailSchema","sendMail","mail","ourMail","send","html","headers","Job","BlockchainJobs","addCheckNewTransactionsBlockchainJob","retry","retries","wait","save","cancelRepeats","DAppJobs","AddFetchDoiMailDataJobSchema","AddInsertBlockchainJobSchema","MailJobs","AddSendMailJobSchema","AddUpdateBlockchainJobSchema","addUpdateBlockchainJob","AddOrUpdateMetaSchema","meta","AddOptInSchema","fetch","addRecipient","addSender","recipient_mail","sender_mail","master_doi","recipientId","senderId","ConfirmOptInSchema","confirmOptIn","request","ourRequest","decoded","$unset","entries","$or","doiSignature","doiTimestamp","toISOString","jsonValue","GenerateDoiTokenSchema","UpdateOptInStatusSchema","updateOptInStatus","VERIFY_CLIENT","VerifyOptInSchema","recipient_public_key","verifyOptIn","entryData","firstCheck","secondCheck","AddRecipientSchema","recipients","keyPair","AddSenderSchema","senders","isDebug","settings","app","debug","regtest","testnet","port","absoluteUrl","namecoin","SEND_APP","CONFIRM_APP","VERIFY_APP","isAppType","sendSettings","sendClient","doichain","createClient","confirmSettings","confirm","confirmClient","confirmAddress","verifySettings","verifyClient","Client","user","username","pass","password","Hashids","doiMailFetchUrl","defaultFrom","smtp","startup","process","env","MAIL_URL","server","NODE_TLS_REJECT_UNAUTHORIZED","Assets","getText","count","createUser","addUsersToRoles","startJobServer","console","sendModeTagColor","confirmModeTagColor","verifyModeTagColor","blockchainModeTagColor","testingModeTagColor","logMain","testLogging","require","msg","colors","param","time","tag","log","AUTH_METHODS","types","config","sendVerificationEmail","forbidClientAccountCreation","emailTemplates","Api","DOI_WALLETNOTIFY_ROUTE","addRoute","authRequired","get","action","urlParams","ip","connection","remoteAddress","socket","statusCode","body","params","queryParams","DOI_EXPORT_ROUTE","post","qParams","bParams","bodyParams","uid","constructor","Array","prepareCoDOI","prepareAdd","put","val","ownerID","currentOptInId","retResponse","ret_response","getInfo","ex","mailTemplateSchema","createUserSchema","updateUserSchema","collectionOptions","path","routeOptions","excludedEndpoints","endpoints","delete","roleRequired","paramId","addCollection","Restivus","apiPath","useDefaultAuth","prettyJson","JobCollection","processJobs","workTimeout","cb","fail","pause","repeat","schedule","later","text","q","pollInterval","current","setMinutes","getMinutes","ids","$in","jobStatusRemovable","updated","$lt","removeJobs","observe","added","trigger","dns","syncFunc","wrapAsync","dns_resolveTxt","records","record","trim","getServers","getAddressesByAccount","getNewAddress","NAMESPACE","client","doichain_dumpprivkey","ourAddress","cmd","accout","doichain_getaddressesbyaccount","account","ourAccount","doichain_getnewaddress","doichain_signMessage","ourMessage","doichain_nameShow","ourId","checkId","doichain_feeDoi","doichain_nameDoi","ourName","ourValue","block","doichain_listSinceBlock","ourBlock","doichain_gettransaction","doichain_getrawtransaction","doichain_getbalance","doichain_getinfo","DOI_PREFIX","ret_val","getHttpGETdata","getHttpPOST","HTTP","_get","_getData","_post","_put","ourUrl","ourQuery"],"mappings":"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","file":"/app.js","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\n\nimport { OptIns } from '../opt-ins.js';\n\nMeteor.publish('opt-ins.all', function OptInsAll() {\n  if(!this.userId) {\n    return this.ready();\n  }\n  if(!Roles.userIsInRole(this.userId, ['admin'])){\n    return OptIns.find({ownerId:this.userId}, {\n      fields: OptIns.publicFields,\n    });\n  }\n  \n\n  return OptIns.find({}, {\n    fields: OptIns.publicFields,\n  });\n});\n","import { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { _i18n as i18n } from 'meteor/universe:i18n';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { Roles } from 'meteor/alanning:roles';\nimport { _ } from 'meteor/underscore';\nimport addOptIn from '../../modules/server/opt-ins/add_and_write_to_blockchain.js';\n\nconst add = new ValidatedMethod({\n  name: 'opt-ins.add',\n  validate: null,\n  run({ recipientMail, senderMail, data }) {\n    if(!this.userId || !Roles.userIsInRole(this.userId, ['admin'])) {\n      const error = \"api.opt-ins.add.accessDenied\";\n      throw new Meteor.Error(error, i18n.__(error));\n    }\n\n    const optIn = {\n      \"recipient_mail\": recipientMail,\n      \"sender_mail\": senderMail,\n      data\n    }\n\n    addOptIn(optIn)\n  },\n});\n\n// Get list of all method names on opt-ins\nconst OPTIONS_METHODS = _.pluck([\n  add\n], 'name');\n\nif (Meteor.isServer) {\n  // Only allow 5 opt-in operations per connection per second\n  DDPRateLimiter.addRule({\n    name(name) {\n      return _.contains(OPTIONS_METHODS, name);\n    },\n\n    // Rate limit per connection ID\n    connectionId() { return true; },\n  }, 5, 1000);\n}\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nclass OptInsCollection extends Mongo.Collection {\n  insert(optIn, callback) {\n    const ourOptIn = optIn;\n    ourOptIn.recipient_sender = ourOptIn.recipient+ourOptIn.sender;\n    ourOptIn.createdAt = ourOptIn.createdAt || new Date();\n    const result = super.insert(ourOptIn, callback);\n    return result;\n  }\n  update(selector, modifier) {\n    const result = super.update(selector, modifier);\n    return result;\n  }\n  remove(selector) {\n    const result = super.remove(selector);\n    return result;\n  }\n}\n\nexport const OptIns = new OptInsCollection('opt-ins');\n\n// Deny all client-side updates since we will be using methods to manage this collection\nOptIns.deny({\n  insert() { return true; },\n  update() { return true; },\n  remove() { return true; },\n});\n\nOptIns.schema = new SimpleSchema({\n  _id: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Id,\n  },\n  recipient: {\n    type: String,\n    optional: true,\n    denyUpdate: true,\n  },\n  sender: {\n    type: String,\n    optional: true,\n    denyUpdate: true,\n  },\n  data: {\n    type: String,\n    optional: true,\n    denyUpdate: false,\n  },\n  index: {\n    type: SimpleSchema.Integer,\n    optional: true,\n    denyUpdate: false,\n  },\n  nameId: {\n    type: String,\n    optional: true,\n    denyUpdate: false,\n  },\n  txId: {\n      type: String,\n      optional: true,\n      denyUpdate: false,\n  },\n  masterDoi: {\n      type: String,\n      optional: true,\n      denyUpdate: false,\n  },\n  createdAt: {\n    type: Date,\n    denyUpdate: true,\n  },\n  confirmedAt: {\n    type: Date,\n    optional: true,\n    denyUpdate: false,\n  },\n  confirmedBy: {\n    type: String,\n    regEx: SimpleSchema.RegEx.IP,\n    optional: true,\n    denyUpdate: false\n  },\n  confirmationToken: {\n    type: String,\n    optional: true,\n    denyUpdate: false\n  },\n  ownerId:{\n    type: String,\n    optional: true,\n    regEx: SimpleSchema.RegEx.Id\n  },\n  error:{\n      type: String,\n      optional: true,\n      denyUpdate: false\n  }\n});\n\nOptIns.attachSchema(OptIns.schema);\n\n// This represents the keys from Opt-In objects that should be published\n// to the client. If we add secret properties to Opt-In objects, don't list\n// them here to keep them private to the server.\nOptIns.publicFields = {\n  _id: 1,\n  recipient: 1,\n  sender: 1,\n  data: 1,\n  index: 1,\n  nameId: 1,\n  txId: 1,\n  masterDoi: 1,\n  createdAt: 1,\n  confirmedAt: 1,\n  confirmedBy: 1,\n  ownerId: 1,\n  error: 1\n};\n","import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\n\nimport { Recipients } from '../recipients.js';\nimport { OptIns} from '../../opt-ins/opt-ins.js'\nMeteor.publish('recipients.byOwner',function recipientGet(){\n  let pipeline=[];\n  if(!Roles.userIsInRole(this.userId, ['admin'])){\n    pipeline.push(\n      {$redact:{\n      $cond: {\n        if: { $cmp: [ \"$ownerId\", this.userId ] },\n        then: \"$$PRUNE\",\n        else: \"$$KEEP\" }}});\n      }\n      pipeline.push({ $lookup: { from: \"recipients\", localField: \"recipient\", foreignField: \"_id\", as: \"RecipientEmail\" } });\n      pipeline.push({ $unwind: \"$RecipientEmail\"});\n      pipeline.push({ $project: {\"RecipientEmail._id\":1}});\n\n      const result = OptIns.aggregate(pipeline);\n      let rIds=[];\n      result.forEach(element => {\n        rIds.push(element.RecipientEmail._id);\n      });\n  return Recipients.find({\"_id\":{\"$in\":rIds}},{fields:Recipients.publicFields});\n});\nMeteor.publish('recipients.all', function recipientsAll() {\n  if(!this.userId || !Roles.userIsInRole(this.userId, ['admin'])) {\n    return this.ready();\n  }\n\n  return Recipients.find({}, {\n    fields: Recipients.publicFields,\n  });\n});\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nclass RecipientsCollection extends Mongo.Collection {\n  insert(recipient, callback) {\n    const ourRecipient = recipient;\n    ourRecipient.createdAt = ourRecipient.createdAt || new Date();\n    const result = super.insert(ourRecipient, callback);\n    return result;\n  }\n  update(selector, modifier) {\n    const result = super.update(selector, modifier);\n    return result;\n  }\n  remove(selector) {\n    const result = super.remove(selector);\n    return result;\n  }\n}\n\nexport const Recipients = new RecipientsCollection('recipients');\n\n// Deny all client-side updates since we will be using methods to manage this collection\nRecipients.deny({\n  insert() { return true; },\n  update() { return true; },\n  remove() { return true; },\n});\n\nRecipients.schema = new SimpleSchema({\n  _id: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Id,\n  },\n  email: {\n    type: String,\n    index: true,\n    denyUpdate: true,\n  },\n  privateKey: {\n    type: String,\n    unique: true,\n    denyUpdate: true,\n  },\n  publicKey: {\n    type: String,\n    unique: true,\n    denyUpdate: true,\n  },\n  createdAt: {\n    type: Date,\n    denyUpdate: true,\n  }\n});\n\nRecipients.attachSchema(Recipients.schema);\n\n// This represents the keys from Recipient objects that should be published\n// to the client. If we add secret properties to Recipient objects, don't list\n// them here to keep them private to the server.\nRecipients.publicFields = {\n  _id: 1,\n  email: 1,\n  publicKey: 1,\n  createdAt: 1\n};\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nclass DoichainEntriesCollection extends Mongo.Collection {\n  insert(entry, callback) {\n    const result = super.insert(entry, callback);\n    return result;\n  }\n  update(selector, modifier) {\n    const result = super.update(selector, modifier);\n    return result;\n  }\n  remove(selector) {\n    const result = super.remove(selector);\n    return result;\n  }\n}\n\nexport const DoichainEntries = new DoichainEntriesCollection('doichain-entries');\n\n// Deny all client-side updates since we will be using methods to manage this collection\nDoichainEntries.deny({\n  insert() { return true; },\n  update() { return true; },\n  remove() { return true; },\n});\n\nDoichainEntries.schema = new SimpleSchema({\n  _id: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Id,\n  },\n  name: {\n    type: String,\n    index: true,\n    denyUpdate: true\n  },\n  value: {\n    type: String,\n    denyUpdate: false\n  },\n  address: {\n    type: String,\n    denyUpdate: false\n  },\n  masterDoi: {\n        type: String,\n        optional: true,\n        index: true,\n        denyUpdate: true\n  },\n  index: {\n        type: SimpleSchema.Integer,\n        optional: true,\n        denyUpdate: true\n  },\n  txId: {\n    type: String,\n    denyUpdate: false\n  }\n});\n\nDoichainEntries.attachSchema(DoichainEntries.schema);\n\n// This represents the keys from Entry objects that should be published\n// to the client. If we add secret properties to Entry objects, don't list\n// them here to keep them private to the server.\nDoichainEntries.publicFields = {\n  _id: 1,\n  name: 1,\n  value: 1,\n  address: 1,\n  masterDoi: 1,\n  index: 1,\n  txId: 1\n};\n","import { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport getKeyPairM from '../../modules/server/doichain/get_key-pair.js';\nimport getBalanceM from '../../modules/server/doichain/get_balance.js';\n\n\nconst getKeyPair = new ValidatedMethod({\n  name: 'doichain.getKeyPair',\n  validate: null,\n  run() {\n    return getKeyPairM();\n  },\n});\n\nconst getBalance = new ValidatedMethod({\n  name: 'doichain.getBalance',\n  validate: null,\n  run() {\n    const logVal = getBalanceM();\n    return logVal;\n  },\n});\n\n\n// Get list of all method names on doichain\nconst OPTINS_METHODS = _.pluck([\n  getKeyPair\n,getBalance], 'name');\n\nif (Meteor.isServer) {\n  // Only allow 5 opt-in operations per connection per second\n  DDPRateLimiter.addRule({\n    name(name) {\n      return _.contains(OPTINS_METHODS, name);\n    },\n\n    // Rate limit per connection ID\n    connectionId() { return true; },\n  }, 5, 1000);\n}\n","import { Meteor} from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport getLanguages from '../../modules/server/languages/get.js';\n\nconst getAllLanguages = new ValidatedMethod({\n  name: 'languages.getAll',\n  validate: null,\n  run() {\n    return getLanguages();\n  },\n});\n\n// Get list of all method names on languages\nconst OPTINS_METHODS = _.pluck([\n  getAllLanguages\n], 'name');\n\nif (Meteor.isServer) {\n  // Only allow 5 opt-in operations per connection per second\n  DDPRateLimiter.addRule({\n    name(name) {\n      return _.contains(OPTINS_METHODS, name);\n    },\n\n    // Rate limit per connection ID\n    connectionId() { return true; },\n  }, 5, 1000);\n}\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nclass MetaCollection extends Mongo.Collection {\n  insert(data, callback) {\n    const ourData = data;\n    const result = super.insert(ourData, callback);\n    return result;\n  }\n  update(selector, modifier) {\n    const result = super.update(selector, modifier);\n    return result;\n  }\n  remove(selector) {\n    const result = super.remove(selector);\n    return result;\n  }\n}\n\nexport const Meta = new MetaCollection('meta');\n\n// Deny all client-side updates since we will be using methods to manage this collection\nMeta.deny({\n  insert() { return true; },\n  update() { return true; },\n  remove() { return true; },\n});\n\nMeta.schema = new SimpleSchema({\n  _id: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Id,\n  },\n  key: {\n    type: String,\n    index: true,\n    denyUpdate: true\n  },\n  value: {\n    type: String\n  }\n});\n\nMeta.attachSchema(Meta.schema);\n\n// This represents the keys from Meta objects that should be published\n// to the client. If we add secret properties to Meta objects, don't list\n// them here to keep them private to the server.\nMeta.publicFields = {\n};\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nclass SendersCollection extends Mongo.Collection {\n  insert(sender, callback) {\n    const ourSender = sender;\n    ourSender.createdAt = ourSender.createdAt || new Date();\n    const result = super.insert(ourSender, callback);\n    return result;\n  }\n  update(selector, modifier) {\n    const result = super.update(selector, modifier);\n    return result;\n  }\n  remove(selector) {\n    const result = super.remove(selector);\n    return result;\n  }\n}\n\nexport const Senders = new SendersCollection('senders');\n\n// Deny all client-side updates since we will be using methods to manage this collection\nSenders.deny({\n  insert() { return true; },\n  update() { return true; },\n  remove() { return true; },\n});\n\nSenders.schema = new SimpleSchema({\n  _id: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Id,\n  },\n  email: {\n    type: String,\n    index: true,\n    denyUpdate: true,\n  },\n  createdAt: {\n    type: Date,\n    denyUpdate: true,\n  }\n});\n\nSenders.attachSchema(Senders.schema);\n\n// This represents the keys from Sender objects that should be published\n// to the client. If we add secret properties to Sender objects, don't list\n// them here to keep them private to the server.\nSenders.publicFields = {\n  email: 1,\n  createdAt: 1\n};\n","import { Meteor} from 'meteor/meteor';\nimport { Meta } from '../meta/meta';\n\nMeteor.publish('version', function version() {\n  return Meta.find({});\n});\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { DOI_MAIL_FETCH_URL } from '../../../startup/server/email-configuration.js';\nimport {logSend} from \"../../../startup/server/log-configuration\";\nimport {OptIns} from \"../../../api/opt-ins/opt-ins\";\n\nconst ExportDoisDataSchema = new SimpleSchema({\n  status: {\n    type: String,\n    optional: true,\n  },\n  role:{\n    type:String\n  },\n  userid:{\n    type: String,\n    regEx: SimpleSchema.RegEx.id,\n    optional:true \n  }\n});\n\n//TODO add sender and recipient email address to export\n\nconst exportDois = (data) => {\n  try {\n    const ourData = data;\n    ExportDoisDataSchema.validate(ourData);\n    let pipeline=[{ $match: {\"confirmedAt\":{ $exists: true, $ne: null }} }];\n    \n    if(ourData.role!='admin'||ourData.userid!=undefined){\n      pipeline.push({ $redact:{\n        $cond: {\n          if: { $cmp: [ \"$ownerId\", ourData.userid ] },\n          then: \"$$PRUNE\",\n          else: \"$$KEEP\" }}});\n    }\n    pipeline.concat([\n        { $lookup: { from: \"recipients\", localField: \"recipient\", foreignField: \"_id\", as: \"RecipientEmail\" } },\n        { $lookup: { from: \"senders\", localField: \"sender\", foreignField: \"_id\", as: \"SenderEmail\" } },\n        { $unwind: \"$SenderEmail\"},\n        { $unwind: \"$RecipientEmail\"},\n        { $project: {\"_id\":1,\"createdAt\":1, \"confirmedAt\":1,\"nameId\":1, \"SenderEmail.email\":1,\"RecipientEmail.email\":1}}\n    ]);\n    //if(ourData.status==1) query = {\"confirmedAt\": { $exists: true, $ne: null }}\n\n    let optIns =  OptIns.aggregate(pipeline);\n    let exportDoiData;\n    try {\n        exportDoiData = optIns;\n        logSend('exportDoi url:',DOI_MAIL_FETCH_URL,JSON.stringify(exportDoiData));\n      return exportDoiData\n\n    } catch(error) {\n      throw \"Error while exporting dois: \"+error;\n    }\n\n  } catch (exception) {\n    throw new Meteor.Error('dapps.exportDoi.exception', exception);\n  }\n};\n\nexport default exportDois;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { DOI_FETCH_ROUTE, DOI_CONFIRMATION_ROUTE, API_PATH, VERSION } from '../../../../server/api/rest/rest.js';\nimport { getUrl } from '../../../startup/server/dapp-configuration.js';\nimport { CONFIRM_CLIENT, CONFIRM_ADDRESS } from '../../../startup/server/doichain-configuration.js';\nimport { getHttpGET } from '../../../../server/api/http.js';\nimport { signMessage } from '../../../../server/api/doichain.js';\nimport { OptIns } from '../../../../imports/api/opt-ins/opt-ins.js';\nimport parseTemplate from '../emails/parse_template.js';\nimport generateDoiToken from '../opt-ins/generate_doi-token.js';\nimport generateDoiHash from '../emails/generate_doi-hash.js';\nimport addOptIn from '../opt-ins/add.js';\nimport addSendMailJob from '../jobs/add_send_mail.js';\nimport {logConfirm, logError} from \"../../../startup/server/log-configuration\";\n\nconst FetchDoiMailDataSchema = new SimpleSchema({\n  name: {\n    type: String\n  },\n  domain: {\n    type: String\n  }\n});\n\n\nconst fetchDoiMailData = (data) => {\n  try {\n    const ourData = data;\n    FetchDoiMailDataSchema.validate(ourData);\n    const url = ourData.domain+API_PATH+VERSION+\"/\"+DOI_FETCH_ROUTE;\n    const signature = signMessage(CONFIRM_CLIENT, CONFIRM_ADDRESS, ourData.name);\n    const query = \"name_id=\"+encodeURIComponent(ourData.name)+\"&signature=\"+encodeURIComponent(signature);\n    logConfirm('calling for doi-email-template:'+url+' query:', query);\n\n    /**\n      TODO when running Send-dApp in Testnet behind NAT this URL will not be accessible from the internet\n      but even when we use the URL from localhost verify andn others will fails.\n     */\n    const response = getHttpGET(url, query);\n    if(response === undefined || response.data === undefined) throw \"Bad response\";\n    const responseData = response.data;\n    logConfirm('response while getting getting email template from URL:',response.data.status);\n\n    if(responseData.status !== \"success\") {\n      if(responseData.error === undefined) throw \"Bad response\";\n      if(responseData.error.includes(\"Opt-In not found\")) {\n        //Do nothing and don't throw error so job is done\n          logError('response data from Send-dApp:',responseData.error);\n        return;\n      }\n      throw responseData.error;\n    }\n    logConfirm('DOI Mail data fetched.');\n\n    const optInId = addOptIn({name: ourData.name});\n    const optIn = OptIns.findOne({_id: optInId});\n    logConfirm('opt-in found:',optIn);\n    if(optIn.confirmationToken !== undefined) return;\n\n    const token = generateDoiToken({id: optIn._id});\n    logConfirm('generated confirmationToken:',token);\n    const confirmationHash = generateDoiHash({id: optIn._id, token: token, redirect: responseData.data.redirect});\n    logConfirm('generated confirmationHash:',confirmationHash);\n    const confirmationUrl = getUrl()+API_PATH+VERSION+\"/\"+DOI_CONFIRMATION_ROUTE+\"/\"+encodeURIComponent(confirmationHash);\n    logConfirm('confirmationUrl:'+confirmationUrl);\n\n    const template = parseTemplate({template: responseData.data.content, data: {\n      confirmation_url: confirmationUrl\n    }});\n\n    //logConfirm('we are using this template:',template);\n\n    logConfirm('sending email to peter for confirmation over bobs dApp');\n    addSendMailJob({\n      to: responseData.data.recipient,\n      subject: responseData.data.subject,\n      message: template,\n      returnPath: responseData.data.returnPath\n    });\n  } catch (exception) {\n    throw new Meteor.Error('dapps.fetchDoiMailData.exception', exception);\n  }\n};\n\nexport default fetchDoiMailData;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport { Recipients } from '../../../api/recipients/recipients.js';\nimport getOptInProvider from '../dns/get_opt-in-provider.js';\nimport getOptInKey from '../dns/get_opt-in-key.js';\nimport verifySignature from '../doichain/verify_signature.js';\nimport { getHttpGET } from '../../../../server/api/http.js';\nimport { DOI_MAIL_FETCH_URL } from '../../../startup/server/email-configuration.js';\nimport { logSend } from \"../../../startup/server/log-configuration\";\nimport { Accounts } from 'meteor/accounts-base'\n\nconst GetDoiMailDataSchema = new SimpleSchema({\n  name_id: {\n    type: String\n  },\n  signature: {\n    type: String\n  }\n});\n\nconst userProfileSchema = new SimpleSchema({\n  subject: {\n    type: String,\n    optional:true\n  },\n  redirect: {\n    type: String,\n    regEx: \"@(https?|ftp)://(-\\\\.)?([^\\\\s/?\\\\.#-]+\\\\.?)+(/[^\\\\s]*)?$@\",\n    optional:true\n  },\n  returnPath: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email,\n    optional:true\n  },\n  templateURL: {\n    type: String,\n    regEx: \"@(https?|ftp)://(-\\\\.)?([^\\\\s/?\\\\.#-]+\\\\.?)+(/[^\\\\s]*)?$@\",\n    optional:true\n  }\n});\n\nconst getDoiMailData = (data) => {\n  try {\n    const ourData = data;\n    GetDoiMailDataSchema.validate(ourData);\n    const optIn = OptIns.findOne({nameId: ourData.name_id});\n    if(optIn === undefined) throw \"Opt-In with name_id: \"+ourData.name_id+\" not found\";\n    logSend('Opt-In found',optIn);\n\n    const recipient = Recipients.findOne({_id: optIn.recipient});\n    if(recipient === undefined) throw \"Recipient not found\";\n    logSend('Recipient found', recipient);\n\n    const parts = recipient.email.split(\"@\");\n    const domain = parts[parts.length-1];\n\n    let publicKey = getOptInKey({ domain: domain});\n\n    if(!publicKey){\n      const provider = getOptInProvider({domain: ourData.domain });\n      logSend(\"using doichain provider instead of directly configured publicKey:\", { provider: provider });\n      publicKey = getOptInKey({ domain: provider}); //get public key from provider or fallback if publickey was not set in dns\n    }\n\n    logSend('queried data: (parts, domain, provider, publicKey)', '('+parts+','+domain+','+publicKey+')');\n\n    //TODO: Only allow access one time\n    // Possible solution:\n    // 1. Provider (confirm dApp) request the data\n    // 2. Provider receive the data\n    // 3. Provider sends confirmation \"I got the data\"\n    // 4. Send dApp lock the data for this opt in\n    logSend('verifying signature...');\n    if(!verifySignature({publicKey: publicKey, data: ourData.name_id, signature: ourData.signature})) {\n      throw \"signature incorrect - access denied\";\n    }\n    \n    logSend('signature verified');\n\n    //TODO: Query for language\n    let doiMailData;\n    try {\n\n      doiMailData = getHttpGET(DOI_MAIL_FETCH_URL, \"\").data;\n      let defaultReturnData = {\n        \"recipient\": recipient.email,\n        \"content\": doiMailData.data.content,\n        \"redirect\": doiMailData.data.redirect,\n        \"subject\": doiMailData.data.subject,\n        \"returnPath\": doiMailData.data.returnPath\n      }\n\n    let returnData = defaultReturnData;\n\n    try{\n      let owner = Accounts.users.findOne({_id: optIn.ownerId});\n      let mailTemplate = owner.profile.mailTemplate;\n      userProfileSchema.validate(mailTemplate);\n\n      returnData[\"redirect\"] = mailTemplate[\"redirect\"] || defaultReturnData[\"redirect\"];\n      returnData[\"subject\"] = mailTemplate[\"subject\"] || defaultReturnData[\"subject\"];\n      returnData[\"returnPath\"] = mailTemplate[\"returnPath\"] || defaultReturnData[\"returnPath\"];\n      returnData[\"content\"] = mailTemplate[\"templateURL\"] ? (getHttpGET(mailTemplate[\"templateURL\"], \"\").content || defaultReturnData[\"content\"]) : defaultReturnData[\"content\"];\n      \n    }\n    catch(error) {\n      returnData=defaultReturnData;\n    }\n\n      logSend('doiMailData and url:', DOI_MAIL_FETCH_URL, returnData);\n\n      return returnData\n\n    } catch(error) {\n      throw \"Error while fetching mail content: \"+error;\n    }\n\n  } catch(exception) {\n    throw new Meteor.Error('dapps.getDoiMailData.exception', exception);\n  }\n};\n\nexport default getDoiMailData;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { resolveTxt } from '../../../../server/api/dns.js';\nimport { FALLBACK_PROVIDER } from '../../../startup/server/dns-configuration.js';\nimport {isRegtest, isTestnet} from \"../../../startup/server/dapp-configuration\";\nimport {logSend} from \"../../../startup/server/log-configuration\";\n\nconst OPT_IN_KEY = \"doichain-opt-in-key\";\nconst OPT_IN_KEY_TESTNET = \"doichain-testnet-opt-in-key\";\n\nconst GetOptInKeySchema = new SimpleSchema({\n  domain: {\n    type: String\n  }\n});\n\n\nconst getOptInKey = (data) => {\n  try {\n    const ourData = data;\n    GetOptInKeySchema.validate(ourData);\n\n    let ourOPT_IN_KEY=OPT_IN_KEY;\n\n    if(isRegtest() || isTestnet()){\n        ourOPT_IN_KEY = OPT_IN_KEY_TESTNET;\n        logSend('Using RegTest:'+isRegtest()+\" Testnet: \"+isTestnet()+\" ourOPT_IN_KEY\",ourOPT_IN_KEY);\n    }\n    const key = resolveTxt(ourOPT_IN_KEY, ourData.domain);\n    logSend('DNS TXT configured public key of recipient email domain and confirmation dapp',{foundKey:key, domain:ourData.domain, dnskey:ourOPT_IN_KEY});\n\n    if(key === undefined) return useFallback(ourData.domain);\n    return key;\n  } catch (exception) {\n    throw new Meteor.Error('dns.getOptInKey.exception', exception);\n  }\n};\n\nconst useFallback = (domain) => {\n  if(domain === FALLBACK_PROVIDER) throw new Meteor.Error(\"Fallback has no key defined!\");\n    logSend(\"Key not defined. Using fallback: \",FALLBACK_PROVIDER);\n  return getOptInKey({domain: FALLBACK_PROVIDER});\n};\n\nexport default getOptInKey;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { resolveTxt } from '../../../../server/api/dns.js';\nimport { FALLBACK_PROVIDER } from '../../../startup/server/dns-configuration.js';\nimport {logSend} from \"../../../startup/server/log-configuration\";\nimport {isRegtest, isTestnet} from \"../../../startup/server/dapp-configuration\";\n\nconst PROVIDER_KEY = \"doichain-opt-in-provider\";\nconst PROVIDER_KEY_TESTNET = \"doichain-testnet-opt-in-provider\";\n\nconst GetOptInProviderSchema = new SimpleSchema({\n  domain: {\n    type: String\n  }\n});\n\n\nconst getOptInProvider = (data) => {\n  try {\n    const ourData = data;\n    GetOptInProviderSchema.validate(ourData);\n\n    let ourPROVIDER_KEY=PROVIDER_KEY;\n    if(isRegtest() || isTestnet()){\n        ourPROVIDER_KEY = PROVIDER_KEY_TESTNET;\n        logSend('Using RegTest:'+isRegtest()+\" : Testnet:\"+isTestnet()+\" PROVIDER_KEY\",{providerKey:ourPROVIDER_KEY, domain:ourData.domain});\n    }\n\n    const provider = resolveTxt(ourPROVIDER_KEY, ourData.domain);\n    if(provider === undefined) return useFallback();\n\n    logSend('opt-in-provider from dns - server of mail recipient: (TXT):',provider);\n    return provider;\n  } catch (exception) {\n    throw new Meteor.Error('dns.getOptInProvider.exception', exception);\n  }\n};\n\nconst useFallback = () => {\n  logSend('Provider not defined. Fallback '+FALLBACK_PROVIDER+' is used');\n  return FALLBACK_PROVIDER;\n};\n\nexport default getOptInProvider;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { CONFIRM_CLIENT, CONFIRM_ADDRESS } from '../../../startup/server/doichain-configuration.js';\nimport { getWif } from '../../../../server/api/doichain.js';\nimport { DoichainEntries } from '../../../api/doichain/entries.js';\nimport addFetchDoiMailDataJob from '../jobs/add_fetch-doi-mail-data.js';\nimport getPrivateKeyFromWif from './get_private-key_from_wif.js';\nimport decryptMessage from './decrypt_message.js';\nimport {logConfirm, logSend} from \"../../../startup/server/log-configuration\";\n\nconst AddDoichainEntrySchema = new SimpleSchema({\n  name: {\n    type: String\n  },\n  value: {\n    type: String\n  },\n  address: {\n    type: String\n  },\n  txId: {\n    type: String\n  }\n});\n\n/**\n * Inserts\n *\n * @param entry\n * @returns {*}\n */\nconst addDoichainEntry = (entry) => {\n  try {\n\n    const ourEntry = entry;\n    logConfirm('adding DoichainEntry on Bob...',ourEntry.name);\n    AddDoichainEntrySchema.validate(ourEntry);\n\n    const ety = DoichainEntries.findOne({name: ourEntry.name});\n    if(ety !== undefined){\n        logSend('returning locally saved entry with _id:'+ety._id);\n        return ety._id;\n    }\n\n    const value = JSON.parse(ourEntry.value);\n    //logSend(\"value:\",value);\n    if(value.from === undefined) throw \"Wrong blockchain entry\"; //TODO if from is missing but value is there, it is probably allready handeled correctly anyways this is not so cool as it seems.\n    const wif = getWif(CONFIRM_CLIENT, CONFIRM_ADDRESS);\n    const privateKey = getPrivateKeyFromWif({wif: wif});\n    logSend('got private key (will not show it here)');\n\n    const domain = decryptMessage({privateKey: privateKey, message: value.from});\n    logSend('decrypted message from domain: ',domain);\n\n    const namePos = ourEntry.name.indexOf('-'); //if this is not a co-registration fetch mail.\n    logSend('namePos:',namePos);\n    const masterDoi = (namePos!=-1)?ourEntry.name.substring(0,namePos):undefined;\n    logSend('masterDoi:',masterDoi);\n    const index = masterDoi?ourEntry.name.substring(namePos+1):undefined;\n    logSend('index:',index);\n\n    const id = DoichainEntries.insert({\n        name: ourEntry.name,\n        value: ourEntry.value,\n        address: ourEntry.address,\n        masterDoi: masterDoi,\n        index: index,\n        txId: ourEntry.txId,\n        expiresIn: ourEntry.expiresIn,\n        expired: ourEntry.expired\n    });\n\n    logSend('DoichainEntry added on Bob:', {id:id,name:ourEntry.name,masterDoi:masterDoi,index:index});\n\n    if(!masterDoi){\n        addFetchDoiMailDataJob({\n            name: ourEntry.name,\n            domain: domain\n        });\n        logSend('New entry added: \\n'+\n            'NameId='+ourEntry.name+\"\\n\"+\n            'Address='+ourEntry.address+\"\\n\"+\n            'TxId='+ourEntry.txId+\"\\n\"+\n            'Value='+ourEntry.value);\n\n    }else{\n        logSend('This transaction belongs to co-registration', masterDoi);\n    }\n\n    return id;\n  } catch (exception) {\n    throw new Meteor.Error('doichain.addEntryAndFetchData.exception', exception);\n  }\n};\n\nexport default addDoichainEntry;\n","import { Meteor } from 'meteor/meteor';\nimport { listSinceBlock, nameShow, getRawTransaction} from '../../../../server/api/doichain.js';\nimport { CONFIRM_CLIENT, CONFIRM_ADDRESS } from '../../../startup/server/doichain-configuration.js';\nimport addDoichainEntry from './add_entry_and_fetch_data.js'\nimport { Meta } from '../../../api/meta/meta.js';\nimport addOrUpdateMeta from '../meta/addOrUpdate.js';\nimport {logConfirm} from \"../../../startup/server/log-configuration\";\n\nconst TX_NAME_START = \"e/\";\nconst LAST_CHECKED_BLOCK_KEY = \"lastCheckedBlock\";\n\nconst checkNewTransaction = (txid, job) => {\n  try {\n\n      if(!txid){\n          logConfirm(\"checkNewTransaction triggered when starting node - checking all confirmed blocks since last check for doichain address\",CONFIRM_ADDRESS);\n\n          try {\n              var lastCheckedBlock = Meta.findOne({key: LAST_CHECKED_BLOCK_KEY});\n              if(lastCheckedBlock !== undefined) lastCheckedBlock = lastCheckedBlock.value;\n              logConfirm(\"lastCheckedBlock\",lastCheckedBlock);\n              const ret = listSinceBlock(CONFIRM_CLIENT, lastCheckedBlock);\n              if(ret === undefined || ret.transactions === undefined) return;\n\n              const txs = ret.transactions;\n              lastCheckedBlock = ret.lastblock;\n              if(!ret || !txs || !txs.length===0){\n                  logConfirm(\"transactions do not contain nameOp transaction details or transaction not found.\", lastCheckedBlock);\n                  addOrUpdateMeta({key: LAST_CHECKED_BLOCK_KEY, value: lastCheckedBlock});\n                  return;\n              }\n\n              logConfirm(\"listSinceBlock\",ret);\n\n              const addressTxs = txs.filter(tx =>\n                  tx.address === CONFIRM_ADDRESS\n                  && tx.name !== undefined //since name_show cannot be read without confirmations\n                  && tx.name.startsWith(\"doi: \"+TX_NAME_START)  //here 'doi: e/xxxx' is already written in the block\n              );\n              addressTxs.forEach(tx => {\n                  logConfirm(\"tx:\",tx);\n                  var txName = tx.name.substring((\"doi: \"+TX_NAME_START).length);\n                  logConfirm(\"excuting name_show in order to get value of nameId:\", txName);\n                  const ety = nameShow(CONFIRM_CLIENT, txName);\n                  logConfirm(\"nameShow: value\",ety);\n                  if(!ety){\n                      logConfirm(\"couldn't find name - obviously not (yet?!) confirmed in blockchain:\", ety);\n                      return;\n                  }\n                  addTx(txName, ety.value,tx.address,tx.txid); //TODO ety.value.from is maybe NOT existing because of this its  (maybe) ont working...\n              });\n              addOrUpdateMeta({key: LAST_CHECKED_BLOCK_KEY, value: lastCheckedBlock});\n              logConfirm(\"Transactions updated - lastCheckedBlock:\",lastCheckedBlock);\n              job.done();\n          } catch(exception) {\n              throw new Meteor.Error('namecoin.checkNewTransactions.exception', exception);\n          }\n\n      }else{\n          logConfirm(\"txid: \"+txid+\" was triggered by walletnotify for address:\",CONFIRM_ADDRESS);\n\n          const ret = getRawTransaction(CONFIRM_CLIENT, txid);\n          const txs = ret.vout;\n\n          if(!ret || !txs || !txs.length===0){\n              logConfirm(\"txid \"+txid+' does not contain transaction details or transaction not found.');\n              return;\n          }\n         // logConfirm('now checking raw transactions with filter:',txs);\n\n          const addressTxs = txs.filter(tx =>\n              tx.scriptPubKey !== undefined\n              && tx.scriptPubKey.nameOp !== undefined\n              && tx.scriptPubKey.nameOp.op === \"name_doi\"\n            //  && tx.scriptPubKey.addresses[0] === CONFIRM_ADDRESS //only own transaction should arrive here. - so check on own address unneccesary\n              && tx.scriptPubKey.nameOp.name !== undefined\n              && tx.scriptPubKey.nameOp.name.startsWith(TX_NAME_START)\n          );\n\n          //logConfirm(\"found name_op transactions:\", addressTxs);\n          addressTxs.forEach(tx => {\n              addTx(tx.scriptPubKey.nameOp.name, tx.scriptPubKey.nameOp.value,tx.scriptPubKey.addresses[0],txid);\n          });\n      }\n  } catch(exception) {\n    throw new Meteor.Error('doichain.checkNewTransactions.exception', exception);\n  }\n  return true;\n};\n\n\nfunction addTx(name, value, address, txid) {\n    const txName = name.substring(TX_NAME_START.length);\n\n    addDoichainEntry({\n        name: txName,\n        value: value,\n        address: address,\n        txId: txid\n    });\n}\n\nexport default checkNewTransaction;\n\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport crypto from 'crypto';\nimport ecies from 'standard-ecies';\n\nconst DecryptMessageSchema = new SimpleSchema({\n  privateKey: {\n    type: String\n  },\n  message: {\n    type: String\n  }\n});\n\nconst decryptMessage = (data) => {\n  try {\n    const ourData = data;\n    DecryptMessageSchema.validate(ourData);\n    const privateKey = Buffer.from(ourData.privateKey, 'hex');\n    const ecdh = crypto.createECDH('secp256k1');\n    ecdh.setPrivateKey(privateKey);\n    const message = Buffer.from(ourData.message, 'hex');\n    return ecies.decrypt(ecdh, message).toString('utf8');\n  } catch(exception) {\n    throw new Meteor.Error('doichain.decryptMessage.exception', exception);\n  }\n};\n\nexport default decryptMessage;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport ecies from 'standard-ecies';\n\nconst EncryptMessageSchema = new SimpleSchema({\n  publicKey: {\n    type: String\n  },\n  message: {\n    type: String\n  }\n});\n\nconst encryptMessage = (data) => {\n  try {\n    const ourData = data;\n    EncryptMessageSchema.validate(ourData);\n    const publicKey = Buffer.from(ourData.publicKey, 'hex');\n    const message = Buffer.from(ourData.message);\n    return ecies.encrypt(publicKey, message).toString('hex');\n  } catch(exception) {\n    throw new Meteor.Error('doichain.encryptMessage.exception', exception);\n  }\n};\n\nexport default encryptMessage;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport getKeyPair from './get_key-pair.js';\nimport {logSend} from \"../../../startup/server/log-configuration\";\n\nconst GenerateNameIdSchema = new SimpleSchema({\n  id: {\n    type: String\n  },\n  masterDoi: {\n      type: String,\n      optional: true\n  },\n  index: {\n      type: SimpleSchema.Integer,\n      optional: true\n  }\n});\n\nconst generateNameId = (optIn) => {\n  try {\n    const ourOptIn = optIn;\n    GenerateNameIdSchema.validate(ourOptIn);\n    let nameId;\n    if(optIn.masterDoi){\n        nameId = ourOptIn.masterDoi+\"-\"+ourOptIn.index;\n        logSend(\"used master_doi as nameId index \"+optIn.index+\"storage:\",nameId);\n    }\n    else{\n        nameId = getKeyPair().privateKey;\n        logSend(\"generated nameId for doichain storage:\",nameId);\n    }\n\n    OptIns.update({_id : ourOptIn.id}, {$set:{nameId: nameId}});\n\n    return nameId;\n  } catch(exception) {\n    throw new Meteor.Error('doichain.generateNameId.exception', exception);\n  }\n};\n\nexport default generateNameId;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport CryptoJS from 'crypto-js';\nimport Base58 from 'bs58';\nimport { isRegtest } from '../../../startup/server/dapp-configuration.js';\nimport {isTestnet} from \"../../../startup/server/dapp-configuration\";\n\nconst VERSION_BYTE = 0x34;\nconst VERSION_BYTE_REGTEST = 0x6f;\nconst GetAddressSchema = new SimpleSchema({\n  publicKey: {\n    type: String\n  }\n});\n\nconst getAddress = (data) => {\n  try {\n    const ourData = data;\n    GetAddressSchema.validate(ourData);\n    return _getAddress(ourData.publicKey);\n  } catch(exception) {\n    throw new Meteor.Error('doichain.getAddress.exception', exception);\n  }\n};\n\nfunction _getAddress(publicKey) {\n  const pubKey = CryptoJS.lib.WordArray.create(Buffer.from(publicKey, 'hex'));\n  let key = CryptoJS.SHA256(pubKey);\n  key = CryptoJS.RIPEMD160(key);\n  let versionByte = VERSION_BYTE;\n  if(isRegtest() || isTestnet()) versionByte = VERSION_BYTE_REGTEST;\n  let address = Buffer.concat([Buffer.from([versionByte]), Buffer.from(key.toString(), 'hex')]);\n  key = CryptoJS.SHA256(CryptoJS.lib.WordArray.create(address));\n  key = CryptoJS.SHA256(key);\n  let checksum = key.toString().substring(0, 8);\n  address = new Buffer(address.toString('hex')+checksum,'hex');\n  address = Base58.encode(address);\n  return address;\n}\n\nexport default getAddress;\n","import { Meteor } from 'meteor/meteor';\nimport { getBalance } from '../../../../server/api/doichain.js';\nimport { CONFIRM_CLIENT} from '../../../startup/server/doichain-configuration.js';\n\n\nconst get_Balance = () => {\n    \n  try {\n    const bal=getBalance(CONFIRM_CLIENT);\n    return bal;\n    \n  } catch(exception) {\n    throw new Meteor.Error('doichain.getBalance.exception', exception);\n  }\n  return true;\n};\n\nexport default get_Balance;\n\n","import { Meteor } from 'meteor/meteor';\nimport CryptoJS from 'crypto-js';\nimport SimpleSchema from 'simpl-schema';\n\nconst GetDataHashSchema = new SimpleSchema({\n  data: {\n    type: String\n  }\n});\n\nconst getDataHash = (data) => {\n  try {\n    const ourData = data;\n      GetDataHashSchema.validate(ourData);\n    const hash = CryptoJS.SHA256(ourData).toString();\n    return hash;\n  } catch(exception) {\n    throw new Meteor.Error('doichain.getDataHash.exception', exception);\n  }\n};\n\nexport default getDataHash;\n","import { Meteor } from 'meteor/meteor';\nimport { randomBytes } from 'crypto';\nimport secp256k1 from 'secp256k1';\n\nconst getKeyPair = () => {\n  try {\n    let privKey\n    do {privKey = randomBytes(32)} while(!secp256k1.privateKeyVerify(privKey))\n    const privateKey = privKey;\n    const publicKey = secp256k1.publicKeyCreate(privateKey);\n    return {\n      privateKey: privateKey.toString('hex').toUpperCase(),\n      publicKey: publicKey.toString('hex').toUpperCase()\n    }\n  } catch(exception) {\n    throw new Meteor.Error('doichain.getKeyPair.exception', exception);\n  }\n};\n\nexport default getKeyPair;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport Base58 from 'bs58';\n\nconst GetPrivateKeyFromWifSchema = new SimpleSchema({\n  wif: {\n    type: String\n  }\n});\n\nconst getPrivateKeyFromWif = (data) => {\n  try {\n    const ourData = data;\n    GetPrivateKeyFromWifSchema.validate(ourData);\n    return _getPrivateKeyFromWif(ourData.wif);\n  } catch(exception) {\n    throw new Meteor.Error('doichain.getPrivateKeyFromWif.exception', exception);\n  }\n};\n\nfunction _getPrivateKeyFromWif(wif) {\n  var privateKey = Base58.decode(wif).toString('hex');\n  privateKey = privateKey.substring(2, privateKey.length - 8);\n  if(privateKey.length === 66 && privateKey.endsWith(\"01\")) {\n    privateKey = privateKey.substring(0, privateKey.length - 2);\n  }\n  return privateKey;\n}\n\nexport default getPrivateKeyFromWif;\n","import SimpleSchema from 'simpl-schema';\nimport {logSend} from \"../../../startup/server/log-configuration\";\n\nimport getOptInKey from \"../dns/get_opt-in-key\";\nimport getOptInProvider from \"../dns/get_opt-in-provider\";\nimport getAddress from \"./get_address\";\n\nconst GetPublicKeySchema = new SimpleSchema({\n    domain: {\n        type: String\n    }\n});\n\nconst getPublicKeyAndAddress = (data) => {\n\n    const ourData = data;\n    GetPublicKeySchema.validate(ourData);\n\n    let publicKey = getOptInKey({domain: ourData.domain});\n    if(!publicKey){\n        const provider = getOptInProvider({domain: ourData.domain});\n        logSend(\"using doichain provider instead of directly configured publicKey:\",{provider:provider});\n        publicKey = getOptInKey({domain: provider}); //get public key from provider or fallback if publickey was not set in dns\n    }\n    const destAddress =  getAddress({publicKey: publicKey});\n    logSend('publicKey and destAddress ', {publicKey:publicKey,destAddress:destAddress});\n    return {publicKey:publicKey,destAddress:destAddress};\n};\n\nexport default getPublicKeyAndAddress;","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport bitcore from 'bitcore-lib';\nimport Message from 'bitcore-message';\n\nconst GetSignatureSchema = new SimpleSchema({\n  message: {\n    type: String\n  },\n  privateKey: {\n    type: String\n  }\n});\n\nconst getSignature = (data) => {\n  try {\n    const ourData = data;\n    GetSignatureSchema.validate(ourData);\n    const signature = Message(ourData.message).sign(new bitcore.PrivateKey(ourData.privateKey));\n    return signature;\n  } catch(exception) {\n    throw new Meteor.Error('doichain.getSignature.exception', exception);\n  }\n};\n\nexport default getSignature;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { SEND_CLIENT } from '../../../startup/server/doichain-configuration.js';\nimport encryptMessage from \"./encrypt_message\";\nimport {getUrl} from \"../../../startup/server/dapp-configuration\";\nimport {logBlockchain, logSend} from \"../../../startup/server/log-configuration\";\nimport {feeDoi,nameDoi} from \"../../../../server/api/doichain\";\nimport {OptIns} from \"../../../api/opt-ins/opt-ins\";\nimport getPublicKeyAndAddress from \"./get_publickey_and_address_by_domain\";\n\n\nconst InsertSchema = new SimpleSchema({\n  nameId: {\n    type: String\n  },\n  signature: {\n    type: String\n  },\n  dataHash: {\n    type: String\n  },\n  domain: {\n    type: String\n  },\n  soiDate: {\n    type: Date\n  }\n});\n\nconst insert = (data) => {\n  const ourData = data;\n  try {\n    InsertSchema.validate(ourData);\n    logSend(\"domain:\",ourData.domain);\n\n    const publicKeyAndAddress = getPublicKeyAndAddress({domain:ourData.domain});\n    const from = encryptMessage({publicKey: publicKeyAndAddress.publicKey, message: getUrl()});\n    logSend('encrypted url for use ad from in doichain value:',getUrl(),from);\n\n    const nameValue = JSON.stringify({\n        signature: ourData.signature,\n        dataHash: ourData.dataHash,\n        from: from\n    });\n\n    //TODO (!) this must be replaced in future by \"atomic name trading example\" https://wiki.namecoin.info/?title=Atomic_Name-Trading\n    logBlockchain('sending a fee to bob so he can pay the doi storage (destAddress):', publicKeyAndAddress.destAddress);\n    const feeDoiTx = feeDoi(SEND_CLIENT, publicKeyAndAddress.destAddress);\n    logBlockchain('fee send txid to destaddress', feeDoiTx, publicKeyAndAddress.destAddress);\n\n    logBlockchain('adding data to blockchain via name_doi (nameId,value,destAddress):', ourData.nameId,nameValue,publicKeyAndAddress.destAddress);\n    const nameDoiTx = nameDoi(SEND_CLIENT, ourData.nameId, nameValue, publicKeyAndAddress.destAddress);\n    logBlockchain('name_doi added blockchain. txid:', nameDoiTx);\n\n    OptIns.update({nameId: ourData.nameId}, {$set: {txId:nameDoiTx}});\n    logBlockchain('updating OptIn locally with:', {nameId: ourData.nameId, txId: nameDoiTx});\n\n  } catch(exception) {\n      OptIns.update({nameId: ourData.nameId}, {$set: {error:JSON.stringify(exception.message)}});\n    throw new Meteor.Error('doichain.insert.exception', exception); //TODO update opt-in in local db to inform user about the error! e.g. Insufficient funds etc.\n  }\n};\n\nexport default insert;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { CONFIRM_CLIENT } from '../../../startup/server/doichain-configuration.js';\nimport {getWif, signMessage, getTransaction, nameDoi, nameShow} from \"../../../../server/api/doichain\";\nimport {API_PATH, DOI_CONFIRMATION_NOTIFY_ROUTE, VERSION} from \"../../../../server/api/rest/rest\";\nimport {CONFIRM_ADDRESS} from \"../../../startup/server/doichain-configuration\";\nimport {getHttpPUT} from \"../../../../server/api/http\";\nimport {logConfirm} from \"../../../startup/server/log-configuration\";\nimport getPrivateKeyFromWif from \"./get_private-key_from_wif\";\nimport decryptMessage from \"./decrypt_message\";\nimport {OptIns} from \"../../../api/opt-ins/opt-ins\";\n\nconst UpdateSchema = new SimpleSchema({\n  nameId: {\n    type: String\n  },\n  value: {\n    type: String\n  },\n  host : {\n      type: String,\n      optional: true,\n  },\n  fromHostUrl : {\n      type: String\n  }\n});\n\nconst update = (data, job) => {\n  try {\n    const ourData = data;\n\n    UpdateSchema.validate(ourData);\n\n    //stop this update until this name as at least 1 confirmation\n    const name_data = nameShow(CONFIRM_CLIENT,ourData.nameId);\n    if(name_data === undefined){\n        rerun(job);\n        logConfirm('name not visible - delaying name update',ourData.nameId);\n        return;\n    }\n    const our_transaction = getTransaction(CONFIRM_CLIENT,name_data.txid);\n    if(our_transaction.confirmations===0){\n        rerun(job);\n        logConfirm('transaction has 0 confirmations - delaying name update',JSON.parse(ourData.value));\n        return;\n    }\n    logConfirm('updating blockchain with doiSignature:',JSON.parse(ourData.value));\n    const wif = getWif(CONFIRM_CLIENT, CONFIRM_ADDRESS);\n    const privateKey = getPrivateKeyFromWif({wif: wif});\n    logConfirm('got private key (will not show it here) in order to decrypt Send-dApp host url from value:',ourData.fromHostUrl);\n    const ourfromHostUrl = decryptMessage({privateKey: privateKey, message: ourData.fromHostUrl});\n    logConfirm('decrypted fromHostUrl',ourfromHostUrl);\n    const url = ourfromHostUrl+API_PATH+VERSION+\"/\"+DOI_CONFIRMATION_NOTIFY_ROUTE;\n\n    logConfirm('creating signature with ADDRESS'+CONFIRM_ADDRESS+\" nameId:\",ourData.value);\n    const signature = signMessage(CONFIRM_CLIENT, CONFIRM_ADDRESS, ourData.nameId); //TODO why here over nameID?\n    logConfirm('signature created:',signature);\n\n    const updateData = {\n        nameId: ourData.nameId,\n        signature: signature,\n        host: ourData.host\n    };\n\n    try {\n        const txid = nameDoi(CONFIRM_CLIENT, ourData.nameId, ourData.value, null);\n        logConfirm('update transaction txid:',txid);\n    }catch(exception){\n        //\n        logConfirm('this nameDOI doesnÂ´t have a block yet and will be updated with the next block and with the next queue start:',ourData.nameId);\n        if(exception.toString().indexOf(\"there is already a registration for this doi name\")==-1) {\n            OptIns.update({nameId: ourData.nameId}, {$set: {error: JSON.stringify(exception.message)}});\n        }\n        throw new Meteor.Error('doichain.update.exception', exception);\n        //}else{\n        //    logConfirm('this nameDOI doesnÂ´t have a block yet and will be updated with the next block and with the next queue start:',ourData.nameId);\n        //}\n    }\n\n    const response = getHttpPUT(url, updateData);\n    logConfirm('informed send dApp about confirmed doi on url:'+url+' with updateData'+JSON.stringify(updateData)+\" response:\",response.data);\n    job.done();\n  } catch(exception) {\n    throw new Meteor.Error('doichain.update.exception', exception);\n  }\n};\n\nfunction rerun(job){\n    logConfirm('rerunning txid in 10sec - canceling old job','');\n    job.cancel();\n    logConfirm('restart blockchain doi update','');\n    job.restart(\n        {\n            //repeats: 600,   // Only repeat this once\n            // This is the default\n           // wait: 10000   // Wait 10 sec between repeats\n                          // Default is previous setting\n        },\n        function (err, result) {\n            if (result) {\n                logConfirm('rerunning txid in 10sec:',result);\n            }\n        }\n    );\n}\n\nexport default update;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport bitcore from 'bitcore-lib';\nimport Message from 'bitcore-message';\nimport {logError, logVerify} from \"../../../startup/server/log-configuration\";\nconst NETWORK = bitcore.Networks.add({\n  name: 'doichain',\n  alias: 'doichain',\n  pubkeyhash: 0x34,\n  privatekey: 0xB4,\n  scripthash: 13,\n  networkMagic: 0xf9beb4fe,\n});\n\nconst VerifySignatureSchema = new SimpleSchema({\n  data: {\n    type: String\n  },\n  publicKey: {\n    type: String\n  },\n  signature: {\n    type: String\n  }\n});\n\nconst verifySignature = (data) => {\n  try {\n    const ourData = data;\n    logVerify('verifySignature:',ourData);\n    VerifySignatureSchema.validate(ourData);\n    const address = bitcore.Address.fromPublicKey(new bitcore.PublicKey(ourData.publicKey), NETWORK);\n    try {\n      return Message(ourData.data).verify(address, ourData.signature);\n    } catch(error) { logError(error)}\n    return false;\n  } catch(exception) {\n    throw new Meteor.Error('doichain.verifySignature.exception', exception);\n  }\n};\n\nexport default verifySignature;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport { Senders } from '../../../api/senders/senders.js';\nimport { Recipients } from '../../../api/recipients/recipients.js';\nimport generateNameId from './generate_name-id.js';\nimport getSignature from './get_signature.js';\nimport getDataHash from './get_data-hash.js';\nimport addInsertBlockchainJob from '../jobs/add_insert_blockchain.js';\nimport {logSend} from \"../../../startup/server/log-configuration\";\n\nconst WriteToBlockchainSchema = new SimpleSchema({\n  id: {\n    type: String\n  }\n});\n\nconst writeToBlockchain = (data) => {\n  try {\n    const ourData = data;\n    WriteToBlockchainSchema.validate(ourData);\n\n    const optIn = OptIns.findOne({_id: data.id});\n    const recipient = Recipients.findOne({_id: optIn.recipient});\n    const sender = Senders.findOne({_id: optIn.sender});\n    logSend(\"optIn data:\",{index:ourData.index, optIn:optIn,recipient:recipient,sender: sender});\n\n\n    const nameId = generateNameId({id: data.id,index:optIn.index,masterDoi:optIn.masterDoi });\n    const signature = getSignature({message: recipient.email+sender.email, privateKey: recipient.privateKey});\n    logSend(\"generated signature from email recipient and sender:\",signature);\n\n    let dataHash = \"\";\n\n    if(optIn.data) {\n      dataHash = getDataHash({data: optIn.data});\n      logSend(\"generated datahash from given data:\",dataHash);\n    }\n\n    const parts = recipient.email.split(\"@\");\n    const domain = parts[parts.length-1];\n    logSend(\"email domain for publicKey request is:\",domain);\n    addInsertBlockchainJob({\n      nameId: nameId,\n      signature: signature,\n      dataHash: dataHash,\n      domain: domain,\n      soiDate: optIn.createdAt\n    })\n  } catch (exception) {\n    throw new Meteor.Error('doichain.writeToBlockchain.exception', exception);\n  }\n};\n\nexport default writeToBlockchain\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { HashIds } from '../../../startup/server/email-configuration.js';\n\nconst DecodeDoiHashSchema = new SimpleSchema({\n  hash: {\n    type: String\n  }\n});\n\nconst decodeDoiHash = (hash) => {\n  try {\n    const ourHash = hash;\n    DecodeDoiHashSchema.validate(ourHash);\n    const hex = HashIds.decodeHex(ourHash.hash);\n    if(!hex || hex === '') throw \"Wrong hash\";\n    try {\n      const obj = JSON.parse(Buffer(hex, 'hex').toString('ascii'));\n      return obj;\n    } catch(exception) {throw \"Wrong hash\";}\n  } catch (exception) {\n    throw new Meteor.Error('emails.decode_doi-hash.exception', exception);\n  }\n};\n\nexport default decodeDoiHash;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { HashIds } from '../../../startup/server/email-configuration.js';\n\nconst GenerateDoiHashSchema = new SimpleSchema({\n  id: {\n    type: String\n  },\n  token: {\n    type: String\n  },\n  redirect: {\n    type: String\n  }\n});\n\nconst generateDoiHash = (optIn) => {\n  try {\n    const ourOptIn = optIn;\n    GenerateDoiHashSchema.validate(ourOptIn);\n\n    const json = JSON.stringify({\n      id: ourOptIn.id,\n      token: ourOptIn.token,\n      redirect: ourOptIn.redirect\n    });\n\n    const hex = Buffer(json).toString('hex');\n    const hash = HashIds.encodeHex(hex);\n    return hash;\n  } catch (exception) {\n    throw new Meteor.Error('emails.generate_doi-hash.exception', exception);\n  }\n};\n\nexport default generateDoiHash;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport {logConfirm} from \"../../../startup/server/log-configuration\";\n\nconst PLACEHOLDER_REGEX = /\\${([\\w]*)}/g;\nconst ParseTemplateSchema = new SimpleSchema({\n  template: {\n    type: String,\n  },\n  data: {\n    type: Object,\n    blackbox: true\n  }\n});\n\nconst parseTemplate = (data) => {\n  try {\n    const ourData = data;\n    //logConfirm('parseTemplate:',ourData);\n\n    ParseTemplateSchema.validate(ourData);\n    logConfirm('ParseTemplateSchema validated');\n\n    var _match;\n    var template = ourData.template;\n   //logConfirm('doing some regex with template:',template);\n\n    do {\n      _match = PLACEHOLDER_REGEX.exec(template);\n      if(_match) template = _replacePlaceholder(template, _match, ourData.data[_match[1]]);\n    } while (_match);\n    return template;\n  } catch (exception) {\n    throw new Meteor.Error('emails.parseTemplate.exception', exception);\n  }\n};\n\nfunction _replacePlaceholder(template, _match, replace) {\n  var rep = replace;\n  if(replace === undefined) rep = \"\";\n  return template.substring(0, _match.index)+rep+template.substring(_match.index+_match[0].length);\n}\n\nexport default parseTemplate;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport {logConfirm} from \"../../../startup/server/log-configuration\";\nimport { DOI_MAIL_DEFAULT_EMAIL_FROM } from '../../../startup/server/email-configuration.js';\n\nconst SendMailSchema = new SimpleSchema({\n  from: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  to: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  subject: {\n    type: String,\n  },\n  message: {\n    type: String,\n  },\n  returnPath: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  }\n});\n\nconst sendMail = (mail) => {\n  try {\n\n    mail.from = DOI_MAIL_DEFAULT_EMAIL_FROM;\n\n    const ourMail = mail;\n    logConfirm('sending email with data:',{to:mail.to, subject:mail.subject});\n    SendMailSchema.validate(ourMail);\n    //TODO: Text fallback\n    Email.send({\n      from: mail.from,\n      to: mail.to,\n      subject: mail.subject,\n      html: mail.message,\n      headers: {\n        'Return-Path': mail.returnPath,\n      }\n    });\n\n  } catch (exception) {\n    throw new Meteor.Error('emails.send.exception', exception);\n  }\n};\n\nexport default sendMail;\n","import { Meteor } from 'meteor/meteor';\nimport { Job } from 'meteor/vsivsi:job-collection';\nimport { BlockchainJobs } from '../../../../server/api/blockchain_jobs.js';\n\nconst addCheckNewTransactionsBlockchainJob = () => {\n  try {\n    const job = new Job(BlockchainJobs, 'checkNewTransaction', {});\n    job.retry({retries: 60, wait: 15*1000 }).save({cancelRepeats: true});\n  } catch (exception) {\n    throw new Meteor.Error('jobs.addCheckNewTransactionsBlockchain.exception', exception);\n  }\n};\n\nexport default addCheckNewTransactionsBlockchainJob;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { Job } from 'meteor/vsivsi:job-collection';\nimport { DAppJobs } from '../../../../server/api/dapp_jobs.js';\n\nconst AddFetchDoiMailDataJobSchema = new SimpleSchema({\n  name: {\n    type: String\n  },\n  domain: {\n    type: String\n  }\n});\n\nconst addFetchDoiMailDataJob = (data) => {\n  try {\n    const ourData = data;\n    AddFetchDoiMailDataJobSchema.validate(ourData);\n    const job = new Job(DAppJobs, 'fetchDoiMailData', ourData);\n    job.retry({retries: 5, wait: 1*10*1000 }).save(); //check every 10 secs 5 times\n  } catch (exception) {\n    throw new Meteor.Error('jobs.addFetchDoiMailData.exception', exception);\n  }\n};\n\nexport default addFetchDoiMailDataJob;\n","import { Meteor } from 'meteor/meteor';\nimport { Job } from 'meteor/vsivsi:job-collection';\nimport SimpleSchema from 'simpl-schema';\nimport { BlockchainJobs } from '../../../../server/api/blockchain_jobs.js';\n\nconst AddInsertBlockchainJobSchema = new SimpleSchema({\n  nameId: {\n    type: String\n  },\n  signature: {\n    type: String\n  },\n  dataHash: {\n    type: String,\n    optional:true\n  },\n  domain: {\n    type: String\n  },\n  soiDate: {\n    type: Date\n  }\n});\n\nconst addInsertBlockchainJob = (entry) => {\n  try {\n    const ourEntry = entry;\n    AddInsertBlockchainJobSchema.validate(ourEntry);\n    const job = new Job(BlockchainJobs, 'insert', ourEntry);\n    job.retry({retries: 10, wait: 3*60*1000 }).save(); //check every 10sec for 1h\n  } catch (exception) {\n    throw new Meteor.Error('jobs.addInsertBlockchain.exception', exception);\n  }\n};\n\nexport default addInsertBlockchainJob;\n","import { Meteor } from 'meteor/meteor';\nimport { Job } from 'meteor/vsivsi:job-collection';\nimport SimpleSchema from 'simpl-schema';\nimport { MailJobs } from '../../../../server/api/mail_jobs.js';\n\nconst AddSendMailJobSchema = new SimpleSchema({\n  /*from: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },*/\n  to: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  subject: {\n    type: String,\n  },\n  message: {\n    type: String,\n  },\n  returnPath: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  }\n});\n\nconst addSendMailJob = (mail) => {\n  try {\n    const ourMail = mail;\n    AddSendMailJobSchema.validate(ourMail);\n    const job = new Job(MailJobs, 'send', ourMail);\n    job.retry({retries: 5, wait: 60*1000 }).save();\n  } catch (exception) {\n    throw new Meteor.Error('jobs.addSendMail.exception', exception);\n  }\n};\n\nexport default addSendMailJob;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { Job } from 'meteor/vsivsi:job-collection';\nimport { BlockchainJobs } from '../../../../server/api/blockchain_jobs.js';\n\nconst AddUpdateBlockchainJobSchema = new SimpleSchema({\n  nameId: {\n    type: String\n  },\n  value: {\n    type: String\n  },\n  fromHostUrl: {\n    type: String\n  },\n  host: {\n      type: String\n  }\n});\n\nconst addUpdateBlockchainJob = (entry) => {\n  try {\n    const ourEntry = entry;\n    AddUpdateBlockchainJobSchema.validate(ourEntry);\n    const job = new Job(BlockchainJobs, 'update', ourEntry);\n    job.retry({retries: 360, wait: 1*10*1000 }).save();\n  } catch (exception) {\n    throw new Meteor.Error('jobs.addUpdateBlockchain.exception', exception);\n  }\n};\n\nexport default addUpdateBlockchainJob;\n","import { Meteor } from 'meteor/meteor';\nimport i18n from 'meteor/universe:i18n';\n\n// universe:i18n only bundles the default language on the client side.\n// To get a list of all avialble languages with at least one translation,\n// i18n.getLanguages() must be called server side.\nconst getLanguages = () => {\n  try {\n    return i18n.getLanguages();\n  } catch (exception) {\n    throw new Meteor.Error('languages.get.exception', exception);\n  }\n};\n\nexport default getLanguages;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { Meta } from '../../../api/meta/meta.js';\n\nconst AddOrUpdateMetaSchema = new SimpleSchema({\n  key: {\n    type: String\n  },\n  value: {\n    type: String\n  }\n});\n\nconst addOrUpdateMeta = (data) => {\n  try {\n    const ourData = data;\n    AddOrUpdateMetaSchema.validate(ourData);\n    const meta = Meta.findOne({key: ourData.key});\n    if(meta !== undefined) Meta.update({_id : meta._id}, {$set: {\n      value: ourData.value\n    }});\n    else return Meta.insert({\n      key: ourData.key,\n      value: ourData.value\n    })\n  } catch (exception) {\n    throw new Meteor.Error('meta.addOrUpdate.exception', exception);\n  }\n};\n\nexport default addOrUpdateMeta;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\n\nconst AddOptInSchema = new SimpleSchema({\n  name: {\n    type: String\n  }\n});\n\nconst addOptIn = (optIn) => {\n  try {\n    const ourOptIn = optIn;\n    AddOptInSchema.validate(ourOptIn);\n    const optIns = OptIns.find({nameId: ourOptIn.name}).fetch();\n    if(optIns.length > 0) return optIns[0]._id;\n    const optInId = OptIns.insert({\n      nameId: ourOptIn.name\n    });\n    return optInId;\n  } catch (exception) {\n    throw new Meteor.Error('opt-ins.add.exception', exception);\n  }\n};\n\nexport default addOptIn;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport addRecipient from '../recipients/add.js';\nimport addSender from '../senders/add.js';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport writeToBlockchain from '../doichain/write_to_blockchain.js';\nimport {logError, logSend} from \"../../../startup/server/log-configuration\";\n\n\nconst AddOptInSchema = new SimpleSchema({\n  recipient_mail: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  sender_mail: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  data: {\n    type: String,\n    optional: true\n  },\n  master_doi: {\n      type: String,\n      optional: true\n  },\n  index: {\n      type: SimpleSchema.Integer,\n      optional: true\n  },\n  ownerId: {\n    type: String,\n    regEx: SimpleSchema.RegEx.id\n  }\n});\n\nconst addOptIn = (optIn) => {\n  try {\n    const ourOptIn = optIn;\n    AddOptInSchema.validate(ourOptIn);\n\n    const recipient = {\n      email: ourOptIn.recipient_mail\n    }\n    const recipientId = addRecipient(recipient);\n    const sender = {\n      email: ourOptIn.sender_mail\n    }\n    const senderId = addSender(sender);\n    \n    const optIns = OptIns.find({recipient: recipientId, sender: senderId}).fetch();\n    if(optIns.length > 0) return optIns[0]._id; //TODO when SOI already exists resend email?\n\n    if(ourOptIn.data !== undefined) {\n      try {\n        JSON.parse(ourOptIn.data);\n      } catch(error) {\n        logError(\"ourOptIn.data:\",ourOptIn.data);\n        throw \"Invalid data json \";\n      }\n    }\n    \n    const optInId = OptIns.insert({\n      recipient: recipientId,\n      sender: senderId,\n      index: ourOptIn.index,\n      masterDoi : ourOptIn.master_doi,\n      data: ourOptIn.data,\n      ownerId: ourOptIn.ownerId\n    });\n    logSend(\"optIn (index:\"+ourOptIn.index+\" added to local db with optInId\",optInId);\n\n    writeToBlockchain({id: optInId});\n    return optInId;\n  } catch (exception) {\n    throw new Meteor.Error('opt-ins.addAndWriteToBlockchain.exception', exception);\n  }\n};\n\nexport default addOptIn;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { CONFIRM_CLIENT, CONFIRM_ADDRESS } from '../../../startup/server/doichain-configuration.js';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport { DoichainEntries } from '../../../api/doichain/entries.js';\nimport decodeDoiHash from '../emails/decode_doi-hash.js';\nimport { signMessage } from '../../../../server/api/doichain.js';\nimport addUpdateBlockchainJob from '../jobs/add_update_blockchain.js';\nimport {logConfirm} from \"../../../startup/server/log-configuration\";\n\nconst ConfirmOptInSchema = new SimpleSchema({\n  host: {\n    type: String\n  },\n  hash: {\n    type: String\n  }\n});\n\nconst confirmOptIn = (request) => {\n  try {\n    const ourRequest = request;\n    ConfirmOptInSchema.validate(ourRequest);\n    const decoded = decodeDoiHash({hash: request.hash});\n    const optIn = OptIns.findOne({_id: decoded.id});\n    if(optIn === undefined || optIn.confirmationToken !== decoded.token) throw \"Invalid hash\";\n    const confirmedAt = new Date();\n\n    OptIns.update({_id : optIn._id},{$set:{confirmedAt: confirmedAt, confirmedBy: ourRequest.host}, $unset: {confirmationToken: \"\"}});\n\n    //TODO here find all DoichainEntries in the local database  and blockchain with the same masterDoi\n    const entries = DoichainEntries.find({$or: [{name: optIn.nameId}, {masterDoi: optIn.nameId}]});\n    if(entries === undefined) throw \"Doichain entry/entries not found\";\n\n    entries.forEach(entry => {\n        logConfirm('confirming DoiChainEntry:',entry);\n\n        const value = JSON.parse(entry.value);\n        logConfirm('getSignature (only of value!)', value);\n\n        const doiSignature = signMessage(CONFIRM_CLIENT, CONFIRM_ADDRESS, value.signature);\n        logConfirm('got doiSignature:',doiSignature);\n        const fromHostUrl = value.from;\n\n        delete value.from;\n        value.doiTimestamp = confirmedAt.toISOString();\n        value.doiSignature = doiSignature;\n        const jsonValue = JSON.stringify(value);\n        logConfirm('updating Doichain nameId:'+optIn.nameId+' with value:',jsonValue);\n\n        addUpdateBlockchainJob({\n            nameId: entry.name,\n            value: jsonValue,\n            fromHostUrl: fromHostUrl,\n            host: ourRequest.host\n        });\n    });\n    logConfirm('redirecting user to:',decoded.redirect);\n    return decoded.redirect;\n  } catch (exception) {\n    throw new Meteor.Error('opt-ins.confirm.exception', exception);\n  }\n};\n\nexport default confirmOptIn\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { randomBytes } from 'crypto';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\n\nconst GenerateDoiTokenSchema = new SimpleSchema({\n  id: {\n    type: String\n  }\n});\n\nconst generateDoiToken = (optIn) => {\n  try {\n    const ourOptIn = optIn;\n    GenerateDoiTokenSchema.validate(ourOptIn);\n    const token = randomBytes(32).toString('hex');\n    OptIns.update({_id : ourOptIn.id},{$set:{confirmationToken: token}});\n    return token;\n  } catch (exception) {\n    throw new Meteor.Error('opt-ins.generate_doi-token.exception', exception);\n  }\n};\n\nexport default generateDoiToken\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport { Recipients } from '../../../api/recipients/recipients.js';\nimport verifySignature from '../doichain/verify_signature.js';\nimport {logSend} from \"../../../startup/server/log-configuration\";\nimport getPublicKeyAndAddress from \"../doichain/get_publickey_and_address_by_domain\";\n\nconst UpdateOptInStatusSchema = new SimpleSchema({\n  nameId: {\n    type: String\n  },\n  signature: {\n    type: String\n  },\n  host: {\n      type: String,\n      optional: true\n  }\n});\n\n\nconst updateOptInStatus = (data) => {\n  try {\n    const ourData = data;\n    logSend('confirm dApp confirms optIn:',JSON.stringify(data));\n    UpdateOptInStatusSchema.validate(ourData);\n    const optIn = OptIns.findOne({nameId: ourData.nameId});\n    if(optIn === undefined) throw \"Opt-In not found\";\n    logSend('confirm dApp confirms optIn:',ourData.nameId);\n\n    const recipient = Recipients.findOne({_id: optIn.recipient});\n    if(recipient === undefined) throw \"Recipient not found\";\n    const parts = recipient.email.split(\"@\");\n    const domain = parts[parts.length-1];\n    const publicKeyAndAddress = getPublicKeyAndAddress({domain:domain});\n\n    //TODO getting information from Bob that a certain nameId (DOI) got confirmed.\n    if(!verifySignature({publicKey: publicKeyAndAddress.publicKey, data: ourData.nameId, signature: ourData.signature})) {\n      throw \"Access denied\";\n    }\n    logSend('signature valid for publicKey', publicKeyAndAddress.publicKey);\n\n    OptIns.update({_id : optIn._id},{$set:{confirmedAt: new Date(), confirmedBy: ourData.host}});\n  } catch (exception) {\n    throw new Meteor.Error('dapps.send.updateOptInStatus.exception', exception);\n  }\n};\n\nexport default updateOptInStatus;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { VERIFY_CLIENT } from '../../../startup/server/doichain-configuration.js';\nimport { nameShow } from '../../../../server/api/doichain.js';\nimport getOptInProvider from '../dns/get_opt-in-provider.js';\nimport getOptInKey from '../dns/get_opt-in-key.js';\nimport verifySignature from '../doichain/verify_signature.js';\nimport {logVerify} from \"../../../startup/server/log-configuration\";\nimport getPublicKeyAndAddress from \"../doichain/get_publickey_and_address_by_domain\";\n\nconst VerifyOptInSchema = new SimpleSchema({\n  recipient_mail: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  sender_mail: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  name_id: {\n    type: String\n  },\n  recipient_public_key: {\n    type: String\n  }\n});\n\nconst verifyOptIn = (data) => {\n  try {\n    const ourData = data;\n    VerifyOptInSchema.validate(ourData);\n    const entry = nameShow(VERIFY_CLIENT, ourData.name_id);\n    if(entry === undefined) return false;\n    const entryData = JSON.parse(entry.value);\n    const firstCheck = verifySignature({\n      data: ourData.recipient_mail+ourData.sender_mail,\n      signature: entryData.signature,\n      publicKey: ourData.recipient_public_key\n    })\n\n    if(!firstCheck) return {firstCheck: false};\n    const parts = ourData.recipient_mail.split(\"@\"); //TODO put this into getPublicKeyAndAddress\n    const domain = parts[parts.length-1];\n    const publicKeyAndAddress = getPublicKeyAndAddress({domain: domain});\n\n    const secondCheck = verifySignature({\n      data: entryData.signature,\n      signature: entryData.doiSignature,\n      publicKey: publicKeyAndAddress.publicKey\n    })\n\n    if(!secondCheck) return {secondCheck: false};\n    return true;\n  } catch (exception) {\n    throw new Meteor.Error('opt-ins.verify.exception', exception);\n  }\n};\n\nexport default verifyOptIn\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { Recipients } from '../../../api/recipients/recipients.js';\nimport getKeyPair from '../doichain/get_key-pair.js';\n\nconst AddRecipientSchema = new SimpleSchema({\n  email: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  }\n});\n\nconst addRecipient = (recipient) => {\n  try {\n    const ourRecipient = recipient;\n    AddRecipientSchema.validate(ourRecipient);\n    const recipients = Recipients.find({email: recipient.email}).fetch();\n    if(recipients.length > 0) return recipients[0]._id;\n    const keyPair = getKeyPair();\n    return Recipients.insert({\n      email: ourRecipient.email,\n      privateKey: keyPair.privateKey,\n      publicKey: keyPair.publicKey\n    })\n  } catch (exception) {\n    throw new Meteor.Error('recipients.add.exception', exception);\n  }\n};\n\nexport default addRecipient;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { Senders } from '../../../api/senders/senders.js';\n\nconst AddSenderSchema = new SimpleSchema({\n  email: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  }\n});\n\nconst addSender = (sender) => {\n  try {\n    const ourSender = sender;\n    AddSenderSchema.validate(ourSender);\n    const senders = Senders.find({email: sender.email}).fetch();\n    if(senders.length > 0) return senders[0]._id;\n    return Senders.insert({\n      email: ourSender.email\n    })\n  } catch (exception) {\n    throw new Meteor.Error('senders.add.exception', exception);\n  }\n};\n\nexport default addSender;\n","import { Meteor } from 'meteor/meteor';\n\nexport function isDebug() {\n  if(Meteor.settings !== undefined &&\n     Meteor.settings.app !== undefined &&\n     Meteor.settings.app.debug !== undefined) return Meteor.settings.app.debug\n  return false;\n}\n\nexport function isRegtest() {\n  if(Meteor.settings !== undefined &&\n     Meteor.settings.app !== undefined &&\n     Meteor.settings.app.regtest !== undefined) return Meteor.settings.app.regtest\n  return false;\n}\n\nexport function isTestnet() {\n    if(Meteor.settings !== undefined &&\n        Meteor.settings.app !== undefined &&\n        Meteor.settings.app.testnet !== undefined) return Meteor.settings.app.testnet\n    return false;\n}\n\nexport function getUrl() {\n  if(Meteor.settings !== undefined &&\n     Meteor.settings.app !== undefined &&\n     Meteor.settings.app.host !== undefined) {\n       let port = 3000;\n       if(Meteor.settings.app.port !== undefined) port = Meteor.settings.app.port\n       return \"http://\"+Meteor.settings.app.host+\":\"+port+\"/\";\n  }\n  return Meteor.absoluteUrl();\n}\n","export const FALLBACK_PROVIDER = \"doichain.org\";\n","import namecoin from 'namecoin';\nimport { SEND_APP, CONFIRM_APP, VERIFY_APP, isAppType } from './type-configuration.js';\n\nvar sendSettings = Meteor.settings.send;\nvar sendClient = undefined;\nif(isAppType(SEND_APP)) {\n  if(!sendSettings || !sendSettings.doichain)\n    throw new Meteor.Error(\"config.send.doichain\", \"Send app doichain settings not found\")\n  sendClient = createClient(sendSettings.doichain);\n}\nexport const SEND_CLIENT = sendClient;\n\nvar confirmSettings = Meteor.settings.confirm;\nvar confirmClient = undefined;\nvar confirmAddress = undefined;\nif(isAppType(CONFIRM_APP)) {\n  if(!confirmSettings || !confirmSettings.doichain)\n    throw new Meteor.Error(\"config.confirm.doichain\", \"Confirm app doichain settings not found\")\n  confirmClient = createClient(confirmSettings.doichain);\n  confirmAddress = confirmSettings.doichain.address;\n}\nexport const CONFIRM_CLIENT = confirmClient;\nexport const CONFIRM_ADDRESS = confirmAddress;\n\nvar verifySettings = Meteor.settings.verify;\nvar verifyClient = undefined;\nif(isAppType(VERIFY_APP)) {\n  if(!verifySettings || !verifySettings.doichain)\n    throw new Meteor.Error(\"config.verify.doichain\", \"Verify app doichain settings not found\")\n  verifyClient = createClient(verifySettings.doichain);\n}\nexport const VERIFY_CLIENT = verifyClient;\n\nfunction createClient(settings) {\n  return new namecoin.Client({\n    host: settings.host,\n    port: settings.port,\n    user: settings.username,\n    pass: settings.password\n  });\n}\n","import { Meteor } from 'meteor/meteor';\nimport { SEND_APP, CONFIRM_APP, isAppType } from './type-configuration.js';\nimport Hashids from 'hashids';\n//const Hashids = require('hashids').default;\nimport {logConfirm} from \"./log-configuration\";\n\nexport const HashIds = new Hashids('0xugmLe7Nyee6vk1iF88(6CmwpqoG4hQ*-T74tjYw^O2vOO(Xl-91wA8*nCg_lX$');\n\nvar sendSettings = Meteor.settings.send;\nvar doiMailFetchUrl = undefined;\n\nif(isAppType(SEND_APP)) {\n  if(!sendSettings || !sendSettings.doiMailFetchUrl)\n    throw new Meteor.Error(\"config.send.email\", \"Settings not found\");\n  doiMailFetchUrl = sendSettings.doiMailFetchUrl;\n}\nexport const DOI_MAIL_FETCH_URL = doiMailFetchUrl;\n\nvar defaultFrom = undefined;\nif(isAppType(CONFIRM_APP)) {\n  var confirmSettings = Meteor.settings.confirm;\n\n  if(!confirmSettings || !confirmSettings.smtp)\n        throw new Meteor.Error(\"config.confirm.smtp\", \"Confirm app email smtp settings not found\")\n\n  if(!confirmSettings.smtp.defaultFrom)\n        throw new Meteor.Error(\"config.confirm.defaultFrom\", \"Confirm app email defaultFrom not found\")\n\n  defaultFrom  =  confirmSettings.smtp.defaultFrom;\n\n  logConfirm('sending with defaultFrom:',defaultFrom);\n\n  Meteor.startup(() => {\n\n   if(confirmSettings.smtp.username === undefined){\n       process.env.MAIL_URL = 'smtp://' +\n           encodeURIComponent(confirmSettings.smtp.server) +\n           ':' +\n           confirmSettings.smtp.port;\n   }else{\n       process.env.MAIL_URL = 'smtp://' +\n           encodeURIComponent(confirmSettings.smtp.username) +\n           ':' + encodeURIComponent(confirmSettings.smtp.password) +\n           '@' + encodeURIComponent(confirmSettings.smtp.server) +\n           ':' +\n           confirmSettings.smtp.port;\n   }\n\n   logConfirm('using MAIL_URL:',process.env.MAIL_URL);\n\n   if(confirmSettings.smtp.NODE_TLS_REJECT_UNAUTHORIZED!==undefined)\n       process.env.NODE_TLS_REJECT_UNAUTHORIZED = confirmSettings.smtp.NODE_TLS_REJECT_UNAUTHORIZED; //0\n  });\n}\nexport const DOI_MAIL_DEFAULT_EMAIL_FROM = defaultFrom;\n","import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\nimport {Meta} from '../../api/meta/meta.js'\nMeteor.startup(() => {\n   let version=Assets.getText(\"version.json\");\n\n  if (Meta.find().count() > 0){\n    Meta.remove({});\n  }\n   Meta.insert({key:\"version\",value:version});\n  \n  if(Meteor.users.find().count() === 0) {\n    const id = Accounts.createUser({\n      username: 'admin',\n      email: 'admin@sendeffect.de',\n      password: 'password'\n    });\n    Roles.addUsersToRoles(id, 'admin');\n  }\n});\n","import './log-configuration.js';\nimport './dapp-configuration.js';\nimport './type-configuration.js';\nimport './dns-configuration.js';\nimport './doichain-configuration.js';\nimport './fixtures.js';\nimport './register-api.js';\nimport './useraccounts-configuration.js';\nimport './security.js';\nimport './email-configuration.js';\nimport './jobs.js';\n","import { Meteor } from 'meteor/meteor';\nimport { MailJobs } from '../../../server/api/mail_jobs.js';\nimport { BlockchainJobs } from '../../../server/api/blockchain_jobs.js';\nimport { DAppJobs } from '../../../server/api/dapp_jobs.js';\nimport { CONFIRM_APP, isAppType } from './type-configuration.js';\nimport addCheckNewTransactionsBlockchainJob from '../../modules/server/jobs/add_check_new_transactions.js';\n\nMeteor.startup(() => {\n  MailJobs.startJobServer();\n  BlockchainJobs.startJobServer();\n  DAppJobs.startJobServer();\n  if(isAppType(CONFIRM_APP)) addCheckNewTransactionsBlockchainJob();\n});\n","import {isDebug} from \"./dapp-configuration\";\n\nrequire('scribe-js')();\n\nexport const console = process.console;\nexport const sendModeTagColor = {msg : 'send-mode', colors : ['yellow', 'inverse']};\nexport const confirmModeTagColor = {msg : 'confirm-mode', colors : ['blue', 'inverse']};\nexport const verifyModeTagColor = {msg : 'verify-mode', colors : ['green', 'inverse']};\nexport const blockchainModeTagColor = {msg : 'blockchain-mode', colors : ['white', 'inverse']};\nexport const testingModeTagColor = {msg : 'testing-mode', colors : ['orange', 'inverse']};\n\nexport function logSend(message,param) {\n    if(isDebug()) {console.time().tag(sendModeTagColor).log(message,param?param:'');}\n}\n\nexport function logConfirm(message,param) {\n    if(isDebug()) {console.time().tag(confirmModeTagColor).log(message, param?param:'');}\n}\n\nexport function logVerify(message, param) {\n    if(isDebug()) {console.time().tag(verifyModeTagColor).log(message, param?param:'');}\n}\n\nexport function logBlockchain(message, param) {\n    if(isDebug()){console.time().tag(blockchainModeTagColor).log(message, param?param:'');}\n}\n\nexport function logMain(message, param) {\n    if(isDebug()){console.time().tag(blockchainModeTagColor).log(message, param?param:'');}\n}\n\nexport function logError(message, param) {\n    if(isDebug()){console.time().tag(blockchainModeTagColor).error(message, param?param:'');}\n}\n\nexport function testLogging(message, param) {\n    if(isDebug()){console.time().tag(testingModeTagColor).log(message, param?param:'');}\n}","import '../../api/languages/methods.js';\nimport '../../api/doichain/methods.js';\nimport '../../api/recipients/server/publications.js';\nimport '../../api/opt-ins/methods.js';\nimport '../../api/version/publications.js';\nimport '../../api/opt-ins/server/publications.js';\n\n","import { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { _ } from 'meteor/underscore';\n\n// Don't let people write arbitrary data to their 'profile' field from the client\nMeteor.users.deny({\n  update() {\n    return true;\n  },\n});\n\n// Get a list of all accounts methods by running `Meteor.server.method_handlers` in meteor shell\nconst AUTH_METHODS = [\n  'login',\n  'logout',\n  'logoutOtherClients',\n  'getNewToken',\n  'removeOtherTokens',\n  'configureLoginService',\n  'changePassword',\n  'forgotPassword',\n  'resetPassword',\n  'verifyEmail',\n  'createUser',\n  'ATRemoveService',\n  'ATCreateUserServer',\n  'ATResendVerificationEmail',\n];\n\nif (Meteor.isServer) {\n  // Only allow 2 login attempts per connection per 5 seconds\n  DDPRateLimiter.addRule({\n    name(name) {\n      return _.contains(AUTH_METHODS, name);\n    },\n\n    // Rate limit per connection ID\n    connectionId() { return true; },\n  }, 2, 5000);\n}\n","import { Meteor } from 'meteor/meteor';\nexport const SEND_APP = \"send\";\nexport const CONFIRM_APP = \"confirm\";\nexport const VERIFY_APP = \"verify\";\nexport function isAppType(type) {\n  if(Meteor.settings === undefined || Meteor.settings.app === undefined) throw \"No settings found!\"\n  const types = Meteor.settings.app.types;\n  if(types !== undefined) return types.includes(type);\n  return false;\n}\n","import { Accounts } from 'meteor/accounts-base';\nAccounts.config({\n    sendVerificationEmail: true,\n    forbidClientAccountCreation: true\n});\n\n\n\nAccounts.emailTemplates.from='doichain@le-space.de';","import { Api, DOI_WALLETNOTIFY_ROUTE, DOI_CONFIRMATION_ROUTE } from '../rest.js';\nimport confirmOptIn from '../../../../imports/modules/server/opt-ins/confirm.js'\nimport checkNewTransaction from \"../../../../imports/modules/server/doichain/check_new_transactions\";\nimport {logConfirm} from \"../../../../imports/startup/server/log-configuration\";\n//doku of meteor-restivus https://github.com/kahmali/meteor-restivus\nApi.addRoute(DOI_CONFIRMATION_ROUTE+'/:hash', {authRequired: false}, {\n  get: {\n    action: function() {\n      const hash = this.urlParams.hash;\n      try {\n        let ip = this.request.headers['x-forwarded-for'] ||\n          this.request.connection.remoteAddress ||\n          this.request.socket.remoteAddress ||\n          (this.request.connection.socket ? this.request.connection.socket.remoteAddress: null);\n\n          if(ip.indexOf(',')!=-1)ip=ip.substring(0,ip.indexOf(','));\n\n          logConfirm('REST opt-in/confirm :',{hash:hash, host:ip});\n          const redirect = confirmOptIn({host: ip, hash: hash});\n\n        return {\n          statusCode: 303,\n          headers: {'Content-Type': 'text/plain', 'Location': redirect},\n          body: 'Location: '+redirect\n        };\n      } catch(error) {\n        return {statusCode: 500, body: {status: 'fail', message: error.message}};\n      }\n    }\n  }\n});\n\nApi.addRoute(DOI_WALLETNOTIFY_ROUTE, {\n    get: {\n        authRequired: false,\n        action: function() {\n            const params = this.queryParams;\n            const txid = params.tx;\n\n            try {\n                checkNewTransaction(txid);\n                return {status: 'success',  data:'txid:'+txid+' was read from blockchain'};\n            } catch(error) {\n                return {status: 'fail', error: error.message};\n            }\n        }\n    }\n});\n","import { Api } from '../rest.js';\nApi.addRoute('debug/mail', {authRequired: false}, {\n  get: {\n    action: function() {\n      const data = {\n        \"from\": \"noreply@doichain.org\",\n        \"subject\": \"Doichain.org Newsletter BestÃ¤tigung\",\n        \"redirect\": \"https://www.doichain.org/vielen-dank/\",\n        \"returnPath\": \"noreply@doichain.org\",\n        \"content\":\"<style type='text/css' media='screen'>\\n\" +\n            \"* {\\n\" +\n            \"\\tline-height: inherit;\\n\" +\n            \"}\\n\" +\n            \".ExternalClass * {\\n\" +\n            \"\\tline-height: 100%;\\n\" +\n            \"}\\n\" +\n            \"body, p {\\n\" +\n            \"\\tmargin: 0;\\n\" +\n            \"\\tpadding: 0;\\n\" +\n            \"\\tmargin-bottom: 0;\\n\" +\n            \"\\t-webkit-text-size-adjust: none;\\n\" +\n            \"\\t-ms-text-size-adjust: none;\\n\" +\n            \"}\\n\" +\n            \"img {\\n\" +\n            \"\\tline-height: 100%;\\n\" +\n            \"\\toutline: none;\\n\" +\n            \"\\ttext-decoration: none;\\n\" +\n            \"\\t-ms-interpolation-mode: bicubic;\\n\" +\n            \"}\\n\" +\n            \"a img {\\n\" +\n            \"\\tborder: none;\\n\" +\n            \"}\\n\" +\n            \"#backgroundTable {\\n\" +\n            \"\\tmargin: 0;\\n\" +\n            \"\\tpadding: 0;\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"a, a:link, .no-detect-local a, .appleLinks a {\\n\" +\n            \"\\tcolor: #5555ff !important;\\n\" +\n            \"\\ttext-decoration: underline;\\n\" +\n            \"}\\n\" +\n            \".ExternalClass {\\n\" +\n            \"\\tdisplay: block !important;\\n\" +\n            \"\\twidth: 100%;\\n\" +\n            \"}\\n\" +\n            \".ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div {\\n\" +\n            \"\\tline-height: inherit;\\n\" +\n            \"}\\n\" +\n            \"table td {\\n\" +\n            \"\\tborder-collapse: collapse;\\n\" +\n            \"\\tmso-table-lspace: 0pt;\\n\" +\n            \"\\tmso-table-rspace: 0pt;\\n\" +\n            \"}\\n\" +\n            \"sup {\\n\" +\n            \"\\tposition: relative;\\n\" +\n            \"\\ttop: 4px;\\n\" +\n            \"\\tline-height: 7px !important;\\n\" +\n            \"\\tfont-size: 11px !important;\\n\" +\n            \"}\\n\" +\n            \".mobile_link a[href^='tel'], .mobile_link a[href^='sms'] {\\n\" +\n            \"\\ttext-decoration: default;\\n\" +\n            \"\\tcolor: #5555ff !important;\\n\" +\n            \"\\tpointer-events: auto;\\n\" +\n            \"\\tcursor: default;\\n\" +\n            \"}\\n\" +\n            \".no-detect a {\\n\" +\n            \"\\ttext-decoration: none;\\n\" +\n            \"\\tcolor: #5555ff;\\n\" +\n            \"\\tpointer-events: auto;\\n\" +\n            \"\\tcursor: default;\\n\" +\n            \"}\\n\" +\n            \"{\\n\" +\n            \"color: #5555ff;\\n\" +\n            \"}\\n\" +\n            \"span {\\n\" +\n            \"\\tcolor: inherit;\\n\" +\n            \"\\tborder-bottom: none;\\n\" +\n            \"}\\n\" +\n            \"span:hover {\\n\" +\n            \"\\tbackground-color: transparent;\\n\" +\n            \"}\\n\" +\n            \".nounderline {\\n\" +\n            \"\\ttext-decoration: none !important;\\n\" +\n            \"}\\n\" +\n            \"h1, h2, h3 {\\n\" +\n            \"\\tmargin: 0;\\n\" +\n            \"\\tpadding: 0;\\n\" +\n            \"}\\n\" +\n            \"p {\\n\" +\n            \"\\tMargin: 0px !important;\\n\" +\n            \"}\\n\" +\n            \"table[class='email-root-wrapper'] {\\n\" +\n            \"\\twidth: 600px !important;\\n\" +\n            \"}\\n\" +\n            \"body {\\n\" +\n            \"}\\n\" +\n            \"body {\\n\" +\n            \"\\tmin-width: 280px;\\n\" +\n            \"\\twidth: 100%;\\n\" +\n            \"}\\n\" +\n            \"td[class='pattern'] .c112p20r {\\n\" +\n            \"\\twidth: 20%;\\n\" +\n            \"}\\n\" +\n            \"td[class='pattern'] .c336p60r {\\n\" +\n            \"\\twidth: 60.000000000000256%;\\n\" +\n            \"}\\n\" +\n            \"</style>\\n\" +\n            \"<style>\\n\" +\n            \"@media only screen and (max-width: 599px), only screen and (max-device-width: 599px), only screen and (max-width: 400px), only screen and (max-device-width: 400px) {\\n\" +\n            \".email-root-wrapper {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \".full-width {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\theight: auto !important;\\n\" +\n            \"\\ttext-align: center;\\n\" +\n            \"}\\n\" +\n            \".fullwidthhalfleft {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \".fullwidthhalfright {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \".fullwidthhalfinner {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\tmargin: 0 auto !important;\\n\" +\n            \"\\tfloat: none !important;\\n\" +\n            \"\\tmargin-left: auto !important;\\n\" +\n            \"\\tmargin-right: auto !important;\\n\" +\n            \"\\tclear: both !important;\\n\" +\n            \"}\\n\" +\n            \".hide {\\n\" +\n            \"\\tdisplay: none !important;\\n\" +\n            \"\\twidth: 0px !important;\\n\" +\n            \"\\theight: 0px !important;\\n\" +\n            \"\\toverflow: hidden;\\n\" +\n            \"}\\n\" +\n            \".desktop-hide {\\n\" +\n            \"\\tdisplay: block !important;\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\theight: auto !important;\\n\" +\n            \"\\toverflow: hidden;\\n\" +\n            \"\\tmax-height: inherit !important;\\n\" +\n            \"}\\n\" +\n            \".c112p20r {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\tfloat: none;\\n\" +\n            \"}\\n\" +\n            \".c336p60r {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\tfloat: none;\\n\" +\n            \"}\\n\" +\n            \"}\\n\" +\n            \"</style>\\n\" +\n            \"<style>\\n\" +\n            \"@media only screen and (min-width: 600px) {\\n\" +\n            \"td[class='pattern'] .c112p20r {\\n\" +\n            \"\\twidth: 112px !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='pattern'] .c336p60r {\\n\" +\n            \"\\twidth: 336px !important;\\n\" +\n            \"}\\n\" +\n            \"}\\n\" +\n            \"\\n\" +\n            \"@media only screen and (max-width: 599px), only screen and (max-device-width: 599px), only screen and (max-width: 400px), only screen and (max-device-width: 400px) {\\n\" +\n            \"table[class='email-root-wrapper'] {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='wrap'] .full-width {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\theight: auto !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='wrap'] .fullwidthhalfleft {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='wrap'] .fullwidthhalfright {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='wrap'] .fullwidthhalfinner {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\tmargin: 0 auto !important;\\n\" +\n            \"\\tfloat: none !important;\\n\" +\n            \"\\tmargin-left: auto !important;\\n\" +\n            \"\\tmargin-right: auto !important;\\n\" +\n            \"\\tclear: both !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='wrap'] .hide {\\n\" +\n            \"\\tdisplay: none !important;\\n\" +\n            \"\\twidth: 0px;\\n\" +\n            \"\\theight: 0px;\\n\" +\n            \"\\toverflow: hidden;\\n\" +\n            \"}\\n\" +\n            \"td[class='pattern'] .c112p20r {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='pattern'] .c336p60r {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"}\\n\" +\n            \"\\n\" +\n            \"@media yahoo {\\n\" +\n            \"table {\\n\" +\n            \"\\tfloat: none !important;\\n\" +\n            \"\\theight: auto;\\n\" +\n            \"}\\n\" +\n            \"table[align='left'] {\\n\" +\n            \"\\tfloat: left !important;\\n\" +\n            \"}\\n\" +\n            \"td[align='left'] {\\n\" +\n            \"\\tfloat: left !important;\\n\" +\n            \"\\theight: auto;\\n\" +\n            \"}\\n\" +\n            \"table[align='center'] {\\n\" +\n            \"\\tmargin: 0 auto;\\n\" +\n            \"}\\n\" +\n            \"td[align='center'] {\\n\" +\n            \"\\tmargin: 0 auto;\\n\" +\n            \"\\theight: auto;\\n\" +\n            \"}\\n\" +\n            \"table[align='right'] {\\n\" +\n            \"\\tfloat: right !important;\\n\" +\n            \"}\\n\" +\n            \"td[align='right'] {\\n\" +\n            \"\\tfloat: right !important;\\n\" +\n            \"\\theight: auto;\\n\" +\n            \"}\\n\" +\n            \"}\\n\" +\n            \"</style>\\n\" +\n            \"\\n\" +\n            \"<!--[if (gte IE 7) & (vml)]>\\n\" +\n            \"<style type='text/css'>\\n\" +\n            \"html, body {margin:0 !important; padding:0px !important;}\\n\" +\n            \"img.full-width { position: relative !important; }\\n\" +\n            \"\\n\" +\n            \".img240x30 { width: 240px !important; height: 30px !important;}\\n\" +\n            \".img20x20 { width: 20px !important; height: 20px !important;}\\n\" +\n            \"\\n\" +\n            \"</style>\\n\" +\n            \"<![endif]-->\\n\" +\n            \"\\n\" +\n            \"<!--[if gte mso 9]>\\n\" +\n            \"<style type='text/css'>\\n\" +\n            \".mso-font-fix-arial { font-family: Arial, sans-serif;}\\n\" +\n            \".mso-font-fix-georgia { font-family: Georgia, sans-serif;}\\n\" +\n            \".mso-font-fix-tahoma { font-family: Tahoma, sans-serif;}\\n\" +\n            \".mso-font-fix-times_new_roman { font-family: 'Times New Roman', sans-serif;}\\n\" +\n            \".mso-font-fix-trebuchet_ms { font-family: 'Trebuchet MS', sans-serif;}\\n\" +\n            \".mso-font-fix-verdana { font-family: Verdana, sans-serif;}\\n\" +\n            \"</style>\\n\" +\n            \"<![endif]-->\\n\" +\n            \"\\n\" +\n            \"<!--[if gte mso 9]>\\n\" +\n            \"<style type='text/css'>\\n\" +\n            \"table, td {\\n\" +\n            \"border-collapse: collapse !important;\\n\" +\n            \"mso-table-lspace: 0px !important;\\n\" +\n            \"mso-table-rspace: 0px !important;\\n\" +\n            \"}\\n\" +\n            \"\\n\" +\n            \".email-root-wrapper { width 600px !important;}\\n\" +\n            \".imglink { font-size: 0px; }\\n\" +\n            \".edm_button { font-size: 0px; }\\n\" +\n            \"</style>\\n\" +\n            \"<![endif]-->\\n\" +\n            \"\\n\" +\n            \"<!--[if gte mso 15]>\\n\" +\n            \"<style type='text/css'>\\n\" +\n            \"table {\\n\" +\n            \"font-size:0px;\\n\" +\n            \"mso-margin-top-alt:0px;\\n\" +\n            \"}\\n\" +\n            \"\\n\" +\n            \".fullwidthhalfleft {\\n\" +\n            \"width: 49% !important;\\n\" +\n            \"float:left !important;\\n\" +\n            \"}\\n\" +\n            \"\\n\" +\n            \".fullwidthhalfright {\\n\" +\n            \"width: 50% !important;\\n\" +\n            \"float:right !important;\\n\" +\n            \"}\\n\" +\n            \"</style>\\n\" +\n            \"<![endif]-->\\n\" +\n            \"<style type='text/css' media='(pointer) and (min-color-index:0)'>\\n\" +\n            \"html, body {\\n\" +\n            \"\\tbackground-image: none !important;\\n\" +\n            \"\\tbackground-color: #ebebeb !important;\\n\" +\n            \"\\tmargin: 0 !important;\\n\" +\n            \"\\tpadding: 0 !important;\\n\" +\n            \"}\\n\" +\n            \"</style>\\n\" +\n            \"</head>\\n\" +\n            \"<body leftmargin='0' marginwidth='0' topmargin='0' marginheight='0' offset='0' background=\\\"\\\" bgcolor='#ebebeb' style='font-family:Arial, sans-serif; font-size:0px;margin:0;padding:0; '>\\n\" +\n            \"<!--[if t]><![endif]--><!--[if t]><![endif]--><!--[if t]><![endif]--><!--[if t]><![endif]--><!--[if t]><![endif]--><!--[if t]><![endif]-->\\n\" +\n            \"<table align='center' border='0' cellpadding='0' cellspacing='0' background=\\\"\\\"  height='100%' width='100%' id='backgroundTable'>\\n\" +\n            \"  <tr>\\n\" +\n            \"    <td class='wrap' align='center' valign='top' width='100%'>\\n\" +\n            \"\\t\\t<center>\\n\" +\n            \"        <!-- content -->\\n\" +\n            \"        \\t<div style='padding: 0px;'>\\n\" +\n            \"        \\t  <table cellpadding='0' cellspacing='0' border='0' width='100%' bgcolor='#ebebeb'>\\n\" +\n            \"           \\t\\t <tr>\\n\" +\n            \"            \\t\\t  <td valign='top' style='padding: 0px;'>\\n\" +\n            \"\\t\\t\\t\\t\\t\\t  <table cellpadding='0' cellspacing='0' width='600' align='center' style='max-width: 600px;min-width: 240px;margin: 0 auto;' class='email-root-wrapper'>\\n\" +\n            \"                 \\t\\t \\t\\t<tr>\\n\" +\n            \"                   \\t\\t\\t\\t\\t <td valign='top' style='padding: 0px;'>\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t \\t\\t<table cellpadding='0' cellspacing='0' border='0' width='100%' bgcolor='#FFFFFF' style='border: 0px none;background-color: #FFFFFF;'>\\n\" +\n            \"                       \\t\\t\\t\\t\\t\\t <tr>\\n\" +\n            \"                       \\t\\t\\t  \\t\\t\\t\\t <td valign='top' style='padding-top: 30px;padding-right: 20px;padding-bottom: 35px;padding-left: 20px;'>\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t\\t   \\t\\t\\t\\t\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<table cellpadding='0'\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tcellspacing='0' border='0' align='center' width='240'  style='border: 0px none;height: auto;' class='full-width'>\\n\" +\n            \"                                         \\t \\t\\t\\t\\t\\t\\t\\t\\t\\t<tr>\\n\" +\n            \"                                            \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<td valign='top' style='padding: 0px;'><img src='https://sf26.sendsfx.com/admin/temp/user/17/doichain_100h.png' width='240' height='30' alt=\\\"\\\" border='0' style='display: block;width: 100%;height: auto;' class='full-width img240x30' /></td>\\n\" +\n            \"                                         \\t \\t\\t\\t\\t\\t\\t\\t\\t\\t</tr>\\n\" +\n            \"                                        \\t\\t\\t\\t\\t\\t\\t\\t\\t</table>\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</td>\\n\" +\n            \"                      \\t\\t  \\t\\t\\t\\t</tr>\\n\" +\n            \"                      \\t\\t\\t\\t\\t</table>\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t \\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t \\n\" +\n            \"                      <table cellpadding='0' cellspacing='0' border='0' width='100%' bgcolor='#0071aa' style='border: 0px none;background-color: #0071aa;background-image: url('https://sf26.sendsfx.com/admin/temp/user/17/blue-bg.jpg');background-repeat: no-repeat ;background-position: center;'>\\n\" +\n            \"                        <tr>\\n\" +\n            \"                          <td valign='top' style='padding-top: 40px;padding-right: 20px;padding-bottom: 45px;padding-left: 20px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                              <tr>\\n\" +\n            \"                                <td style='padding: 0px;' class='pattern'><table cellpadding='0' cellspacing='0' border='0' width='100%'>\\n\" +\n            \"                                    <tr>\\n\" +\n            \"                                      <td valign='top' style='padding-bottom: 10px;'><div style='text-align: left;font-family: arial;font-size: 20px;color: #ffffff;line-height: 30px;mso-line-height: exactly;mso-text-raise: 5px;'>\\n\" +\n            \"                                          <p\\n\" +\n            \"style='padding: 0; margin: 0;text-align: center;'>Bitte bestÃ¤tigen Sie Ihre Anmeldung</p>\\n\" +\n            \"                                        </div></td>\\n\" +\n            \"                                    </tr>\\n\" +\n            \"                                  </table>\\n\" +\n            \"                                  <table cellpadding='0' cellspacing='0' border='0' width='100%'>\\n\" +\n            \"                                    <tr>\\n\" +\n            \"                                      <td valign='top' style='padding: 0;mso-cellspacing: 0in;'><table cellpadding='0' cellspacing='0' border='0' align='left' width='112'  style='float: left;' class='c112p20r'>\\n\" +\n            \"                                          <tr>\\n\" +\n            \"                                            <td valign='top' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' width='100%' style='border: 0px none;' class='hide'>\\n\" +\n            \"                                                <tr>\\n\" +\n            \"                                                  <td valign='top' style='padding: 0px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                      <tr>\\n\" +\n            \"                                                        <td style='padding: 0px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                            <tr>\\n\" +\n            \"                                                              <td align='center' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' align='center' width='20'  style='border: 0px none;height: auto;'>\\n\" +\n            \"                                                                  <tr>\\n\" +\n            \"                                                                    <td valign='top' style='padding: 0px;'><img\\n\" +\n            \"src='https://sf26.sendsfx.com/admin/temp/user/17/img_89837318.png' width='20' height='20' alt=\\\"\\\" border='0' style='display: block;' class='img20x20' /></td>\\n\" +\n            \"                                                                  </tr>\\n\" +\n            \"                                                                </table></td>\\n\" +\n            \"                                                            </tr>\\n\" +\n            \"                                                          </table></td>\\n\" +\n            \"                                                      </tr>\\n\" +\n            \"                                                    </table></td>\\n\" +\n            \"                                                </tr>\\n\" +\n            \"                                              </table></td>\\n\" +\n            \"                                          </tr>\\n\" +\n            \"                                        </table>\\n\" +\n            \"                                        \\n\" +\n            \"                                        <!--[if gte mso 9]></td><td valign='top' style='padding:0;'><![endif]-->\\n\" +\n            \"                                        \\n\" +\n            \"                                        <table cellpadding='0' cellspacing='0' border='0' align='left' width='336'  style='float: left;' class='c336p60r'>\\n\" +\n            \"                                          <tr>\\n\" +\n            \"                                            <td valign='top' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' width='100%'>\\n\" +\n            \"                                                <tr>\\n\" +\n            \"                                                  <td valign='top' style='padding-bottom: 30px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                      <tr>\\n\" +\n            \"                                                        <td style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' width='100%' style='border-top: 2px solid #ffffff;'>\\n\" +\n            \"                                                            <tr>\\n\" +\n            \"                                                              <td valign='top'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                                  <tr>\\n\" +\n            \"                                                                    <td style='padding: 0px;'></td>\\n\" +\n            \"                                                                  </tr>\\n\" +\n            \"                                                                </table></td>\\n\" +\n            \"                                                            </tr>\\n\" +\n            \"                                                          </table></td>\\n\" +\n            \"                                                      </tr>\\n\" +\n            \"                                                    </table></td>\\n\" +\n            \"                                                </tr>\\n\" +\n            \"                                              </table></td>\\n\" +\n            \"                                          </tr>\\n\" +\n            \"                                        </table>\\n\" +\n            \"                                        \\n\" +\n            \"                                        <!--[if gte mso 9]></td><td valign='top' style='padding:0;'><![endif]-->\\n\" +\n            \"                                        \\n\" +\n            \"                                        <table cellpadding='0' cellspacing='0' border='0' align='left' width='112'  style='float: left;' class='c112p20r'>\\n\" +\n            \"                                          <tr>\\n\" +\n            \"                                            <td valign='top' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' width='100%' style='border: 0px none;' class='hide'>\\n\" +\n            \"                                                <tr>\\n\" +\n            \"                                                  <td valign='top' style='padding: 0px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                      <tr>\\n\" +\n            \"                                                        <td style='padding: 0px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                            <tr>\\n\" +\n            \"                                                              <td align='center' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' align='center' width='20'  style='border: 0px none;height: auto;'>\\n\" +\n            \"                                                                  <tr>\\n\" +\n            \"                                                                    <td valign='top' style='padding: 0px;'><img src='https://sf26.sendsfx.com/admin/temp/user/17/img_89837318.png' width='20' height='20' alt=\\\"\\\" border='0' style='display: block;' class='img20x20'\\n\" +\n            \"/></td>\\n\" +\n            \"                                                                  </tr>\\n\" +\n            \"                                                                </table></td>\\n\" +\n            \"                                                            </tr>\\n\" +\n            \"                                                          </table></td>\\n\" +\n            \"                                                      </tr>\\n\" +\n            \"                                                    </table></td>\\n\" +\n            \"                                                </tr>\\n\" +\n            \"                                              </table></td>\\n\" +\n            \"                                          </tr>\\n\" +\n            \"                                        </table></td>\\n\" +\n            \"                                    </tr>\\n\" +\n            \"                                  </table>\\n\" +\n            \"                                  <table cellpadding='0' cellspacing='0' border='0' width='100%'>\\n\" +\n            \"                                    <tr>\\n\" +\n            \"                                      <td valign='top' style='padding-bottom: 20px;'><div style='text-align: left;font-family: arial;font-size: 16px;color: #ffffff;line-height: 26px;mso-line-height: exactly;mso-text-raise: 5px;'>\\n\" +\n            \"                                          <p style='padding: 0; margin: 0;text-align: center;'>Vielen Dank, dass Sie sich fÃ¼r unseren Newsletter angemeldet haben.</p>\\n\" +\n            \"                                          <p style='padding: 0; margin: 0;text-align: center;'>Um diese E-Mail-Adresse und Ihre kostenlose Anmeldung zu bestÃ¤tigen, klicken Sie bitte jetzt auf den folgenden Button:</p>\\n\" +\n            \"                                        </div></td>\\n\" +\n            \"                                    </tr>\\n\" +\n            \"                                  </table>\\n\" +\n            \"                                  <table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                    <tr>\\n\" +\n            \"                                      <td align='center' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' align='center' style='text-align: center;color: #000;' class='full-width'>\\n\" +\n            \"                                          <tr>\\n\" +\n            \"                                            <td valign='top' align='center' style='padding-right: 10px;padding-bottom: 30px;padding-left: 10px;'><table cellpadding='0' cellspacing='0' border='0' bgcolor='#85ac1c' style='border: 0px none;border-radius: 5px;border-collapse: separate !important;background-color: #85ac1c;' class='full-width'>\\n\" +\n            \"                                                <tr>\\n\" +\n            \"                                                  <td valign='top' align='center' style='padding: 12px;'><a href='${confirmation_url}' target='_blank' style='text-decoration: none;' class='edm_button'><span style='font-family: arial;font-size: 18px;color: #ffffff;line-height: 28px;text-decoration: none;'><span\\n\" +\n            \"style='font-size: 18px;'>Jetzt Anmeldung best&auml;tigen</span></span> </a></td>\\n\" +\n            \"                                                </tr>\\n\" +\n            \"                                              </table></td>\\n\" +\n            \"                                          </tr>\\n\" +\n            \"                                        </table></td>\\n\" +\n            \"                                    </tr>\\n\" +\n            \"                                  </table>\\n\" +\n            \"                                  <div style='text-align: left;font-family: arial;font-size: 12px;color: #ffffff;line-height: 22px;mso-line-height: exactly;mso-text-raise: 5px;'>\\n\" +\n            \"                                    <p style='padding: 0; margin: 0;text-align: center;'>Wenn Sie ihre E-Mail-Adresse nicht bestÃ¤tigen, kÃ¶nnen keine Newsletter zugestellt werden. Ihr EinverstÃ¤ndnis kÃ¶nnen Sie selbstverstÃ¤ndlich jederzeit widerrufen. Sollte es sich bei der Anmeldung um ein Versehen handeln oder wurde der Newsletter nicht in Ihrem Namen bestellt, kÃ¶nnen Sie diese E-Mail einfach ignorieren. Ihnen werden keine weiteren Nachrichten zugeschickt.</p>\\n\" +\n            \"                                  </div></td>\\n\" +\n            \"                              </tr>\\n\" +\n            \"                            </table></td>\\n\" +\n            \"                        </tr>\\n\" +\n            \"                      </table>\\n\" +\n            \"                      <table cellpadding='0' cellspacing='0' border='0' width='100%' bgcolor='#ffffff' style='border: 0px none;background-color: #ffffff;'>\\n\" +\n            \"                        <tr>\\n\" +\n            \"                          <td valign='top' style='padding-top: 30px;padding-right: 20px;padding-bottom: 35px;padding-left: 20px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                              <tr>\\n\" +\n            \"                                <td style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' width='100%'>\\n\" +\n            \"                                    <tr>\\n\" +\n            \"                                      <td valign='top' style='padding-bottom: 25px;'><div style='text-align: left;font-family: arial;font-size: 12px;color: #333333;line-height: 22px;mso-line-height: exactly;mso-text-raise: 5px;'>\\n\" +\n            \"                                          <p style='padding: 0; margin: 0;text-align: center;'><span style='line-height: 3;'><strong>Kontakt</strong></span><br>\\n\" +\n            \"                                            service@sendeffect.de<br>\\n\" +\n            \"                                            www.sendeffect.de<br>\\n\" +\n            \"                                            Telefon: +49 (0) 8571 - 97 39 - 69-0</p>\\n\" +\n            \"                                        </div></td>\\n\" +\n            \"                                    </tr>\\n\" +\n            \"                                  </table>\\n\" +\n            \"                                  <div style='text-align: left;font-family: arial;font-size: 12px;color: #333333;line-height: 22px;mso-line-height: exactly;mso-text-raise: 5px;'>\\n\" +\n            \"                                    <p style='padding: 0; margin: 0;text-align: center;'><span style='line-height: 3;'><strong>Impressum</strong></span><br>\\n\" +\n            \"                                      Anschrift: Schulgasse 5, D-84359 Simbach am Inn, eMail: service@sendeffect.de<br>\\n\" +\n            \"                                      Betreiber: WEBanizer AG, Registergericht: Amtsgericht Landshut HRB 5177, UstId.: DE 2068 62 070<br>\\n\" +\n            \"                                      Vorstand: Ottmar Neuburger, Aufsichtsrat: Tobias Neuburger</p>\\n\" +\n            \"                                  </div></td>\\n\" +\n            \"                              </tr>\\n\" +\n            \"                            </table></td>\\n\" +\n            \"                        </tr>\\n\" +\n            \"                      </table></td>\\n\" +\n            \"                  </tr>\\n\" +\n            \"                </table></td>\\n\" +\n            \"            </tr>\\n\" +\n            \"          </table>\\n\" +\n            \"        </div>\\n\" +\n            \"        <!-- content end -->\\n\" +\n            \"      </center></td>\\n\" +\n            \"  </tr>\\n\" +\n            \"</table>\"\n      }\n\n      return {\"status\": \"success\", \"data\": data};\n    }\n  }\n});\n","import { Api, DOI_FETCH_ROUTE, DOI_CONFIRMATION_NOTIFY_ROUTE } from '../rest.js';\nimport addOptIn from '../../../../imports/modules/server/opt-ins/add_and_write_to_blockchain.js';\nimport updateOptInStatus from '../../../../imports/modules/server/opt-ins/update_status.js';\nimport getDoiMailData from '../../../../imports/modules/server/dapps/get_doi-mail-data.js';\nimport {logError, logSend} from \"../../../../imports/startup/server/log-configuration\";\nimport {DOI_EXPORT_ROUTE} from \"../rest\";\nimport exportDois from \"../../../../imports/modules/server/dapps/export_dois\";\nimport {OptIns} from \"../../../../imports/api/opt-ins/opt-ins\";\nimport {Roles} from \"meteor/alanning:roles\";\n\n//doku of meteor-restivus https://github.com/kahmali/meteor-restivus\n\nApi.addRoute(DOI_CONFIRMATION_NOTIFY_ROUTE, {\n  post: {\n    authRequired: true,\n    //roleRequired: ['admin'],\n    action: function() {\n      const qParams = this.queryParams;\n      const bParams = this.bodyParams;\n      let params = {}\n      if(qParams !== undefined) params = {...qParams}\n      if(bParams !== undefined) params = {...params, ...bParams}\n\n      const uid = this.userId;\n\n      if(!Roles.userIsInRole(uid, 'admin') || //if its not an admin always use uid as ownerId\n          (Roles.userIsInRole(uid, 'admin') && (params[\"ownerId\"]==null || params[\"ownerId\"]==undefined))) {  //if its an admin only use uid in case no ownerId was given\n          params[\"ownerId\"] = uid;\n      }\n\n      logSend('parameter received from browser:',params);\n      if(params.sender_mail.constructor === Array){ //this is a SOI with co-sponsors first email is main sponsor\n          return prepareCoDOI(params);\n      }else{\n         return prepareAdd(params);\n      }\n    }\n  },\n  put: {\n    authRequired: false,\n    action: function() {\n      const qParams = this.queryParams;\n      const bParams = this.bodyParams;\n\n      logSend('qParams:',qParams);\n      logSend('bParams:',bParams);\n\n      let params = {}\n      if(qParams !== undefined) params = {...qParams}\n      if(bParams !== undefined) params = {...params, ...bParams}\n      try {\n        const val = updateOptInStatus(params);\n        logSend('opt-In status updated',val);\n        return {status: 'success', data: {message: 'Opt-In status updated'}};\n      } catch(error) {\n        return {statusCode: 500, body: {status: 'fail', message: error.message}};\n      }\n    }\n  }\n});\n\nApi.addRoute(DOI_FETCH_ROUTE, {authRequired: false}, {\n  get: {\n    action: function() {\n      const params = this.queryParams;\n      try {\n          logSend('rest api - DOI_FETCH_ROUTE called by bob to request email template',JSON.stringify(params));\n          const data = getDoiMailData(params);\n          logSend('got doi-mail-data (including templalte) returning to bob',{subject:data.subject, recipient:data.recipient});\n        return {status: 'success', data};\n      } catch(error) {\n        logError('error while getting DoiMailData',error);\n        return {status: 'fail', error: error.message};\n      }\n    }\n  }\n});\n\nApi.addRoute(DOI_EXPORT_ROUTE, {\n    get: {\n        authRequired: true,\n        //roleRequired: ['admin'],\n        action: function() {\n            let params = this.queryParams;\n            const uid = this.userId;\n            if(!Roles.userIsInRole(uid, 'admin')){\n                params = {userid:uid,role:'user'};\n            }\n            else{\n                params = {...params,role:'admin'}\n            }\n            try {\n                logSend('rest api - DOI_EXPORT_ROUTE called',JSON.stringify(params));\n                const data = exportDois(params);\n                logSend('got dois from database',JSON.stringify(data));\n                return {status: 'success', data};\n            } catch(error) {\n                logError('error while exporting confirmed dois',error);\n                return {status: 'fail', error: error.message};\n            }\n        }\n    }\n});\n\nfunction prepareCoDOI(params){\n\n    logSend('is array ',params.sender_mail);\n\n    const senders = params.sender_mail;\n    const recipient_mail = params.recipient_mail;\n    const data = params.data;\n    const ownerID = params.ownerId;\n\n    let currentOptInId;\n    let retResponse = [];\n    let master_doi;\n    senders.forEach((sender,index) => {\n\n        const ret_response = prepareAdd({sender_mail:sender,recipient_mail:recipient_mail,data:data, master_doi:master_doi, index: index, ownerId:ownerID});\n        logSend('CoDOI:',ret_response);\n        if(ret_response.status === undefined || ret_response.status===\"failed\") throw \"could not add co-opt-in\";\n        retResponse.push(ret_response);\n        currentOptInId = ret_response.data.id;\n\n        if(index===0)\n        {\n            logSend('main sponsor optInId:',currentOptInId);\n            const optIn = OptIns.findOne({_id: currentOptInId});\n            master_doi = optIn.nameId;\n            logSend('main sponsor nameId:',master_doi);\n        }\n\n    });\n\n    logSend(retResponse);\n\n    return retResponse;\n}\n\nfunction prepareAdd(params){\n\n    try {\n        const val = addOptIn(params);\n        logSend('opt-In added ID:',val);\n        return {status: 'success', data: {id: val, status: 'success', message: 'Opt-In added.'}};\n    } catch(error) {\n        return {statusCode: 500, body: {status: 'fail', message: error.message}};\n    }\n}","import { Api } from '../rest.js';\nimport {getInfo} from \"../../doichain\";\nimport { CONFIRM_CLIENT,SEND_CLIENT} from \"../../../../imports/startup/server/doichain-configuration\";\n\nApi.addRoute('status', {authRequired: false}, {\n  get: {\n    action: function() {\n      try {\n        const data = getInfo(SEND_CLIENT?SEND_CLIENT:CONFIRM_CLIENT);\n        return {\"status\": \"success\", \"data\":data};\n      }catch(ex){\n            return {\"status\": \"failed\", \"data\": ex.toString()};\n      }\n    }\n  }\n});\n","import { Api } from '../rest.js';\nimport {Meteor} from 'meteor/meteor';\nimport {Accounts} from 'meteor/accounts-base'\nimport SimpleSchema from 'simpl-schema';\nimport {Roles} from \"meteor/alanning:roles\";\nimport {logMain} from \"../../../../imports/startup/server/log-configuration\";\n\nconst mailTemplateSchema = new SimpleSchema({\n    subject: {\n        type: String,\n        optional:true \n    },\n    redirect: {\n        type: String,\n        regEx: \"@(https?|ftp)://(-\\\\.)?([^\\\\s/?\\\\.#-]+\\\\.?)+(/[^\\\\s]*)?$@\",\n        optional:true \n    },\n    returnPath: {\n        type: String,\n        regEx: SimpleSchema.RegEx.Email,\n        optional:true \n    },\n    templateURL:{\n        type: String,\n        regEx: \"@(https?|ftp)://(-\\\\.)?([^\\\\s/?\\\\.#-]+\\\\.?)+(/[^\\\\s]*)?$@\",\n        optional:true \n    }\n});\n\nconst createUserSchema = new SimpleSchema({\n    username: {\n      type: String,\n      regEx: \"^[A-Z,a-z,0-9,!,_,$,#]{4,24}$\"  //Only usernames between 4-24 characters from A-Z,a-z,0-9,!,_,$,# allowed\n    },\n    email: {\n      type: String,\n      regEx: SimpleSchema.RegEx.Email\n    },\n    password: {\n      type: String,\n      regEx: \"^[A-Z,a-z,0-9,!,_,$,#]{8,24}$\" //Only passwords between 8-24 characters from A-Z,a-z,0-9,!,_,$,# allowed\n    },\n    mailTemplate:{\n        type: mailTemplateSchema,\n        optional:true \n    }\n  });\n  const updateUserSchema = new SimpleSchema({\n    mailTemplate:{\n        type: mailTemplateSchema\n    }\n});\n\n//TODO: collection options separate\nconst collectionOptions =\n  {\n    path:\"users\",\n    routeOptions:\n    {\n        authRequired : true\n        //,roleRequired : \"admin\"\n    },\n    excludedEndpoints: ['patch','deleteAll'],\n    endpoints:\n    {\n        delete:{roleRequired : \"admin\"},\n        post:\n        {\n            roleRequired : \"admin\",\n            action: function(){\n                const qParams = this.queryParams;\n                const bParams = this.bodyParams;\n                let params = {};\n                if(qParams !== undefined) params = {...qParams}\n                if(bParams !== undefined) params = {...params, ...bParams}\n                try{\n                    let userId;\n                    createUserSchema.validate(params);\n                    logMain('validated',params);\n                    if(params.mailTemplate !== undefined){\n                        userId = Accounts.createUser({username:params.username,\n                            email:params.email,\n                            password:params.password,\n                            profile:{mailTemplate:params.mailTemplate}});\n                    }\n                    else{\n                        userId = Accounts.createUser({username:params.username,email:params.email,password:params.password, profile:{}});\n                    }    \n                    return {status: 'success', data: {userid: userId}};\n                } catch(error) {\n                  return {statusCode: 400, body: {status: 'fail', message: error.message}};\n                }\n                \n            }\n        },\n        put:\n        {\n            action: function(){      \n                const qParams = this.queryParams;\n                const bParams = this.bodyParams;\n                let params = {};\n                let uid=this.userId;\n                const paramId=this.urlParams.id;\n                if(qParams !== undefined) params = {...qParams}\n                if(bParams !== undefined) params = {...params, ...bParams}\n\n                try{ //TODO this is not necessary here and can probably go right into the definition of the REST METHOD next to put (!?!)\n                    if(!Roles.userIsInRole(uid, 'admin')){\n                        if(uid!==paramId){\n                            throw Error(\"No Permission\");\n                        }\n                    }\n                    updateUserSchema.validate(params);\n                    if(!Meteor.users.update(this.urlParams.id,{$set:{\"profile.mailTemplate\":params.mailTemplate}})){\n                        throw Error(\"Failed to update user\");\n                    }\n                    return {status: 'success', data: {userid: this.urlParams.id, mailTemplate:params.mailTemplate}};\n                } catch(error) {\n                  return {statusCode: 400, body: {status: 'fail', message: error.message}};\n                }\n            }\n        }\n    }\n}\nApi.addCollection(Meteor.users,collectionOptions);","import { Api } from '../rest.js';\nimport verifyOptIn from '../../../../imports/modules/server/opt-ins/verify.js';\n\nApi.addRoute('opt-in/verify', {authRequired: true}, {\n  get: {\n    authRequired: false,\n    action: function() {\n        const qParams = this.queryParams;\n        const bParams = this.bodyParams;\n        let params = {}\n        if(qParams !== undefined) params = {...qParams}\n        if(bParams !== undefined) params = {...params, ...bParams}\n\n      try {\n        const val = verifyOptIn(params);\n        return {status: \"success\", data: {val}};\n      } catch(error) {\n        return {statusCode: 500, body: {status: 'fail', message: error.message}};\n      }\n    }\n  }\n});\n","import { Restivus } from 'meteor/nimble:restivus';\nimport { isDebug } from '../../../imports/startup/server/dapp-configuration.js';\nimport { SEND_APP, CONFIRM_APP, VERIFY_APP, isAppType } from '../../../imports/startup/server/type-configuration.js';\n\nexport const DOI_CONFIRMATION_ROUTE = \"opt-in/confirm\";\nexport const DOI_CONFIRMATION_NOTIFY_ROUTE = \"opt-in\";\nexport const DOI_WALLETNOTIFY_ROUTE = \"walletnotify\";\nexport const DOI_FETCH_ROUTE = \"doi-mail\";\nexport const DOI_EXPORT_ROUTE = \"export\";\nexport const API_PATH = \"api/\";\nexport const VERSION = \"v1\";\n\nexport const Api = new Restivus({\n  apiPath: API_PATH,\n  version: VERSION,\n  useDefaultAuth: true,\n  prettyJson: true\n});\n\nif(isDebug()) require('./imports/debug.js');\nif(isAppType(SEND_APP)) require('./imports/send.js');\nif(isAppType(CONFIRM_APP)) require('./imports/confirm.js');\nif(isAppType(VERIFY_APP)) require('./imports/verify.js');\nrequire('./imports/user.js');\nrequire('./imports/status.js');\n","\nimport { JobCollection,Job } from 'meteor/vsivsi:job-collection';\nexport const BlockchainJobs = JobCollection('blockchain');\nimport { Meteor } from 'meteor/meteor';\nimport insert from '../../imports/modules/server/doichain/insert.js';\nimport update from '../../imports/modules/server/doichain/update.js';\n/* eslint-disable no-unused-vars */ //TODO re-enable this!\nimport checkNewTransaction from '../../imports/modules/server/doichain/check_new_transactions.js';\nimport { CONFIRM_APP, isAppType } from '../../imports/startup/server/type-configuration.js';\nimport {logMain} from \"../../imports/startup/server/log-configuration\";\n\nBlockchainJobs.processJobs('insert', {workTimeout: 30*1000},function (job, cb) {\n  try {\n    const entry = job.data;\n    insert(entry);\n    job.done();\n  } catch(exception) {\n    job.fail();\n\n      throw new Meteor.Error('jobs.blockchain.insert.exception', exception);\n  } finally {\n    cb();\n  }\n});\n\nBlockchainJobs.processJobs('update', {workTimeout: 30*1000},function (job, cb) {\n  try {\n    const entry = job.data;\n    update(entry,job);\n  } catch(exception) {\n    job.fail();\n    throw new Meteor.Error('jobs.blockchain.update.exception', exception);\n  } finally {\n    cb();\n  }\n});\n\nBlockchainJobs.processJobs('checkNewTransaction', {workTimeout: 30*1000},function (job, cb) {\n  try {\n    if(!isAppType(CONFIRM_APP)) {\n      job.pause();\n      job.cancel();\n      job.remove();\n    } else {\n      //checkNewTransaction(null,job);\n    }\n  } catch(exception) {\n    job.fail();\n    throw new Meteor.Error('jobs.blockchain.checkNewTransactions.exception', exception);\n  } finally {\n    cb();\n  }\n});\n\nnew Job(BlockchainJobs, 'cleanup', {})\n    .repeat({ schedule: BlockchainJobs.later.parse.text(\"every 5 minutes\") })\n    .save({cancelRepeats: true});\n\nlet q = BlockchainJobs.processJobs('cleanup',{ pollInterval: false, workTimeout: 60*1000 } ,function (job, cb) {\n  const current = new Date()\n    current.setMinutes(current.getMinutes() - 5);\n\n  const ids = BlockchainJobs.find({\n          status: {$in: Job.jobStatusRemovable},\n          updated: {$lt: current}},\n          {fields: { _id: 1 }});\n\n    logMain('found  removable blockchain jobs:',ids);\n    BlockchainJobs.removeJobs(ids);\n    if(ids.length > 0){\n      job.done(\"Removed #{ids.length} old jobs\");\n    }\n    cb();\n});\n\nBlockchainJobs.find({ type: 'jobType', status: 'ready' })\n    .observe({\n        added: function () { q.trigger(); }\n    });\n","import { JobCollection, Job } from 'meteor/vsivsi:job-collection';\nimport fetchDoiMailData from '../../imports/modules/server/dapps/fetch_doi-mail-data.js';\nimport { Meteor } from 'meteor/meteor';\nimport {logMain} from \"../../imports/startup/server/log-configuration\";\nimport {BlockchainJobs} from \"./blockchain_jobs\";\n\nexport const DAppJobs = JobCollection('dapp');\n\nDAppJobs.processJobs('fetchDoiMailData', function (job, cb) {\n  try {\n    const data = job.data;\n    fetchDoiMailData(data);\n    job.done();\n  } catch(exception) {\n    job.fail();\n    throw new Meteor.Error('jobs.dapp.fetchDoiMailData.exception', exception);\n  } finally {\n    cb();\n  }\n});\n\n\nnew Job(DAppJobs, 'cleanup', {})\n    .repeat({ schedule: DAppJobs.later.parse.text(\"every 5 minutes\") })\n    .save({cancelRepeats: true});\n\nlet q = DAppJobs.processJobs('cleanup',{ pollInterval: false, workTimeout: 60*1000 } ,function (job, cb) {\n    const current = new Date()\n    current.setMinutes(current.getMinutes() - 5);\n\n    const ids = DAppJobs.find({\n            status: {$in: Job.jobStatusRemovable},\n            updated: {$lt: current}},\n        {fields: { _id: 1 }});\n\n    logMain('found  removable blockchain jobs:',ids);\n    DAppJobs.removeJobs(ids);\n    if(ids.length > 0){\n        job.done(\"Removed #{ids.length} old jobs\");\n    }\n    cb();\n});\n\nDAppJobs.find({ type: 'jobType', status: 'ready' })\n    .observe({\n        added: function () { q.trigger(); }\n    });\n","import { Meteor } from 'meteor/meteor';\nimport dns from 'dns';\nimport {logSend} from \"../../imports/startup/server/log-configuration\";\n\nexport function resolveTxt(key, domain) {\n  const syncFunc = Meteor.wrapAsync(dns_resolveTxt);\n  try {\n    const records = syncFunc(key, domain);\n    if(records === undefined) return undefined;\n    let value = undefined;\n    records.forEach(record => {\n      if(record[0].startsWith(key)) {\n        const val = record[0].substring(key.length+1);\n        value = val.trim();\n\n      }\n    });\n    return value;\n  } catch(error) {\n    logSend(\"error while asking dns servers from \",dns.getServers());\n    if(error.message.startsWith(\"queryTxt ENODATA\") ||\n        error.message.startsWith(\"queryTxt ENOTFOUND\")) return undefined;\n    else throw error;\n  }\n}\n\nfunction dns_resolveTxt(key, domain, callback) {\n    logSend(\"resolving dns txt attribute: \", {key:key,domain:domain});\n    dns.resolveTxt(domain, (err, records) => {\n    callback(err, records);\n  });\n}\n","import { Meteor } from 'meteor/meteor';\nimport {logBlockchain, logConfirm, logError} from \"../../imports/startup/server/log-configuration\";\n\n\nconst NAMESPACE = 'e/';\n\n\nexport function getWif(client, address) {\n  if(!address){\n        address = getAddressesByAccount(\"\")[0];\n        logBlockchain('address was not defined so getting the first existing one of the wallet:',address);\n  }\n  if(!address){\n        address = getNewAddress(\"\");\n        logBlockchain('address was never defined  at all generated new address for this wallet:',address);\n  }\n  const syncFunc = Meteor.wrapAsync(doichain_dumpprivkey);\n  return syncFunc(client, address);\n}\n\nfunction doichain_dumpprivkey(client, address, callback) {\n  const ourAddress = address;\n  client.cmd('dumpprivkey', ourAddress, function(err, data) {\n    if(err)  logError('doichain_dumpprivkey:',err);\n    callback(err, data);\n  });\n}\n\nexport function getAddressesByAccount(client, accout) {\n    const syncFunc = Meteor.wrapAsync(doichain_getaddressesbyaccount);\n    return syncFunc(client, accout);\n}\n\nfunction doichain_getaddressesbyaccount(client, account, callback) {\n    const ourAccount = account;\n    client.cmd('getaddressesbyaccount', ourAccount, function(err, data) {\n        if(err)  logError('getaddressesbyaccount:',err);\n        callback(err, data);\n    });\n}\n\nexport function getNewAddress(client, accout) {\n    const syncFunc = Meteor.wrapAsync(doichain_getnewaddress);\n    return syncFunc(client, accout);\n}\nfunction doichain_getnewaddress(client, account, callback) {\n    const ourAccount = account;\n    client.cmd('getnewaddresss', ourAccount, function(err, data) {\n        if(err)  logError('getnewaddresss:',err);\n        callback(err, data);\n    });\n}\n\n\nexport function signMessage(client, address, message) {\n    const syncFunc = Meteor.wrapAsync(doichain_signMessage);\n    return syncFunc(client, address, message);\n}\n\nfunction doichain_signMessage(client, address, message, callback) {\n    const ourAddress = address;\n    const ourMessage = message;\n    client.cmd('signmessage', ourAddress, ourMessage, function(err, data) {\n        callback(err, data);\n    });\n}\n\nexport function nameShow(client, id) {\n  const syncFunc = Meteor.wrapAsync(doichain_nameShow);\n  return syncFunc(client, id);\n}\n\nfunction doichain_nameShow(client, id, callback) {\n  const ourId = checkId(id);\n  logConfirm('doichain-cli name_show :',ourId);\n  client.cmd('name_show', ourId, function(err, data) {\n    if(err !== undefined && err !== null && err.message.startsWith(\"name not found\")) {\n      err = undefined,\n      data = undefined\n    }\n    callback(err, data);\n  });\n}\n\nexport function feeDoi(client, address) {\n    const syncFunc = Meteor.wrapAsync(doichain_feeDoi);\n    return syncFunc(client, address);\n}\n\nfunction doichain_feeDoi(client, address, callback) {\n    const destAddress = address;\n    client.cmd('sendtoaddress', destAddress, '0.02', function(err, data) {\n        callback(err, data);\n    });\n}\n\nexport function nameDoi(client, name, value, address) {\n    const syncFunc = Meteor.wrapAsync(doichain_nameDoi);\n    return syncFunc(client, name, value, address);\n}\n\nfunction doichain_nameDoi(client, name, value, address, callback) {\n    const ourName = checkId(name);\n    const ourValue = value;\n    const destAddress = address;\n    if(!address) {\n        client.cmd('name_doi', ourName, ourValue, function (err, data) {\n            callback(err, data);\n        });\n    }else{\n        client.cmd('name_doi', ourName, ourValue, destAddress, function(err, data) {\n            callback(err, data);\n        });\n    }\n}\n\nexport function listSinceBlock(client, block) {\n    const syncFunc = Meteor.wrapAsync(doichain_listSinceBlock);\n    var ourBlock = block;\n    if(ourBlock === undefined) ourBlock = null;\n    return syncFunc(client, ourBlock);\n}\n\nfunction doichain_listSinceBlock(client, block, callback) {\n    var ourBlock = block;\n    if(ourBlock === null) client.cmd('listsinceblock', function(err, data) {\n        callback(err, data);\n    });\n    else client.cmd('listsinceblock', ourBlock, function(err, data) {\n        callback(err, data);\n    });\n}\n\nexport function getTransaction(client, txid) {\n    const syncFunc = Meteor.wrapAsync(doichain_gettransaction);\n    return syncFunc(client, txid);\n}\n\nfunction doichain_gettransaction(client, txid, callback) {\n    logConfirm('doichain_gettransaction:',txid);\n    client.cmd('gettransaction', txid, function(err, data) {\n        if(err)  logError('doichain_gettransaction:',err);\n        callback(err, data);\n    });\n}\n\nexport function getRawTransaction(client, txid) {\n    const syncFunc = Meteor.wrapAsync(doichain_getrawtransaction);\n    return syncFunc(client, txid);\n}\n\nfunction doichain_getrawtransaction(client, txid, callback) {\n    logBlockchain('doichain_getrawtransaction:',txid);\n    client.cmd('getrawtransaction', txid, 1, function(err, data) {\n        if(err)  logError('doichain_getrawtransaction:',err);\n        callback(err, data);\n    });\n}\n\nexport function getBalance(client) {\n    const syncFunc = Meteor.wrapAsync(doichain_getbalance);\n    return syncFunc(client);\n}\n\nfunction doichain_getbalance(client, callback) {\n    client.cmd('getbalance', function(err, data) {\n        if(err) { logError('doichain_getbalance:',err);}\n        callback(err, data);\n    });\n}\n\nexport function getInfo(client) {\n    const syncFunc = Meteor.wrapAsync(doichain_getinfo);\n    return syncFunc(client);\n}\n\nfunction doichain_getinfo(client, callback) {\n    client.cmd('getblockchaininfo', function(err, data) {\n        if(err) { logError('doichain-getinfo:',err);}\n        callback(err, data);\n    });\n}\n\nfunction checkId(id) {\n    const DOI_PREFIX = \"doi: \";\n    let ret_val = id; //default value\n\n    if(id.startsWith(DOI_PREFIX)) ret_val = id.substring(DOI_PREFIX.length); //in case it starts with doi: cut  this away\n    if(!id.startsWith(NAMESPACE)) ret_val = NAMESPACE+id; //in case it doesn't start with e/ put it in front now.\n  return ret_val;\n}\n","import { Meteor } from 'meteor/meteor';\nimport { HTTP } from 'meteor/http'\n\nexport function getHttpGET(url, query) {\n  const syncFunc = Meteor.wrapAsync(_get);\n  return syncFunc(url, query);\n}\n\nexport function getHttpGETdata(url, data) {\n    const syncFunc = Meteor.wrapAsync(_getData);\n    return syncFunc(url, data);\n}\n\nexport function getHttpPOST(url, data) {\n    const syncFunc = Meteor.wrapAsync(_post);\n    return syncFunc(url, data);\n}\n\nexport function getHttpPUT(url, data) {\n    const syncFunc = Meteor.wrapAsync(_put);\n    return syncFunc(url, data);\n}\n\nfunction _get(url, query, callback) {\n  const ourUrl = url;\n  const ourQuery = query;\n  HTTP.get(ourUrl, {query: ourQuery}, function(err, ret) {\n    callback(err, ret);\n  });\n}\n\nfunction _getData(url, data, callback) {\n    const ourUrl = url;\n    const ourData = data;\n    HTTP.get(ourUrl, ourData, function(err, ret) {\n        callback(err, ret);\n    });\n}\n\nfunction _post(url, data, callback) {\n    const ourUrl = url;\n    const ourData =  data;\n\n    HTTP.post(ourUrl, ourData, function(err, ret) {\n        callback(err, ret);\n    });\n}\n\nfunction _put(url, updateData, callback) {\n    const ourUrl = url;\n    const ourData = {\n        data: updateData\n    }\n\n    HTTP.put(ourUrl, ourData, function(err, ret) {\n      callback(err, ret);\n    });\n}\n","import './mail_jobs.js';\nimport './doichain.js';\nimport './blockchain_jobs.js';\nimport './dapp_jobs.js';\nimport './dns.js';\nimport './rest/rest.js';\n","import { Meteor } from 'meteor/meteor';\nimport { JobCollection, Job } from 'meteor/vsivsi:job-collection';\nexport const MailJobs = JobCollection('emails');\nimport sendMail from '../../imports/modules/server/emails/send.js';\nimport {logMain} from \"../../imports/startup/server/log-configuration\";\nimport {BlockchainJobs} from \"./blockchain_jobs\";\n\n\n\nMailJobs.processJobs('send', function (job, cb) {\n  try {\n    const email = job.data;\n    sendMail(email);\n    job.done();\n  } catch(exception) {\n    job.fail();\n    throw new Meteor.Error('jobs.mail.send.exception', exception);\n  } finally {\n    cb();\n  }\n});\n\n\nnew Job(MailJobs, 'cleanup', {})\n    .repeat({ schedule: MailJobs.later.parse.text(\"every 5 minutes\") })\n    .save({cancelRepeats: true})\n\nlet q = MailJobs.processJobs('cleanup',{ pollInterval: false, workTimeout: 60*1000 } ,function (job, cb) {\n    const current = new Date()\n    current.setMinutes(current.getMinutes() - 5);\n\n    const ids = MailJobs.find({\n            status: {$in: Job.jobStatusRemovable},\n            updated: {$lt: current}},\n        {fields: { _id: 1 }});\n\n    logMain('found  removable blockchain jobs:',ids);\n    MailJobs.removeJobs(ids);\n    if(ids.length > 0){\n        job.done(\"Removed #{ids.length} old jobs\");\n    }\n    cb();\n});\n\nMailJobs.find({ type: 'jobType', status: 'ready' })\n    .observe({\n        added: function () { q.trigger(); }\n    });\n\n","import '/imports/startup/server';\nimport './api/index.js';\n"]}