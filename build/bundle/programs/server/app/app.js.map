{"version":3,"sources":["meteor://ðŸ’»app/imports/api/opt-ins/server/publications.js","meteor://ðŸ’»app/imports/api/opt-ins/methods.js","meteor://ðŸ’»app/imports/api/opt-ins/opt-ins.js","meteor://ðŸ’»app/imports/api/recipients/server/publications.js","meteor://ðŸ’»app/imports/api/recipients/recipients.js","meteor://ðŸ’»app/imports/api/doichain/entries.js","meteor://ðŸ’»app/imports/api/doichain/methods.js","meteor://ðŸ’»app/imports/api/languages/methods.js","meteor://ðŸ’»app/imports/api/meta/meta.js","meteor://ðŸ’»app/imports/api/senders/senders.js","meteor://ðŸ’»app/imports/modules/server/dapps/export_dois.js","meteor://ðŸ’»app/imports/modules/server/dapps/fetch_doi-mail-data.js","meteor://ðŸ’»app/imports/modules/server/dapps/get_doi-mail-data.js","meteor://ðŸ’»app/imports/modules/server/dns/get_opt-in-key.js","meteor://ðŸ’»app/imports/modules/server/dns/get_opt-in-provider.js","meteor://ðŸ’»app/imports/modules/server/doichain/add_entry_and_fetch_data.js","meteor://ðŸ’»app/imports/modules/server/doichain/check_new_transactions.js","meteor://ðŸ’»app/imports/modules/server/doichain/decrypt_message.js","meteor://ðŸ’»app/imports/modules/server/doichain/encrypt_message.js","meteor://ðŸ’»app/imports/modules/server/doichain/generate_name-id.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_address.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_balance.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_data-hash.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_key-pair.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_private-key_from_wif.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_publickey_and_address_by_domain.js","meteor://ðŸ’»app/imports/modules/server/doichain/get_signature.js","meteor://ðŸ’»app/imports/modules/server/doichain/insert.js","meteor://ðŸ’»app/imports/modules/server/doichain/update.js","meteor://ðŸ’»app/imports/modules/server/doichain/verify_signature.js","meteor://ðŸ’»app/imports/modules/server/doichain/write_to_blockchain.js","meteor://ðŸ’»app/imports/modules/server/emails/decode_doi-hash.js","meteor://ðŸ’»app/imports/modules/server/emails/generate_doi-hash.js","meteor://ðŸ’»app/imports/modules/server/emails/parse_template.js","meteor://ðŸ’»app/imports/modules/server/emails/send.js","meteor://ðŸ’»app/imports/modules/server/jobs/add_check_new_transactions.js","meteor://ðŸ’»app/imports/modules/server/jobs/add_fetch-doi-mail-data.js","meteor://ðŸ’»app/imports/modules/server/jobs/add_insert_blockchain.js","meteor://ðŸ’»app/imports/modules/server/jobs/add_send_mail.js","meteor://ðŸ’»app/imports/modules/server/jobs/add_update_blockchain.js","meteor://ðŸ’»app/imports/modules/server/languages/get.js","meteor://ðŸ’»app/imports/modules/server/meta/addOrUpdate.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/add.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/add_and_write_to_blockchain.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/confirm.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/generate_doi-token.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/update_status.js","meteor://ðŸ’»app/imports/modules/server/opt-ins/verify.js","meteor://ðŸ’»app/imports/modules/server/recipients/add.js","meteor://ðŸ’»app/imports/modules/server/senders/add.js","meteor://ðŸ’»app/imports/startup/server/dapp-configuration.js","meteor://ðŸ’»app/imports/startup/server/dns-configuration.js","meteor://ðŸ’»app/imports/startup/server/doichain-configuration.js","meteor://ðŸ’»app/imports/startup/server/email-configuration.js","meteor://ðŸ’»app/imports/startup/server/fixtures.js","meteor://ðŸ’»app/imports/startup/server/index.js","meteor://ðŸ’»app/imports/startup/server/jobs.js","meteor://ðŸ’»app/imports/startup/server/log-configuration.js","meteor://ðŸ’»app/imports/startup/server/register-api.js","meteor://ðŸ’»app/imports/startup/server/security.js","meteor://ðŸ’»app/imports/startup/server/type-configuration.js","meteor://ðŸ’»app/imports/startup/server/useraccounts-configuration.js","meteor://ðŸ’»app/server/api/rest/imports/confirm.js","meteor://ðŸ’»app/server/api/rest/imports/debug.js","meteor://ðŸ’»app/server/api/rest/imports/send.js","meteor://ðŸ’»app/server/api/rest/imports/user.js","meteor://ðŸ’»app/server/api/rest/imports/verify.js","meteor://ðŸ’»app/server/api/rest/rest.js","meteor://ðŸ’»app/server/api/blockchain_jobs.js","meteor://ðŸ’»app/server/api/dapp_jobs.js","meteor://ðŸ’»app/server/api/dns.js","meteor://ðŸ’»app/server/api/doichain.js","meteor://ðŸ’»app/server/api/http.js","meteor://ðŸ’»app/server/api/index.js","meteor://ðŸ’»app/server/api/mail_jobs.js","meteor://ðŸ’»app/server/main.js"],"names":["Meteor","module","link","v","Roles","OptIns","publish","OptInsAll","userId","ready","userIsInRole","find","ownerId","fields","publicFields","DDPRateLimiter","i18n","_i18n","ValidatedMethod","_","addOptIn","default","add","name","validate","run","recipientMail","senderMail","data","error","Error","__","optIn","OPTIONS_METHODS","pluck","isServer","addRule","contains","connectionId","export","Mongo","SimpleSchema","OptInsCollection","Collection","insert","callback","ourOptIn","recipient_sender","recipient","sender","createdAt","Date","result","update","selector","modifier","remove","deny","schema","_id","type","String","regEx","RegEx","Id","optional","denyUpdate","index","Integer","nameId","txId","masterDoi","confirmedAt","confirmedBy","IP","confirmationToken","attachSchema","Recipients","recipientsAll","RecipientsCollection","ourRecipient","email","privateKey","unique","publicKey","DoichainEntries","DoichainEntriesCollection","entry","value","address","getKeyPairM","getBalanceM","getKeyPair","getBalance","logVal","OPTINS_METHODS","getLanguages","getAllLanguages","Meta","MetaCollection","ourData","key","Senders","SendersCollection","ourSender","DOI_MAIL_FETCH_URL","logSend","ExportDoisDataSchema","status","role","userid","id","exportDois","pipeline","$match","$exists","$ne","undefined","push","$redact","$cond","if","$cmp","then","else","concat","$lookup","from","localField","foreignField","as","$unwind","$project","optIns","aggregate","exportDoiData","JSON","stringify","exception","exportDefault","DOI_FETCH_ROUTE","DOI_CONFIRMATION_ROUTE","API_PATH","VERSION","getUrl","CONFIRM_CLIENT","CONFIRM_ADDRESS","getHttpGET","signMessage","parseTemplate","generateDoiToken","generateDoiHash","addSendMailJob","logConfirm","logError","FetchDoiMailDataSchema","domain","fetchDoiMailData","url","signature","query","encodeURIComponent","response","responseData","includes","optInId","findOne","token","confirmationHash","redirect","confirmationUrl","template","content","confirmation_url","to","subject","message","returnPath","getOptInProvider","getOptInKey","verifySignature","Accounts","GetDoiMailDataSchema","name_id","userProfileSchema","Email","templateURL","getDoiMailData","parts","split","length","provider","doiMailData","defaultReturnData","returnData","owner","users","mailTemplate","profile","resolveTxt","FALLBACK_PROVIDER","isRegtest","isTestnet","OPT_IN_KEY","OPT_IN_KEY_TESTNET","GetOptInKeySchema","ourOPT_IN_KEY","foundKey","dnskey","useFallback","PROVIDER_KEY","PROVIDER_KEY_TESTNET","GetOptInProviderSchema","ourPROVIDER_KEY","providerKey","getWif","addFetchDoiMailDataJob","getPrivateKeyFromWif","decryptMessage","AddDoichainEntrySchema","addDoichainEntry","ourEntry","ety","parse","wif","namePos","indexOf","substring","expiresIn","expired","listSinceBlock","nameShow","getRawTransaction","addOrUpdateMeta","TX_NAME_START","LAST_CHECKED_BLOCK_KEY","checkNewTransaction","txid","job","lastCheckedBlock","ret","transactions","txs","lastblock","addressTxs","filter","tx","startsWith","forEach","txName","addTx","done","vout","scriptPubKey","nameOp","op","addresses","crypto","ecies","DecryptMessageSchema","Buffer","ecdh","createECDH","setPrivateKey","decrypt","toString","EncryptMessageSchema","encryptMessage","encrypt","GenerateNameIdSchema","generateNameId","$set","CryptoJS","Base58","VERSION_BYTE","VERSION_BYTE_REGTEST","GetAddressSchema","getAddress","_getAddress","pubKey","lib","WordArray","create","SHA256","RIPEMD160","versionByte","checksum","encode","get_Balance","bal","GetDataHashSchema","getDataHash","hash","randomBytes","secp256k1","privKey","privateKeyVerify","publicKeyCreate","toUpperCase","GetPrivateKeyFromWifSchema","_getPrivateKeyFromWif","decode","endsWith","GetPublicKeySchema","getPublicKeyAndAddress","destAddress","bitcore","Message","GetSignatureSchema","getSignature","sign","PrivateKey","SEND_CLIENT","logBlockchain","feeDoi","nameDoi","InsertSchema","dataHash","soiDate","publicKeyAndAddress","nameValue","feeDoiTx","nameDoiTx","getTransaction","DOI_CONFIRMATION_NOTIFY_ROUTE","getHttpPUT","UpdateSchema","host","fromHostUrl","name_data","rerun","our_transaction","confirmations","ourfromHostUrl","updateData","cancel","restart","err","logVerify","NETWORK","Networks","alias","pubkeyhash","privatekey","scripthash","networkMagic","VerifySignatureSchema","Address","fromPublicKey","PublicKey","verify","addInsertBlockchainJob","WriteToBlockchainSchema","writeToBlockchain","HashIds","DecodeDoiHashSchema","decodeDoiHash","ourHash","hex","decodeHex","obj","GenerateDoiHashSchema","json","encodeHex","PLACEHOLDER_REGEX","ParseTemplateSchema","Object","blackbox","_match","exec","_replacePlaceholder","replace","rep","DOI_MAIL_DEFAULT_EMAIL_FROM","SendMailSchema","sendMail","mail","ourMail","send","html","headers","Job","BlockchainJobs","addCheckNewTransactionsBlockchainJob","retry","retries","wait","save","cancelRepeats","DAppJobs","AddFetchDoiMailDataJobSchema","AddInsertBlockchainJobSchema","MailJobs","AddSendMailJobSchema","AddUpdateBlockchainJobSchema","addUpdateBlockchainJob","AddOrUpdateMetaSchema","meta","AddOptInSchema","fetch","addRecipient","addSender","recipient_mail","sender_mail","master_doi","recipientId","senderId","ConfirmOptInSchema","confirmOptIn","request","ourRequest","decoded","$unset","entries","$or","doiSignature","doiTimestamp","toISOString","jsonValue","GenerateDoiTokenSchema","UpdateOptInStatusSchema","updateOptInStatus","VERIFY_CLIENT","VerifyOptInSchema","recipient_public_key","verifyOptIn","entryData","firstCheck","secondCheck","AddRecipientSchema","recipients","keyPair","AddSenderSchema","senders","isDebug","settings","app","debug","regtest","testnet","port","absoluteUrl","namecoin","SEND_APP","CONFIRM_APP","VERIFY_APP","isAppType","sendSettings","sendClient","doichain","createClient","confirmSettings","confirm","confirmClient","confirmAddress","verifySettings","verifyClient","Client","user","username","pass","password","Hashids","doiMailFetchUrl","defaultFrom","smtp","startup","process","env","MAIL_URL","server","NODE_TLS_REJECT_UNAUTHORIZED","count","createUser","addUsersToRoles","startJobServer","console","sendModeTagColor","confirmModeTagColor","verifyModeTagColor","blockchainModeTagColor","testingModeTagColor","logMain","testLogging","require","msg","colors","param","time","tag","log","AUTH_METHODS","types","config","sendVerificationEmail","forbidClientAccountCreation","emailTemplates","Api","DOI_WALLETNOTIFY_ROUTE","addRoute","authRequired","get","action","urlParams","ip","connection","remoteAddress","socket","statusCode","body","params","queryParams","DOI_EXPORT_ROUTE","post","qParams","bParams","bodyParams","uid","constructor","Array","prepareCoDOI","prepareAdd","put","val","ownerID","currentOptInId","retResponse","ret_response","mailTemplateSchema","createUserSchema","updateUserSchema","collectionOptions","path","routeOptions","excludedEndpoints","endpoints","delete","roleRequired","paramId","addCollection","USERS_COLLECTION_ROUTE","Restivus","apiPath","version","useDefaultAuth","prettyJson","JobCollection","processJobs","workTimeout","cb","fail","pause","repeat","schedule","later","text","q","pollInterval","current","setMinutes","getMinutes","ids","$in","jobStatusRemovable","updated","$lt","removeJobs","observe","added","trigger","dns","syncFunc","wrapAsync","dns_resolveTxt","records","record","trim","getAddressesByAccount","getNewAddress","NAMESPACE","client","doichain_dumpprivkey","ourAddress","cmd","accout","doichain_getaddressesbyaccount","account","ourAccount","doichain_getnewaddress","doichain_signMessage","ourMessage","doichain_nameShow","ourId","checkId","doichain_feeDoi","doichain_nameDoi","ourName","ourValue","block","doichain_listSinceBlock","ourBlock","doichain_gettransaction","doichain_getrawtransaction","doichain_getbalance","DOI_PREFIX","ret_val","getHttpGETdata","getHttpPOST","HTTP","_get","_getData","_post","_put","ourUrl","ourQuery"],"mappings":"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","file":"/app.js","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\n\nimport { OptIns } from '../opt-ins.js';\n\nMeteor.publish('opt-ins.all', function OptInsAll() {\n  if(!this.userId) {\n    return this.ready();\n  }\n  if(!Roles.userIsInRole(this.userId, ['admin'])){\n    return OptIns.find({ownerId:this.userId}, {\n      fields: OptIns.publicFields,\n    });\n  }\n  \n\n  return OptIns.find({}, {\n    fields: OptIns.publicFields,\n  });\n});\n","import { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { _i18n as i18n } from 'meteor/universe:i18n';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { Roles } from 'meteor/alanning:roles';\nimport { _ } from 'meteor/underscore';\nimport addOptIn from '../../modules/server/opt-ins/add_and_write_to_blockchain.js';\n\nconst add = new ValidatedMethod({\n  name: 'opt-ins.add',\n  validate: null,\n  run({ recipientMail, senderMail, data }) {\n    if(!this.userId || !Roles.userIsInRole(this.userId, ['admin'])) {\n      const error = \"api.opt-ins.add.accessDenied\";\n      throw new Meteor.Error(error, i18n.__(error));\n    }\n\n    const optIn = {\n      \"recipient_mail\": recipientMail,\n      \"sender_mail\": senderMail,\n      data\n    }\n\n    addOptIn(optIn)\n  },\n});\n\n// Get list of all method names on opt-ins\nconst OPTIONS_METHODS = _.pluck([\n  add\n], 'name');\n\nif (Meteor.isServer) {\n  // Only allow 5 opt-in operations per connection per second\n  DDPRateLimiter.addRule({\n    name(name) {\n      return _.contains(OPTIONS_METHODS, name);\n    },\n\n    // Rate limit per connection ID\n    connectionId() { return true; },\n  }, 5, 1000);\n}\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nclass OptInsCollection extends Mongo.Collection {\n  insert(optIn, callback) {\n    const ourOptIn = optIn;\n    ourOptIn.recipient_sender = ourOptIn.recipient+ourOptIn.sender;\n    ourOptIn.createdAt = ourOptIn.createdAt || new Date();\n    const result = super.insert(ourOptIn, callback);\n    return result;\n  }\n  update(selector, modifier) {\n    const result = super.update(selector, modifier);\n    return result;\n  }\n  remove(selector) {\n    const result = super.remove(selector);\n    return result;\n  }\n}\n\nexport const OptIns = new OptInsCollection('opt-ins');\n\n// Deny all client-side updates since we will be using methods to manage this collection\nOptIns.deny({\n  insert() { return true; },\n  update() { return true; },\n  remove() { return true; },\n});\n\nOptIns.schema = new SimpleSchema({\n  _id: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Id,\n  },\n  recipient: {\n    type: String,\n    optional: true,\n    denyUpdate: true,\n  },\n  sender: {\n    type: String,\n    optional: true,\n    denyUpdate: true,\n  },\n  data: {\n    type: String,\n    optional: true,\n    denyUpdate: false,\n  },\n  index: {\n    type: SimpleSchema.Integer,\n    optional: true,\n    denyUpdate: false,\n  },\n  nameId: {\n    type: String,\n    optional: true,\n    denyUpdate: false,\n  },\n  txId: {\n      type: String,\n      optional: true,\n      denyUpdate: false,\n  },\n  masterDoi: {\n      type: String,\n      optional: true,\n      denyUpdate: false,\n  },\n  createdAt: {\n    type: Date,\n    denyUpdate: true,\n  },\n  confirmedAt: {\n    type: Date,\n    optional: true,\n    denyUpdate: false,\n  },\n  confirmedBy: {\n    type: String,\n    regEx: SimpleSchema.RegEx.IP,\n    optional: true,\n    denyUpdate: false\n  },\n  confirmationToken: {\n    type: String,\n    optional: true,\n    denyUpdate: false\n  },\n  ownerId:{\n    type: String,\n    optional: true,\n    regEx: SimpleSchema.RegEx.Id\n  },\n  error:{\n      type: String,\n      optional: true,\n      denyUpdate: false\n  }\n});\n\nOptIns.attachSchema(OptIns.schema);\n\n// This represents the keys from Opt-In objects that should be published\n// to the client. If we add secret properties to Opt-In objects, don't list\n// them here to keep them private to the server.\nOptIns.publicFields = {\n  _id: 1,\n  recipient: 1,\n  sender: 1,\n  data: 1,\n  index: 1,\n  nameId: 1,\n  txId: 1,\n  masterDoi: 1,\n  createdAt: 1,\n  confirmedAt: 1,\n  confirmedBy: 1,\n  ownerId: 1,\n  error: 1\n};\n","import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\n\nimport { Recipients } from '../recipients.js';\n\nMeteor.publish('recipients.all', function recipientsAll() {\n  if(!this.userId || !Roles.userIsInRole(this.userId, ['admin'])) {\n    return this.ready();\n  }\n\n  return Recipients.find({}, {\n    fields: Recipients.publicFields,\n  });\n});\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nclass RecipientsCollection extends Mongo.Collection {\n  insert(recipient, callback) {\n    const ourRecipient = recipient;\n    ourRecipient.createdAt = ourRecipient.createdAt || new Date();\n    const result = super.insert(ourRecipient, callback);\n    return result;\n  }\n  update(selector, modifier) {\n    const result = super.update(selector, modifier);\n    return result;\n  }\n  remove(selector) {\n    const result = super.remove(selector);\n    return result;\n  }\n}\n\nexport const Recipients = new RecipientsCollection('recipients');\n\n// Deny all client-side updates since we will be using methods to manage this collection\nRecipients.deny({\n  insert() { return true; },\n  update() { return true; },\n  remove() { return true; },\n});\n\nRecipients.schema = new SimpleSchema({\n  _id: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Id,\n  },\n  email: {\n    type: String,\n    index: true,\n    denyUpdate: true,\n  },\n  privateKey: {\n    type: String,\n    unique: true,\n    denyUpdate: true,\n  },\n  publicKey: {\n    type: String,\n    unique: true,\n    denyUpdate: true,\n  },\n  createdAt: {\n    type: Date,\n    denyUpdate: true,\n  }\n});\n\nRecipients.attachSchema(Recipients.schema);\n\n// This represents the keys from Recipient objects that should be published\n// to the client. If we add secret properties to Recipient objects, don't list\n// them here to keep them private to the server.\nRecipients.publicFields = {\n  _id: 1,\n  email: 1,\n  publicKey: 1,\n  createdAt: 1\n};\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nclass DoichainEntriesCollection extends Mongo.Collection {\n  insert(entry, callback) {\n    const result = super.insert(entry, callback);\n    return result;\n  }\n  update(selector, modifier) {\n    const result = super.update(selector, modifier);\n    return result;\n  }\n  remove(selector) {\n    const result = super.remove(selector);\n    return result;\n  }\n}\n\nexport const DoichainEntries = new DoichainEntriesCollection('doichain-entries');\n\n// Deny all client-side updates since we will be using methods to manage this collection\nDoichainEntries.deny({\n  insert() { return true; },\n  update() { return true; },\n  remove() { return true; },\n});\n\nDoichainEntries.schema = new SimpleSchema({\n  _id: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Id,\n  },\n  name: {\n    type: String,\n    index: true,\n    denyUpdate: true\n  },\n  value: {\n    type: String,\n    denyUpdate: false\n  },\n  address: {\n    type: String,\n    denyUpdate: false\n  },\n  masterDoi: {\n        type: String,\n        optional: true,\n        index: true,\n        denyUpdate: true\n  },\n  index: {\n        type: SimpleSchema.Integer,\n        optional: true,\n        denyUpdate: true\n  },\n  txId: {\n    type: String,\n    denyUpdate: false\n  }\n});\n\nDoichainEntries.attachSchema(DoichainEntries.schema);\n\n// This represents the keys from Entry objects that should be published\n// to the client. If we add secret properties to Entry objects, don't list\n// them here to keep them private to the server.\nDoichainEntries.publicFields = {\n  _id: 1,\n  name: 1,\n  value: 1,\n  address: 1,\n  masterDoi: 1,\n  index: 1,\n  txId: 1\n};\n","import { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport getKeyPairM from '../../modules/server/doichain/get_key-pair.js';\nimport getBalanceM from '../../modules/server/doichain/get_balance.js';\n\n\nconst getKeyPair = new ValidatedMethod({\n  name: 'doichain.getKeyPair',\n  validate: null,\n  run() {\n    return getKeyPairM();\n  },\n});\n\nconst getBalance = new ValidatedMethod({\n  name: 'doichain.getBalance',\n  validate: null,\n  run() {\n    const logVal = getBalanceM();\n    return logVal;\n  },\n});\n\n\n// Get list of all method names on doichain\nconst OPTINS_METHODS = _.pluck([\n  getKeyPair\n,getBalance], 'name');\n\nif (Meteor.isServer) {\n  // Only allow 5 opt-in operations per connection per second\n  DDPRateLimiter.addRule({\n    name(name) {\n      return _.contains(OPTINS_METHODS, name);\n    },\n\n    // Rate limit per connection ID\n    connectionId() { return true; },\n  }, 5, 1000);\n}\n","import { Meteor} from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport getLanguages from '../../modules/server/languages/get.js';\n\nconst getAllLanguages = new ValidatedMethod({\n  name: 'languages.getAll',\n  validate: null,\n  run() {\n    return getLanguages();\n  },\n});\n\n// Get list of all method names on languages\nconst OPTINS_METHODS = _.pluck([\n  getAllLanguages\n], 'name');\n\nif (Meteor.isServer) {\n  // Only allow 5 opt-in operations per connection per second\n  DDPRateLimiter.addRule({\n    name(name) {\n      return _.contains(OPTINS_METHODS, name);\n    },\n\n    // Rate limit per connection ID\n    connectionId() { return true; },\n  }, 5, 1000);\n}\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nclass MetaCollection extends Mongo.Collection {\n  insert(data, callback) {\n    const ourData = data;\n    const result = super.insert(ourData, callback);\n    return result;\n  }\n  update(selector, modifier) {\n    const result = super.update(selector, modifier);\n    return result;\n  }\n  remove(selector) {\n    const result = super.remove(selector);\n    return result;\n  }\n}\n\nexport const Meta = new MetaCollection('meta');\n\n// Deny all client-side updates since we will be using methods to manage this collection\nMeta.deny({\n  insert() { return true; },\n  update() { return true; },\n  remove() { return true; },\n});\n\nMeta.schema = new SimpleSchema({\n  _id: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Id,\n  },\n  key: {\n    type: String,\n    index: true,\n    denyUpdate: true\n  },\n  value: {\n    type: String\n  }\n});\n\nMeta.attachSchema(Meta.schema);\n\n// This represents the keys from Meta objects that should be published\n// to the client. If we add secret properties to Meta objects, don't list\n// them here to keep them private to the server.\nMeta.publicFields = {\n};\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nclass SendersCollection extends Mongo.Collection {\n  insert(sender, callback) {\n    const ourSender = sender;\n    ourSender.createdAt = ourSender.createdAt || new Date();\n    const result = super.insert(ourSender, callback);\n    return result;\n  }\n  update(selector, modifier) {\n    const result = super.update(selector, modifier);\n    return result;\n  }\n  remove(selector) {\n    const result = super.remove(selector);\n    return result;\n  }\n}\n\nexport const Senders = new SendersCollection('senders');\n\n// Deny all client-side updates since we will be using methods to manage this collection\nSenders.deny({\n  insert() { return true; },\n  update() { return true; },\n  remove() { return true; },\n});\n\nSenders.schema = new SimpleSchema({\n  _id: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Id,\n  },\n  email: {\n    type: String,\n    index: true,\n    denyUpdate: true,\n  },\n  createdAt: {\n    type: Date,\n    denyUpdate: true,\n  }\n});\n\nSenders.attachSchema(Senders.schema);\n\n// This represents the keys from Sender objects that should be published\n// to the client. If we add secret properties to Sender objects, don't list\n// them here to keep them private to the server.\nSenders.publicFields = {\n  email: 1,\n  createdAt: 1\n};\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { DOI_MAIL_FETCH_URL } from '../../../startup/server/email-configuration.js';\nimport {logSend} from \"../../../startup/server/log-configuration\";\nimport {OptIns} from \"../../../api/opt-ins/opt-ins\";\n\nconst ExportDoisDataSchema = new SimpleSchema({\n  status: {\n    type: String,\n    optional: true,\n  },\n  role:{\n    type:String\n  },\n  userid:{\n    type: String,\n    regEx: SimpleSchema.RegEx.id,\n    optional:true \n  }\n});\n\n//TODO add sender and recipient email address to export\n\nconst exportDois = (data) => {\n  try {\n    const ourData = data;\n    ExportDoisDataSchema.validate(ourData);\n    let pipeline=[{ $match: {\"confirmedAt\":{ $exists: true, $ne: null }} }];\n    \n    if(ourData.role!='admin'||ourData.userid!=undefined){\n      pipeline.push({ $redact:{\n        $cond: {\n          if: { $cmp: [ \"$ownerId\", ourData.userid ] },\n          then: \"$$PRUNE\",\n          else: \"$$KEEP\" }}});\n    }\n    pipeline.concat([\n        { $lookup: { from: \"recipients\", localField: \"recipient\", foreignField: \"_id\", as: \"RecipientEmail\" } },\n        { $lookup: { from: \"senders\", localField: \"sender\", foreignField: \"_id\", as: \"SenderEmail\" } },\n        { $unwind: \"$SenderEmail\"},\n        { $unwind: \"$RecipientEmail\"},\n        { $project: {\"_id\":1,\"createdAt\":1, \"confirmedAt\":1,\"nameId\":1, \"SenderEmail.email\":1,\"RecipientEmail.email\":1}}\n    ]);\n    //if(ourData.status==1) query = {\"confirmedAt\": { $exists: true, $ne: null }}\n\n    let optIns =  OptIns.aggregate(pipeline);\n    let exportDoiData;\n    try {\n        exportDoiData = optIns;\n        logSend('exportDoi url:',DOI_MAIL_FETCH_URL,JSON.stringify(exportDoiData));\n      return exportDoiData\n\n    } catch(error) {\n      throw \"Error while exporting dois: \"+error;\n    }\n\n  } catch (exception) {\n    throw new Meteor.Error('dapps.exportDoi.exception', exception);\n  }\n};\n\nexport default exportDois;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { DOI_FETCH_ROUTE, DOI_CONFIRMATION_ROUTE, API_PATH, VERSION } from '../../../../server/api/rest/rest.js';\nimport { getUrl } from '../../../startup/server/dapp-configuration.js';\nimport { CONFIRM_CLIENT, CONFIRM_ADDRESS } from '../../../startup/server/doichain-configuration.js';\nimport { getHttpGET } from '../../../../server/api/http.js';\nimport { signMessage } from '../../../../server/api/doichain.js';\nimport { OptIns } from '../../../../imports/api/opt-ins/opt-ins.js';\nimport parseTemplate from '../emails/parse_template.js';\nimport generateDoiToken from '../opt-ins/generate_doi-token.js';\nimport generateDoiHash from '../emails/generate_doi-hash.js';\nimport addOptIn from '../opt-ins/add.js';\nimport addSendMailJob from '../jobs/add_send_mail.js';\nimport {logConfirm, logError} from \"../../../startup/server/log-configuration\";\n\nconst FetchDoiMailDataSchema = new SimpleSchema({\n  name: {\n    type: String\n  },\n  domain: {\n    type: String\n  }\n});\n\n\nconst fetchDoiMailData = (data) => {\n  try {\n    const ourData = data;\n    FetchDoiMailDataSchema.validate(ourData);\n    const url = ourData.domain+API_PATH+VERSION+\"/\"+DOI_FETCH_ROUTE;\n    const signature = signMessage(CONFIRM_CLIENT, CONFIRM_ADDRESS, ourData.name);\n    const query = \"name_id=\"+encodeURIComponent(ourData.name)+\"&signature=\"+encodeURIComponent(signature);\n    logConfirm('calling for doi-email-template:'+url+' query:', query);\n\n    /**\n      TODO when running Send-dApp in Testnet behind NAT this URL will not be accessible from the internet\n      but even when we use the URL from localhost verify andn others will fails.\n     */\n    const response = getHttpGET(url, query);\n    if(response === undefined || response.data === undefined) throw \"Bad response\";\n    const responseData = response.data;\n    logConfirm('response while getting getting email template from URL:',response.data.status);\n\n    if(responseData.status !== \"success\") {\n      if(responseData.error === undefined) throw \"Bad response\";\n      if(responseData.error.includes(\"Opt-In not found\")) {\n        //Do nothing and don't throw error so job is done\n          logError('response data from Send-dApp:',responseData.error);\n        return;\n      }\n      throw responseData.error;\n    }\n    logConfirm('DOI Mail data fetched.');\n\n    const optInId = addOptIn({name: ourData.name});\n    const optIn = OptIns.findOne({_id: optInId});\n    logConfirm('opt-in found:',optIn);\n    if(optIn.confirmationToken !== undefined) return;\n\n    const token = generateDoiToken({id: optIn._id});\n    logConfirm('generated confirmationToken:',token);\n    const confirmationHash = generateDoiHash({id: optIn._id, token: token, redirect: responseData.data.redirect});\n    logConfirm('generated confirmationHash:',confirmationHash);\n    const confirmationUrl = getUrl()+API_PATH+VERSION+\"/\"+DOI_CONFIRMATION_ROUTE+\"/\"+encodeURIComponent(confirmationHash);\n    logConfirm('confirmationUrl:'+confirmationUrl);\n\n    const template = parseTemplate({template: responseData.data.content, data: {\n      confirmation_url: confirmationUrl\n    }});\n\n    //logConfirm('we are using this template:',template);\n\n    logConfirm('sending email to peter for confirmation over bobs dApp');\n    addSendMailJob({\n      to: responseData.data.recipient,\n      subject: responseData.data.subject,\n      message: template,\n      returnPath: responseData.data.returnPath\n    });\n  } catch (exception) {\n    throw new Meteor.Error('dapps.fetchDoiMailData.exception', exception);\n  }\n};\n\nexport default fetchDoiMailData;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport { Recipients } from '../../../api/recipients/recipients.js';\nimport getOptInProvider from '../dns/get_opt-in-provider.js';\nimport getOptInKey from '../dns/get_opt-in-key.js';\nimport verifySignature from '../doichain/verify_signature.js';\nimport { getHttpGET } from '../../../../server/api/http.js';\nimport { DOI_MAIL_FETCH_URL } from '../../../startup/server/email-configuration.js';\nimport { logSend } from \"../../../startup/server/log-configuration\";\nimport { Accounts } from 'meteor/accounts-base'\n\nconst GetDoiMailDataSchema = new SimpleSchema({\n  name_id: {\n    type: String\n  },\n  signature: {\n    type: String\n  }\n});\n\nconst userProfileSchema = new SimpleSchema({\n  subject: {\n    type: String,\n    optional:true\n  },\n  redirect: {\n    type: String,\n    regEx: \"@(https?|ftp)://(-\\\\.)?([^\\\\s/?\\\\.#-]+\\\\.?)+(/[^\\\\s]*)?$@\",\n    optional:true\n  },\n  returnPath: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email,\n    optional:true\n  },\n  templateURL: {\n    type: String,\n    regEx: \"@(https?|ftp)://(-\\\\.)?([^\\\\s/?\\\\.#-]+\\\\.?)+(/[^\\\\s]*)?$@\",\n    optional:true\n  }\n});\n\nconst getDoiMailData = (data) => {\n  try {\n    const ourData = data;\n    GetDoiMailDataSchema.validate(ourData);\n    const optIn = OptIns.findOne({nameId: ourData.name_id});\n    if(optIn === undefined) throw \"Opt-In with name_id: \"+ourData.name_id+\" not found\";\n    logSend('Opt-In found',optIn);\n\n    const recipient = Recipients.findOne({_id: optIn.recipient});\n    if(recipient === undefined) throw \"Recipient not found\";\n    logSend('Recipient found', recipient);\n\n    const parts = recipient.email.split(\"@\");\n    const domain = parts[parts.length-1];\n\n    let publicKey = getOptInKey({ domain: domain});\n\n    if(!publicKey){\n      const provider = getOptInProvider({domain: ourData.domain });\n      logSend(\"using doichain provider instead of directly configured publicKey:\", { provider: provider });\n      publicKey = getOptInKey({ domain: provider}); //get public key from provider or fallback if publickey was not set in dns\n    }\n\n    logSend('queried data: (parts, domain, provider, publicKey)', '('+parts+','+domain+','+publicKey+')');\n\n    //TODO: Only allow access one time\n    // Possible solution:\n    // 1. Provider (confirm dApp) request the data\n    // 2. Provider receive the data\n    // 3. Provider sends confirmation \"I got the data\"\n    // 4. Send dApp lock the data for this opt in\n    logSend('verifying signature...');\n    if(!verifySignature({publicKey: publicKey, data: ourData.name_id, signature: ourData.signature})) {\n      throw \"signature incorrect - access denied\";\n    }\n    \n    logSend('signature verified');\n\n    //TODO: Query for language\n    let doiMailData;\n    try {\n\n      doiMailData = getHttpGET(DOI_MAIL_FETCH_URL, \"\").data;\n      let defaultReturnData = {\n        \"recipient\": recipient.email,\n        \"content\": doiMailData.data.content,\n        \"redirect\": doiMailData.data.redirect,\n        \"subject\": doiMailData.data.subject,\n        \"returnPath\": doiMailData.data.returnPath\n      }\n\n    let returnData = defaultReturnData;\n\n    try{\n      let owner = Accounts.users.findOne({_id: optIn.ownerId});\n      let mailTemplate = owner.profile.mailTemplate;\n      userProfileSchema.validate(mailTemplate);\n\n      returnData[\"redirect\"] = mailTemplate[\"redirect\"] || defaultReturnData[\"redirect\"];\n      returnData[\"subject\"] = mailTemplate[\"subject\"] || defaultReturnData[\"subject\"];\n      returnData[\"returnPath\"] = mailTemplate[\"returnPath\"] || defaultReturnData[\"returnPath\"];\n      returnData[\"content\"] = mailTemplate[\"templateURL\"] ? (getHttpGET(mailTemplate[\"templateURL\"], \"\").content || defaultReturnData[\"content\"]) : defaultReturnData[\"content\"];\n      \n    }\n    catch(error) {\n      returnData=defaultReturnData;\n    }\n\n      logSend('doiMailData and url:', DOI_MAIL_FETCH_URL, returnData);\n\n      return returnData\n\n    } catch(error) {\n      throw \"Error while fetching mail content: \"+error;\n    }\n\n  } catch(exception) {\n    throw new Meteor.Error('dapps.getDoiMailData.exception', exception);\n  }\n};\n\nexport default getDoiMailData;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { resolveTxt } from '../../../../server/api/dns.js';\nimport { FALLBACK_PROVIDER } from '../../../startup/server/dns-configuration.js';\nimport {isRegtest, isTestnet} from \"../../../startup/server/dapp-configuration\";\nimport {logSend} from \"../../../startup/server/log-configuration\";\n\nconst OPT_IN_KEY = \"doichain-opt-in-key\";\nconst OPT_IN_KEY_TESTNET = \"doichain-testnet-opt-in-key\";\n\nconst GetOptInKeySchema = new SimpleSchema({\n  domain: {\n    type: String\n  }\n});\n\n\nconst getOptInKey = (data) => {\n  try {\n    const ourData = data;\n    GetOptInKeySchema.validate(ourData);\n\n    let ourOPT_IN_KEY=OPT_IN_KEY;\n\n    if(isRegtest() || isTestnet()){\n        ourOPT_IN_KEY = OPT_IN_KEY_TESTNET;\n        logSend('Using RegTest:'+isRegtest()+\" Testnet: \"+isTestnet()+\" ourOPT_IN_KEY\",ourOPT_IN_KEY);\n    }\n    const key = resolveTxt(ourOPT_IN_KEY, ourData.domain);\n    logSend('DNS TXT configured public key of recipient email domain and confirmation dapp',{foundKey:key, domain:ourData.domain, dnskey:ourOPT_IN_KEY});\n\n    if(key === undefined) return useFallback(ourData.domain);\n    return key;\n  } catch (exception) {\n    throw new Meteor.Error('dns.getOptInKey.exception', exception);\n  }\n};\n\nconst useFallback = (domain) => {\n  if(domain === FALLBACK_PROVIDER) throw new Meteor.Error(\"Fallback has no key defined!\");\n    logSend(\"Key not defined. Using fallback: \",FALLBACK_PROVIDER);\n  return getOptInKey({domain: FALLBACK_PROVIDER});\n};\n\nexport default getOptInKey;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { resolveTxt } from '../../../../server/api/dns.js';\nimport { FALLBACK_PROVIDER } from '../../../startup/server/dns-configuration.js';\nimport {logSend} from \"../../../startup/server/log-configuration\";\nimport {isRegtest, isTestnet} from \"../../../startup/server/dapp-configuration\";\n\nconst PROVIDER_KEY = \"doichain-opt-in-provider\";\nconst PROVIDER_KEY_TESTNET = \"doichain-testnet-opt-in-provider\";\n\nconst GetOptInProviderSchema = new SimpleSchema({\n  domain: {\n    type: String\n  }\n});\n\n\nconst getOptInProvider = (data) => {\n  try {\n    const ourData = data;\n    GetOptInProviderSchema.validate(ourData);\n\n    let ourPROVIDER_KEY=PROVIDER_KEY;\n    if(isRegtest() || isTestnet()){\n        ourPROVIDER_KEY = PROVIDER_KEY_TESTNET;\n        logSend('Using RegTest:'+isRegtest()+\" : Testnet:\"+isTestnet()+\" PROVIDER_KEY\",{providerKey:ourPROVIDER_KEY, domain:ourData.domain});\n    }\n\n    const provider = resolveTxt(ourPROVIDER_KEY, ourData.domain);\n    if(provider === undefined) return useFallback();\n\n    logSend('opt-in-provider from dns - server of mail recipient: (TXT):',provider);\n    return provider;\n  } catch (exception) {\n    throw new Meteor.Error('dns.getOptInProvider.exception', exception);\n  }\n};\n\nconst useFallback = () => {\n  logSend('Provider not defined. Fallback '+FALLBACK_PROVIDER+' is used');\n  return FALLBACK_PROVIDER;\n};\n\nexport default getOptInProvider;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { CONFIRM_CLIENT, CONFIRM_ADDRESS } from '../../../startup/server/doichain-configuration.js';\nimport { getWif } from '../../../../server/api/doichain.js';\nimport { DoichainEntries } from '../../../api/doichain/entries.js';\nimport addFetchDoiMailDataJob from '../jobs/add_fetch-doi-mail-data.js';\nimport getPrivateKeyFromWif from './get_private-key_from_wif.js';\nimport decryptMessage from './decrypt_message.js';\nimport {logConfirm, logSend} from \"../../../startup/server/log-configuration\";\n\nconst AddDoichainEntrySchema = new SimpleSchema({\n  name: {\n    type: String\n  },\n  value: {\n    type: String\n  },\n  address: {\n    type: String\n  },\n  txId: {\n    type: String\n  }\n});\n\n/**\n * Inserts\n *\n * @param entry\n * @returns {*}\n */\nconst addDoichainEntry = (entry) => {\n  try {\n\n    const ourEntry = entry;\n    logConfirm('adding DoichainEntry on Bob...',ourEntry.name);\n    AddDoichainEntrySchema.validate(ourEntry);\n\n    const ety = DoichainEntries.findOne({name: ourEntry.name});\n    if(ety !== undefined){\n        logSend('returning locally saved entry with _id:'+ety._id);\n        return ety._id;\n    }\n\n    const value = JSON.parse(ourEntry.value);\n    //logSend(\"value:\",value);\n    if(value.from === undefined) throw \"Wrong blockchain entry\"; //TODO if from is missing but value is there, it is probably allready handeled correctly anyways this is not so cool as it seems.\n    const wif = getWif(CONFIRM_CLIENT, CONFIRM_ADDRESS);\n    const privateKey = getPrivateKeyFromWif({wif: wif});\n    logSend('got private key (will not show it here)');\n\n    const domain = decryptMessage({privateKey: privateKey, message: value.from});\n    logSend('decrypted message from domain: ',domain);\n\n    const namePos = ourEntry.name.indexOf('-'); //if this is not a co-registration fetch mail.\n    logSend('namePos:',namePos);\n    const masterDoi = (namePos!=-1)?ourEntry.name.substring(0,namePos):undefined;\n    logSend('masterDoi:',masterDoi);\n    const index = masterDoi?ourEntry.name.substring(namePos+1):undefined;\n    logSend('index:',index);\n\n    const id = DoichainEntries.insert({\n        name: ourEntry.name,\n        value: ourEntry.value,\n        address: ourEntry.address,\n        masterDoi: masterDoi,\n        index: index,\n        txId: ourEntry.txId,\n        expiresIn: ourEntry.expiresIn,\n        expired: ourEntry.expired\n    });\n\n    logSend('DoichainEntry added on Bob:', {id:id,name:ourEntry.name,masterDoi:masterDoi,index:index});\n\n    if(!masterDoi){\n        addFetchDoiMailDataJob({\n            name: ourEntry.name,\n            domain: domain\n        });\n        logSend('New entry added: \\n'+\n            'NameId='+ourEntry.name+\"\\n\"+\n            'Address='+ourEntry.address+\"\\n\"+\n            'TxId='+ourEntry.txId+\"\\n\"+\n            'Value='+ourEntry.value);\n\n    }else{\n        logSend('This transaction belongs to co-registration', masterDoi);\n    }\n\n    return id;\n  } catch (exception) {\n    throw new Meteor.Error('doichain.addEntryAndFetchData.exception', exception);\n  }\n};\n\nexport default addDoichainEntry;\n","import { Meteor } from 'meteor/meteor';\nimport { listSinceBlock, nameShow, getRawTransaction} from '../../../../server/api/doichain.js';\nimport { CONFIRM_CLIENT, CONFIRM_ADDRESS } from '../../../startup/server/doichain-configuration.js';\nimport addDoichainEntry from './add_entry_and_fetch_data.js'\nimport { Meta } from '../../../api/meta/meta.js';\nimport addOrUpdateMeta from '../meta/addOrUpdate.js';\nimport {logConfirm} from \"../../../startup/server/log-configuration\";\n\nconst TX_NAME_START = \"e/\";\nconst LAST_CHECKED_BLOCK_KEY = \"lastCheckedBlock\";\n\nconst checkNewTransaction = (txid, job) => {\n  try {\n\n      if(!txid){\n          logConfirm(\"checkNewTransaction triggered when starting node - checking all confirmed blocks since last check for doichain address\",CONFIRM_ADDRESS);\n\n          try {\n              var lastCheckedBlock = Meta.findOne({key: LAST_CHECKED_BLOCK_KEY});\n              if(lastCheckedBlock !== undefined) lastCheckedBlock = lastCheckedBlock.value;\n              logConfirm(\"lastCheckedBlock\",lastCheckedBlock);\n              const ret = listSinceBlock(CONFIRM_CLIENT, lastCheckedBlock);\n              if(ret === undefined || ret.transactions === undefined) return;\n\n              const txs = ret.transactions;\n              lastCheckedBlock = ret.lastblock;\n              if(!ret || !txs || !txs.length===0){\n                  logConfirm(\"transactions do not contain nameOp transaction details or transaction not found.\", lastCheckedBlock);\n                  addOrUpdateMeta({key: LAST_CHECKED_BLOCK_KEY, value: lastCheckedBlock});\n                  return;\n              }\n\n              logConfirm(\"listSinceBlock\",ret);\n\n              const addressTxs = txs.filter(tx =>\n                  tx.address === CONFIRM_ADDRESS\n                  && tx.name !== undefined //since name_show cannot be read without confirmations\n                  && tx.name.startsWith(\"doi: \"+TX_NAME_START)  //here 'doi: e/xxxx' is already written in the block\n              );\n              addressTxs.forEach(tx => {\n                  logConfirm(\"tx:\",tx);\n                  var txName = tx.name.substring((\"doi: \"+TX_NAME_START).length);\n                  logConfirm(\"excuting name_show in order to get value of nameId:\", txName);\n                  const ety = nameShow(CONFIRM_CLIENT, txName);\n                  logConfirm(\"nameShow: value\",ety);\n                  if(!ety){\n                      logConfirm(\"couldn't find name - obviously not (yet?!) confirmed in blockchain:\", ety);\n                      return;\n                  }\n                  addTx(txName, ety.value,tx.address,tx.txid); //TODO ety.value.from is maybe NOT existing because of this its  (maybe) ont working...\n              });\n              addOrUpdateMeta({key: LAST_CHECKED_BLOCK_KEY, value: lastCheckedBlock});\n              logConfirm(\"Transactions updated - lastCheckedBlock:\",lastCheckedBlock);\n              job.done();\n          } catch(exception) {\n              throw new Meteor.Error('namecoin.checkNewTransactions.exception', exception);\n          }\n\n      }else{\n          logConfirm(\"txid: \"+txid+\" was triggered by walletnotify for address:\",CONFIRM_ADDRESS);\n\n          const ret = getRawTransaction(CONFIRM_CLIENT, txid);\n          const txs = ret.vout;\n\n          if(!ret || !txs || !txs.length===0){\n              logConfirm(\"txid \"+txid+' does not contain transaction details or transaction not found.');\n              return;\n          }\n\n         // logConfirm('now checking raw transactions with filter:',txs);\n\n          const addressTxs = txs.filter(tx =>\n              tx.scriptPubKey !== undefined\n              && tx.scriptPubKey.nameOp !== undefined\n              && tx.scriptPubKey.nameOp.op === \"name_doi\"\n            //  && tx.scriptPubKey.addresses[0] === CONFIRM_ADDRESS //only own transaction should arrive here. - so check on own address unneccesary\n              && tx.scriptPubKey.nameOp.name !== undefined\n              && tx.scriptPubKey.nameOp.name.startsWith(TX_NAME_START)\n          );\n\n          //logConfirm(\"found name_op transactions:\", addressTxs);\n\n          addressTxs.forEach(tx => {\n              addTx(tx.scriptPubKey.nameOp.name, tx.scriptPubKey.nameOp.value,tx.scriptPubKey.addresses[0],txid);\n          });\n      }\n\n\n\n  } catch(exception) {\n    throw new Meteor.Error('doichain.checkNewTransactions.exception', exception);\n  }\n  return true;\n};\n\n\nfunction addTx(name, value, address, txid) {\n    const txName = name.substring(TX_NAME_START.length);\n\n    addDoichainEntry({\n        name: txName,\n        value: value,\n        address: address,\n        txId: txid\n    });\n}\n\nexport default checkNewTransaction;\n\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport crypto from 'crypto';\nimport ecies from 'standard-ecies';\n\nconst DecryptMessageSchema = new SimpleSchema({\n  privateKey: {\n    type: String\n  },\n  message: {\n    type: String\n  }\n});\n\nconst decryptMessage = (data) => {\n  try {\n    const ourData = data;\n    DecryptMessageSchema.validate(ourData);\n    const privateKey = Buffer.from(ourData.privateKey, 'hex');\n    const ecdh = crypto.createECDH('secp256k1');\n    ecdh.setPrivateKey(privateKey);\n    const message = Buffer.from(ourData.message, 'hex');\n    return ecies.decrypt(ecdh, message).toString('utf8');\n  } catch(exception) {\n    throw new Meteor.Error('doichain.decryptMessage.exception', exception);\n  }\n};\n\nexport default decryptMessage;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport ecies from 'standard-ecies';\n\nconst EncryptMessageSchema = new SimpleSchema({\n  publicKey: {\n    type: String\n  },\n  message: {\n    type: String\n  }\n});\n\nconst encryptMessage = (data) => {\n  try {\n    const ourData = data;\n    EncryptMessageSchema.validate(ourData);\n    const publicKey = Buffer.from(ourData.publicKey, 'hex');\n    const message = Buffer.from(ourData.message);\n    return ecies.encrypt(publicKey, message).toString('hex');\n  } catch(exception) {\n    throw new Meteor.Error('doichain.encryptMessage.exception', exception);\n  }\n};\n\nexport default encryptMessage;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport getKeyPair from './get_key-pair.js';\nimport {logSend} from \"../../../startup/server/log-configuration\";\n\nconst GenerateNameIdSchema = new SimpleSchema({\n  id: {\n    type: String\n  },\n  masterDoi: {\n      type: String,\n      optional: true\n  },\n  index: {\n      type: SimpleSchema.Integer,\n      optional: true\n  }\n});\n\nconst generateNameId = (optIn) => {\n  try {\n    const ourOptIn = optIn;\n    GenerateNameIdSchema.validate(ourOptIn);\n    let nameId;\n    if(optIn.masterDoi){\n        nameId = ourOptIn.masterDoi+\"-\"+ourOptIn.index;\n        logSend(\"used master_doi as nameId index \"+optIn.index+\"storage:\",nameId);\n    }\n    else{\n        nameId = getKeyPair().privateKey;\n        logSend(\"generated nameId for doichain storage:\",nameId);\n    }\n\n    OptIns.update({_id : ourOptIn.id}, {$set:{nameId: nameId}});\n\n    return nameId;\n  } catch(exception) {\n    throw new Meteor.Error('doichain.generateNameId.exception', exception);\n  }\n};\n\nexport default generateNameId;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport CryptoJS from 'crypto-js';\nimport Base58 from 'bs58';\nimport { isRegtest } from '../../../startup/server/dapp-configuration.js';\nimport {isTestnet} from \"../../../startup/server/dapp-configuration\";\n\nconst VERSION_BYTE = 0x34;\nconst VERSION_BYTE_REGTEST = 0x6f;\nconst GetAddressSchema = new SimpleSchema({\n  publicKey: {\n    type: String\n  }\n});\n\nconst getAddress = (data) => {\n  try {\n    const ourData = data;\n    GetAddressSchema.validate(ourData);\n    return _getAddress(ourData.publicKey);\n  } catch(exception) {\n    throw new Meteor.Error('doichain.getAddress.exception', exception);\n  }\n};\n\nfunction _getAddress(publicKey) {\n  const pubKey = CryptoJS.lib.WordArray.create(Buffer.from(publicKey, 'hex'));\n  let key = CryptoJS.SHA256(pubKey);\n  key = CryptoJS.RIPEMD160(key);\n  let versionByte = VERSION_BYTE;\n  if(isRegtest() || isTestnet()) versionByte = VERSION_BYTE_REGTEST;\n  let address = Buffer.concat([Buffer.from([versionByte]), Buffer.from(key.toString(), 'hex')]);\n  key = CryptoJS.SHA256(CryptoJS.lib.WordArray.create(address));\n  key = CryptoJS.SHA256(key);\n  let checksum = key.toString().substring(0, 8);\n  address = new Buffer(address.toString('hex')+checksum,'hex');\n  address = Base58.encode(address);\n  return address;\n}\n\nexport default getAddress;\n","import { Meteor } from 'meteor/meteor';\nimport { getBalance } from '../../../../server/api/doichain.js';\nimport { CONFIRM_CLIENT} from '../../../startup/server/doichain-configuration.js';\n\n\nconst get_Balance = () => {\n    \n  try {\n    const bal=getBalance(CONFIRM_CLIENT);\n    return bal;\n    \n  } catch(exception) {\n    throw new Meteor.Error('doichain.getBalance.exception', exception);\n  }\n  return true;\n};\n\nexport default get_Balance;\n\n","import { Meteor } from 'meteor/meteor';\nimport CryptoJS from 'crypto-js';\nimport SimpleSchema from 'simpl-schema';\n\nconst GetDataHashSchema = new SimpleSchema({\n  data: {\n    type: String\n  }\n});\n\nconst getDataHash = (data) => {\n  try {\n    const ourData = data;\n      GetDataHashSchema.validate(ourData);\n    const hash = CryptoJS.SHA256(ourData).toString();\n    return hash;\n  } catch(exception) {\n    throw new Meteor.Error('doichain.getDataHash.exception', exception);\n  }\n};\n\nexport default getDataHash;\n","import { Meteor } from 'meteor/meteor';\nimport { randomBytes } from 'crypto';\nimport secp256k1 from 'secp256k1';\n\nconst getKeyPair = () => {\n  try {\n    let privKey\n    do {privKey = randomBytes(32)} while(!secp256k1.privateKeyVerify(privKey))\n    const privateKey = privKey;\n    const publicKey = secp256k1.publicKeyCreate(privateKey);\n    return {\n      privateKey: privateKey.toString('hex').toUpperCase(),\n      publicKey: publicKey.toString('hex').toUpperCase()\n    }\n  } catch(exception) {\n    throw new Meteor.Error('doichain.getKeyPair.exception', exception);\n  }\n};\n\nexport default getKeyPair;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport Base58 from 'bs58';\n\nconst GetPrivateKeyFromWifSchema = new SimpleSchema({\n  wif: {\n    type: String\n  }\n});\n\nconst getPrivateKeyFromWif = (data) => {\n  try {\n    const ourData = data;\n    GetPrivateKeyFromWifSchema.validate(ourData);\n    return _getPrivateKeyFromWif(ourData.wif);\n  } catch(exception) {\n    throw new Meteor.Error('doichain.getPrivateKeyFromWif.exception', exception);\n  }\n};\n\nfunction _getPrivateKeyFromWif(wif) {\n  var privateKey = Base58.decode(wif).toString('hex');\n  privateKey = privateKey.substring(2, privateKey.length - 8);\n  if(privateKey.length === 66 && privateKey.endsWith(\"01\")) {\n    privateKey = privateKey.substring(0, privateKey.length - 2);\n  }\n  return privateKey;\n}\n\nexport default getPrivateKeyFromWif;\n","import SimpleSchema from 'simpl-schema';\nimport {logSend} from \"../../../startup/server/log-configuration\";\n\nimport getOptInKey from \"../dns/get_opt-in-key\";\nimport getOptInProvider from \"../dns/get_opt-in-provider\";\nimport getAddress from \"./get_address\";\n\nconst GetPublicKeySchema = new SimpleSchema({\n    domain: {\n        type: String\n    }\n});\n\nconst getPublicKeyAndAddress = (data) => {\n\n    const ourData = data;\n    GetPublicKeySchema.validate(ourData);\n\n    let publicKey = getOptInKey({domain: ourData.domain});\n    if(!publicKey){\n        const provider = getOptInProvider({domain: ourData.domain});\n        logSend(\"using doichain provider instead of directly configured publicKey:\",{provider:provider});\n        publicKey = getOptInKey({domain: provider}); //get public key from provider or fallback if publickey was not set in dns\n    }\n    const destAddress =  getAddress({publicKey: publicKey});\n    logSend('publicKey and destAddress ', {publicKey:publicKey,destAddress:destAddress});\n    return {publicKey:publicKey,destAddress:destAddress};\n};\n\nexport default getPublicKeyAndAddress;","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport bitcore from 'bitcore-lib';\nimport Message from 'bitcore-message';\n\nconst GetSignatureSchema = new SimpleSchema({\n  message: {\n    type: String\n  },\n  privateKey: {\n    type: String\n  }\n});\n\nconst getSignature = (data) => {\n  try {\n    const ourData = data;\n    GetSignatureSchema.validate(ourData);\n    const signature = Message(ourData.message).sign(new bitcore.PrivateKey(ourData.privateKey));\n    return signature;\n  } catch(exception) {\n    throw new Meteor.Error('doichain.getSignature.exception', exception);\n  }\n};\n\nexport default getSignature;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { SEND_CLIENT } from '../../../startup/server/doichain-configuration.js';\nimport encryptMessage from \"./encrypt_message\";\nimport {getUrl} from \"../../../startup/server/dapp-configuration\";\nimport {logBlockchain, logSend} from \"../../../startup/server/log-configuration\";\nimport {feeDoi,nameDoi} from \"../../../../server/api/doichain\";\nimport {OptIns} from \"../../../api/opt-ins/opt-ins\";\nimport getPublicKeyAndAddress from \"./get_publickey_and_address_by_domain\";\n\n\nconst InsertSchema = new SimpleSchema({\n  nameId: {\n    type: String\n  },\n  signature: {\n    type: String\n  },\n  dataHash: {\n    type: String\n  },\n  domain: {\n    type: String\n  },\n  soiDate: {\n    type: Date\n  }\n});\n\nconst insert = (data) => {\n  const ourData = data;\n  try {\n    InsertSchema.validate(ourData);\n    logSend(\"domain:\",ourData.domain);\n\n    const publicKeyAndAddress = getPublicKeyAndAddress({domain:ourData.domain});\n    const from = encryptMessage({publicKey: publicKeyAndAddress.publicKey, message: getUrl()});\n    logSend('encrypted url for use ad from in doichain value:',getUrl(),from);\n\n    const nameValue = JSON.stringify({\n        signature: ourData.signature,\n        dataHash: ourData.dataHash,\n        from: from\n    });\n\n    //TODO (!) this must be replaced in future by \"atomic name trading example\" https://wiki.namecoin.info/?title=Atomic_Name-Trading\n    logBlockchain('sending a fee to bob so he can pay the doi storage (destAddress):', publicKeyAndAddress.destAddress);\n    const feeDoiTx = feeDoi(SEND_CLIENT, publicKeyAndAddress.destAddress);\n    logBlockchain('fee send txid to destaddress', feeDoiTx, publicKeyAndAddress.destAddress);\n\n    logBlockchain('adding data to blockchain via name_doi (nameId,value,destAddress):', ourData.nameId,nameValue,publicKeyAndAddress.destAddress);\n    const nameDoiTx = nameDoi(SEND_CLIENT, ourData.nameId, nameValue, publicKeyAndAddress.destAddress);\n    logBlockchain('name_doi added blockchain. txid:', nameDoiTx);\n\n    OptIns.update({nameId: ourData.nameId}, {$set: {txId:nameDoiTx}});\n    logBlockchain('updating OptIn locally with:', {nameId: ourData.nameId, txId: nameDoiTx});\n\n  } catch(exception) {\n      OptIns.update({nameId: ourData.nameId}, {$set: {error:JSON.stringify(exception.message)}});\n    throw new Meteor.Error('doichain.insert.exception', exception); //TODO update opt-in in local db to inform user about the error! e.g. Insufficient funds etc.\n  }\n};\n\nexport default insert;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { CONFIRM_CLIENT } from '../../../startup/server/doichain-configuration.js';\nimport {getWif, signMessage, getTransaction, nameDoi, nameShow} from \"../../../../server/api/doichain\";\nimport {API_PATH, DOI_CONFIRMATION_NOTIFY_ROUTE, VERSION} from \"../../../../server/api/rest/rest\";\nimport {CONFIRM_ADDRESS} from \"../../../startup/server/doichain-configuration\";\nimport {getHttpPUT} from \"../../../../server/api/http\";\nimport {logConfirm} from \"../../../startup/server/log-configuration\";\nimport getPrivateKeyFromWif from \"./get_private-key_from_wif\";\nimport decryptMessage from \"./decrypt_message\";\nimport {OptIns} from \"../../../api/opt-ins/opt-ins\";\n\nconst UpdateSchema = new SimpleSchema({\n  nameId: {\n    type: String\n  },\n  value: {\n    type: String\n  },\n  host : {\n      type: String,\n      optional: true,\n  },\n  fromHostUrl : {\n      type: String\n  }\n});\n\nconst update = (data, job) => {\n  try {\n    const ourData = data;\n\n    UpdateSchema.validate(ourData);\n\n    //stop this update until this name as at least 1 confirmation\n    const name_data = nameShow(CONFIRM_CLIENT,ourData.nameId);\n    if(name_data === undefined){\n        rerun(job);\n        logConfirm('name not visible - delaying name update',ourData.nameId);\n        return;\n    }\n    const our_transaction = getTransaction(CONFIRM_CLIENT,name_data.txid);\n    if(our_transaction.confirmations===0){\n        rerun(job);\n        logConfirm('transaction has 0 confirmations - delaying name update',JSON.parse(ourData.value));\n        return;\n    }\n    logConfirm('updating blockchain with doiSignature:',JSON.parse(ourData.value));\n    const wif = getWif(CONFIRM_CLIENT, CONFIRM_ADDRESS);\n    const privateKey = getPrivateKeyFromWif({wif: wif});\n    logConfirm('got private key (will not show it here) in order to decrypt Send-dApp host url from value:',ourData.fromHostUrl);\n    const ourfromHostUrl = decryptMessage({privateKey: privateKey, message: ourData.fromHostUrl});\n    logConfirm('decrypted fromHostUrl',ourfromHostUrl);\n    const url = ourfromHostUrl+API_PATH+VERSION+\"/\"+DOI_CONFIRMATION_NOTIFY_ROUTE;\n\n    logConfirm('creating signature with ADDRESS'+CONFIRM_ADDRESS+\" nameId:\",ourData.value);\n    const signature = signMessage(CONFIRM_CLIENT, CONFIRM_ADDRESS, ourData.nameId); //TODO why here over nameID?\n    logConfirm('signature created:',signature);\n\n    const updateData = {\n        nameId: ourData.nameId,\n        signature: signature,\n        host: ourData.host\n    };\n\n    try {\n        const txid = nameDoi(CONFIRM_CLIENT, ourData.nameId, ourData.value, null);\n        logConfirm('update transaction txid:',txid);\n    }catch(exception){\n        //\n        logConfirm('this nameDOI doesnÂ´t have a block yet and will be updated with the next block and with the next queue start:',ourData.nameId);\n        if(exception.toString().indexOf(\"there is already a registration for this doi name\")==-1) {\n            OptIns.update({nameId: ourData.nameId}, {$set: {error: JSON.stringify(exception.message)}});\n        }\n        throw new Meteor.Error('doichain.update.exception', exception);\n        //}else{\n        //    logConfirm('this nameDOI doesnÂ´t have a block yet and will be updated with the next block and with the next queue start:',ourData.nameId);\n        //}\n    }\n\n    const response = getHttpPUT(url, updateData);\n    logConfirm('informed send dApp about confirmed doi on url:'+url+' with updateData'+JSON.stringify(updateData)+\" response:\",response.data);\n    job.done();\n  } catch(exception) {\n    throw new Meteor.Error('doichain.update.exception', exception);\n  }\n};\n\nfunction rerun(job){\n    logConfirm('rerunning txid in 10sec - canceling old job','');\n    job.cancel();\n    logConfirm('restart blockchain doi update','');\n    job.restart(\n        {\n            //repeats: 600,   // Only repeat this once\n            // This is the default\n           // wait: 10000   // Wait 10 sec between repeats\n                          // Default is previous setting\n        },\n        function (err, result) {\n            if (result) {\n                logConfirm('rerunning txid in 10sec:',result);\n            }\n        }\n    );\n}\n\nexport default update;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport bitcore from 'bitcore-lib';\nimport Message from 'bitcore-message';\nimport {logError, logVerify} from \"../../../startup/server/log-configuration\";\nconst NETWORK = bitcore.Networks.add({\n  name: 'doichain',\n  alias: 'doichain',\n  pubkeyhash: 0x34,\n  privatekey: 0xB4,\n  scripthash: 13,\n  networkMagic: 0xf9beb4fe,\n});\n\nconst VerifySignatureSchema = new SimpleSchema({\n  data: {\n    type: String\n  },\n  publicKey: {\n    type: String\n  },\n  signature: {\n    type: String\n  }\n});\n\nconst verifySignature = (data) => {\n  try {\n    const ourData = data;\n    logVerify('verifySignature:',ourData);\n    VerifySignatureSchema.validate(ourData);\n    const address = bitcore.Address.fromPublicKey(new bitcore.PublicKey(ourData.publicKey), NETWORK);\n    try {\n      return Message(ourData.data).verify(address, ourData.signature);\n    } catch(error) { logError(error)}\n    return false;\n  } catch(exception) {\n    throw new Meteor.Error('doichain.verifySignature.exception', exception);\n  }\n};\n\nexport default verifySignature;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport { Senders } from '../../../api/senders/senders.js';\nimport { Recipients } from '../../../api/recipients/recipients.js';\nimport generateNameId from './generate_name-id.js';\nimport getSignature from './get_signature.js';\nimport getDataHash from './get_data-hash.js';\nimport addInsertBlockchainJob from '../jobs/add_insert_blockchain.js';\nimport {logSend} from \"../../../startup/server/log-configuration\";\n\nconst WriteToBlockchainSchema = new SimpleSchema({\n  id: {\n    type: String\n  }\n});\n\nconst writeToBlockchain = (data) => {\n  try {\n    const ourData = data;\n    WriteToBlockchainSchema.validate(ourData);\n\n    const optIn = OptIns.findOne({_id: data.id});\n    const recipient = Recipients.findOne({_id: optIn.recipient});\n    const sender = Senders.findOne({_id: optIn.sender});\n    logSend(\"optIn data:\",{index:ourData.index, optIn:optIn,recipient:recipient,sender: sender});\n\n\n    const nameId = generateNameId({id: data.id,index:optIn.index,masterDoi:optIn.masterDoi });\n    const signature = getSignature({message: recipient.email+sender.email, privateKey: recipient.privateKey});\n    logSend(\"generated signature from email recipient and sender:\",signature);\n\n    let dataHash = \"\";\n\n    if(optIn.data) {\n      dataHash = getDataHash({data: optIn.data});\n      logSend(\"generated datahash from given data:\",dataHash);\n    }\n\n    const parts = recipient.email.split(\"@\");\n    const domain = parts[parts.length-1];\n    logSend(\"email domain for publicKey request is:\",domain);\n    addInsertBlockchainJob({\n      nameId: nameId,\n      signature: signature,\n      dataHash: dataHash,\n      domain: domain,\n      soiDate: optIn.createdAt\n    })\n  } catch (exception) {\n    throw new Meteor.Error('doichain.writeToBlockchain.exception', exception);\n  }\n};\n\nexport default writeToBlockchain\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { HashIds } from '../../../startup/server/email-configuration.js';\n\nconst DecodeDoiHashSchema = new SimpleSchema({\n  hash: {\n    type: String\n  }\n});\n\nconst decodeDoiHash = (hash) => {\n  try {\n    const ourHash = hash;\n    DecodeDoiHashSchema.validate(ourHash);\n    const hex = HashIds.decodeHex(ourHash.hash);\n    if(!hex || hex === '') throw \"Wrong hash\";\n    try {\n      const obj = JSON.parse(Buffer(hex, 'hex').toString('ascii'));\n      return obj;\n    } catch(exception) {throw \"Wrong hash\";}\n  } catch (exception) {\n    throw new Meteor.Error('emails.decode_doi-hash.exception', exception);\n  }\n};\n\nexport default decodeDoiHash;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { HashIds } from '../../../startup/server/email-configuration.js';\n\nconst GenerateDoiHashSchema = new SimpleSchema({\n  id: {\n    type: String\n  },\n  token: {\n    type: String\n  },\n  redirect: {\n    type: String\n  }\n});\n\nconst generateDoiHash = (optIn) => {\n  try {\n    const ourOptIn = optIn;\n    GenerateDoiHashSchema.validate(ourOptIn);\n\n    const json = JSON.stringify({\n      id: ourOptIn.id,\n      token: ourOptIn.token,\n      redirect: ourOptIn.redirect\n    });\n\n    const hex = Buffer(json).toString('hex');\n    const hash = HashIds.encodeHex(hex);\n    return hash;\n  } catch (exception) {\n    throw new Meteor.Error('emails.generate_doi-hash.exception', exception);\n  }\n};\n\nexport default generateDoiHash;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport {logConfirm} from \"../../../startup/server/log-configuration\";\n\nconst PLACEHOLDER_REGEX = /\\${([\\w]*)}/g;\nconst ParseTemplateSchema = new SimpleSchema({\n  template: {\n    type: String,\n  },\n  data: {\n    type: Object,\n    blackbox: true\n  }\n});\n\nconst parseTemplate = (data) => {\n  try {\n    const ourData = data;\n    //logConfirm('parseTemplate:',ourData);\n\n    ParseTemplateSchema.validate(ourData);\n    logConfirm('ParseTemplateSchema validated');\n\n    var _match;\n    var template = ourData.template;\n   //logConfirm('doing some regex with template:',template);\n\n    do {\n      _match = PLACEHOLDER_REGEX.exec(template);\n      if(_match) template = _replacePlaceholder(template, _match, ourData.data[_match[1]]);\n    } while (_match);\n    return template;\n  } catch (exception) {\n    throw new Meteor.Error('emails.parseTemplate.exception', exception);\n  }\n};\n\nfunction _replacePlaceholder(template, _match, replace) {\n  var rep = replace;\n  if(replace === undefined) rep = \"\";\n  return template.substring(0, _match.index)+rep+template.substring(_match.index+_match[0].length);\n}\n\nexport default parseTemplate;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport {logConfirm} from \"../../../startup/server/log-configuration\";\nimport { DOI_MAIL_DEFAULT_EMAIL_FROM } from '../../../startup/server/email-configuration.js';\n\nconst SendMailSchema = new SimpleSchema({\n  from: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  to: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  subject: {\n    type: String,\n  },\n  message: {\n    type: String,\n  },\n  returnPath: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  }\n});\n\nconst sendMail = (mail) => {\n  try {\n\n    mail.from = DOI_MAIL_DEFAULT_EMAIL_FROM;\n\n    const ourMail = mail;\n    logConfirm('sending email with data:',{to:mail.to, subject:mail.subject});\n    SendMailSchema.validate(ourMail);\n    //TODO: Text fallback\n    Email.send({\n      from: mail.from,\n      to: mail.to,\n      subject: mail.subject,\n      html: mail.message,\n      headers: {\n        'Return-Path': mail.returnPath,\n      }\n    });\n\n  } catch (exception) {\n    throw new Meteor.Error('emails.send.exception', exception);\n  }\n};\n\nexport default sendMail;\n","import { Meteor } from 'meteor/meteor';\nimport { Job } from 'meteor/vsivsi:job-collection';\nimport { BlockchainJobs } from '../../../../server/api/blockchain_jobs.js';\n\nconst addCheckNewTransactionsBlockchainJob = () => {\n  try {\n    const job = new Job(BlockchainJobs, 'checkNewTransaction', {});\n    job.retry({retries: 60, wait: 15*1000 }).save({cancelRepeats: true});\n  } catch (exception) {\n    throw new Meteor.Error('jobs.addCheckNewTransactionsBlockchain.exception', exception);\n  }\n};\n\nexport default addCheckNewTransactionsBlockchainJob;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { Job } from 'meteor/vsivsi:job-collection';\nimport { DAppJobs } from '../../../../server/api/dapp_jobs.js';\n\nconst AddFetchDoiMailDataJobSchema = new SimpleSchema({\n  name: {\n    type: String\n  },\n  domain: {\n    type: String\n  }\n});\n\nconst addFetchDoiMailDataJob = (data) => {\n  try {\n    const ourData = data;\n    AddFetchDoiMailDataJobSchema.validate(ourData);\n    const job = new Job(DAppJobs, 'fetchDoiMailData', ourData);\n    job.retry({retries: 5, wait: 1*10*1000 }).save(); //check every 10 secs 5 times\n  } catch (exception) {\n    throw new Meteor.Error('jobs.addFetchDoiMailData.exception', exception);\n  }\n};\n\nexport default addFetchDoiMailDataJob;\n","import { Meteor } from 'meteor/meteor';\nimport { Job } from 'meteor/vsivsi:job-collection';\nimport SimpleSchema from 'simpl-schema';\nimport { BlockchainJobs } from '../../../../server/api/blockchain_jobs.js';\n\nconst AddInsertBlockchainJobSchema = new SimpleSchema({\n  nameId: {\n    type: String\n  },\n  signature: {\n    type: String\n  },\n  dataHash: {\n    type: String,\n    optional:true\n  },\n  domain: {\n    type: String\n  },\n  soiDate: {\n    type: Date\n  }\n});\n\nconst addInsertBlockchainJob = (entry) => {\n  try {\n    const ourEntry = entry;\n    AddInsertBlockchainJobSchema.validate(ourEntry);\n    const job = new Job(BlockchainJobs, 'insert', ourEntry);\n    job.retry({retries: 10, wait: 3*60*1000 }).save(); //check every 10sec for 1h\n  } catch (exception) {\n    throw new Meteor.Error('jobs.addInsertBlockchain.exception', exception);\n  }\n};\n\nexport default addInsertBlockchainJob;\n","import { Meteor } from 'meteor/meteor';\nimport { Job } from 'meteor/vsivsi:job-collection';\nimport SimpleSchema from 'simpl-schema';\nimport { MailJobs } from '../../../../server/api/mail_jobs.js';\n\nconst AddSendMailJobSchema = new SimpleSchema({\n  /*from: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },*/\n  to: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  subject: {\n    type: String,\n  },\n  message: {\n    type: String,\n  },\n  returnPath: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  }\n});\n\nconst addSendMailJob = (mail) => {\n  try {\n    const ourMail = mail;\n    AddSendMailJobSchema.validate(ourMail);\n    const job = new Job(MailJobs, 'send', ourMail);\n    job.retry({retries: 5, wait: 60*1000 }).save();\n  } catch (exception) {\n    throw new Meteor.Error('jobs.addSendMail.exception', exception);\n  }\n};\n\nexport default addSendMailJob;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { Job } from 'meteor/vsivsi:job-collection';\nimport { BlockchainJobs } from '../../../../server/api/blockchain_jobs.js';\n\nconst AddUpdateBlockchainJobSchema = new SimpleSchema({\n  nameId: {\n    type: String\n  },\n  value: {\n    type: String\n  },\n  fromHostUrl: {\n    type: String\n  },\n  host: {\n      type: String\n  }\n});\n\nconst addUpdateBlockchainJob = (entry) => {\n  try {\n    const ourEntry = entry;\n    AddUpdateBlockchainJobSchema.validate(ourEntry);\n    const job = new Job(BlockchainJobs, 'update', ourEntry);\n    job.retry({retries: 360, wait: 1*10*1000 }).save();\n  } catch (exception) {\n    throw new Meteor.Error('jobs.addUpdateBlockchain.exception', exception);\n  }\n};\n\nexport default addUpdateBlockchainJob;\n","import { Meteor } from 'meteor/meteor';\nimport i18n from 'meteor/universe:i18n';\n\n// universe:i18n only bundles the default language on the client side.\n// To get a list of all avialble languages with at least one translation,\n// i18n.getLanguages() must be called server side.\nconst getLanguages = () => {\n  try {\n    return i18n.getLanguages();\n  } catch (exception) {\n    throw new Meteor.Error('languages.get.exception', exception);\n  }\n};\n\nexport default getLanguages;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { Meta } from '../../../api/meta/meta.js';\n\nconst AddOrUpdateMetaSchema = new SimpleSchema({\n  key: {\n    type: String\n  },\n  value: {\n    type: String\n  }\n});\n\nconst addOrUpdateMeta = (data) => {\n  try {\n    const ourData = data;\n    AddOrUpdateMetaSchema.validate(ourData);\n    const meta = Meta.findOne({key: ourData.key});\n    if(meta !== undefined) Meta.update({_id : meta._id}, {$set: {\n      value: ourData.value\n    }});\n    else return Meta.insert({\n      key: ourData.key,\n      value: ourData.value\n    })\n  } catch (exception) {\n    throw new Meteor.Error('meta.addOrUpdate.exception', exception);\n  }\n};\n\nexport default addOrUpdateMeta;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\n\nconst AddOptInSchema = new SimpleSchema({\n  name: {\n    type: String\n  }\n});\n\nconst addOptIn = (optIn) => {\n  try {\n    const ourOptIn = optIn;\n    AddOptInSchema.validate(ourOptIn);\n    const optIns = OptIns.find({nameId: ourOptIn.name}).fetch();\n    if(optIns.length > 0) return optIns[0]._id;\n    const optInId = OptIns.insert({\n      nameId: ourOptIn.name\n    });\n    return optInId;\n  } catch (exception) {\n    throw new Meteor.Error('opt-ins.add.exception', exception);\n  }\n};\n\nexport default addOptIn;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport addRecipient from '../recipients/add.js';\nimport addSender from '../senders/add.js';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport writeToBlockchain from '../doichain/write_to_blockchain.js';\nimport {logError, logSend} from \"../../../startup/server/log-configuration\";\n\n\nconst AddOptInSchema = new SimpleSchema({\n  recipient_mail: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  sender_mail: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  data: {\n    type: String,\n    optional: true\n  },\n  master_doi: {\n      type: String,\n      optional: true\n  },\n  index: {\n      type: SimpleSchema.Integer,\n      optional: true\n  },\n  ownerId: {\n    type: String,\n    regEx: SimpleSchema.RegEx.id\n  }\n});\n\nconst addOptIn = (optIn) => {\n  try {\n    const ourOptIn = optIn;\n    AddOptInSchema.validate(ourOptIn);\n\n    const recipient = {\n      email: ourOptIn.recipient_mail\n    }\n    const recipientId = addRecipient(recipient);\n    const sender = {\n      email: ourOptIn.sender_mail\n    }\n    const senderId = addSender(sender);\n    \n    const optIns = OptIns.find({recipient: recipientId, sender: senderId}).fetch();\n    if(optIns.length > 0) return optIns[0]._id; //TODO when SOI already exists resend email?\n\n    if(ourOptIn.data !== undefined) {\n      try {\n        JSON.parse(ourOptIn.data);\n      } catch(error) {\n        logError(\"ourOptIn.data:\",ourOptIn.data);\n        throw \"Invalid data json \";\n      }\n    }\n    \n    const optInId = OptIns.insert({\n      recipient: recipientId,\n      sender: senderId,\n      index: ourOptIn.index,\n      masterDoi : ourOptIn.master_doi,\n      data: ourOptIn.data,\n      ownerId: ourOptIn.ownerId\n    });\n    logSend(\"optIn (index:\"+ourOptIn.index+\" added to local db with optInId\",optInId);\n\n    writeToBlockchain({id: optInId});\n    return optInId;\n  } catch (exception) {\n    throw new Meteor.Error('opt-ins.addAndWriteToBlockchain.exception', exception);\n  }\n};\n\nexport default addOptIn;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { CONFIRM_CLIENT, CONFIRM_ADDRESS } from '../../../startup/server/doichain-configuration.js';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport { DoichainEntries } from '../../../api/doichain/entries.js';\nimport decodeDoiHash from '../emails/decode_doi-hash.js';\nimport { signMessage } from '../../../../server/api/doichain.js';\nimport addUpdateBlockchainJob from '../jobs/add_update_blockchain.js';\nimport {logConfirm} from \"../../../startup/server/log-configuration\";\n\nconst ConfirmOptInSchema = new SimpleSchema({\n  host: {\n    type: String\n  },\n  hash: {\n    type: String\n  }\n});\n\nconst confirmOptIn = (request) => {\n  try {\n    const ourRequest = request;\n    ConfirmOptInSchema.validate(ourRequest);\n    const decoded = decodeDoiHash({hash: request.hash});\n    const optIn = OptIns.findOne({_id: decoded.id});\n    if(optIn === undefined || optIn.confirmationToken !== decoded.token) throw \"Invalid hash\";\n    const confirmedAt = new Date();\n\n    OptIns.update({_id : optIn._id},{$set:{confirmedAt: confirmedAt, confirmedBy: ourRequest.host}, $unset: {confirmationToken: \"\"}});\n\n    //TODO here find all DoichainEntries in the local database  and blockchain with the same masterDoi\n    const entries = DoichainEntries.find({$or: [{name: optIn.nameId}, {masterDoi: optIn.nameId}]});\n    if(entries === undefined) throw \"Doichain entry/entries not found\";\n\n    entries.forEach(entry => {\n        logConfirm('confirming DoiChainEntry:',entry);\n\n        const value = JSON.parse(entry.value);\n        logConfirm('getSignature (only of value!)', value);\n\n        const doiSignature = signMessage(CONFIRM_CLIENT, CONFIRM_ADDRESS, value.signature);\n        logConfirm('got doiSignature:',doiSignature);\n        const fromHostUrl = value.from;\n\n        delete value.from;\n        value.doiTimestamp = confirmedAt.toISOString();\n        value.doiSignature = doiSignature;\n        const jsonValue = JSON.stringify(value);\n        logConfirm('updating Doichain nameId:'+optIn.nameId+' with value:',jsonValue);\n\n        addUpdateBlockchainJob({\n            nameId: entry.name,\n            value: jsonValue,\n            fromHostUrl: fromHostUrl,\n            host: ourRequest.host\n        });\n    });\n    logConfirm('redirecting user to:',decoded.redirect);\n    return decoded.redirect;\n  } catch (exception) {\n    throw new Meteor.Error('opt-ins.confirm.exception', exception);\n  }\n};\n\nexport default confirmOptIn\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { randomBytes } from 'crypto';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\n\nconst GenerateDoiTokenSchema = new SimpleSchema({\n  id: {\n    type: String\n  }\n});\n\nconst generateDoiToken = (optIn) => {\n  try {\n    const ourOptIn = optIn;\n    GenerateDoiTokenSchema.validate(ourOptIn);\n    const token = randomBytes(32).toString('hex');\n    OptIns.update({_id : ourOptIn.id},{$set:{confirmationToken: token}});\n    return token;\n  } catch (exception) {\n    throw new Meteor.Error('opt-ins.generate_doi-token.exception', exception);\n  }\n};\n\nexport default generateDoiToken\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { OptIns } from '../../../api/opt-ins/opt-ins.js';\nimport { Recipients } from '../../../api/recipients/recipients.js';\nimport verifySignature from '../doichain/verify_signature.js';\nimport {logSend} from \"../../../startup/server/log-configuration\";\nimport getPublicKeyAndAddress from \"../doichain/get_publickey_and_address_by_domain\";\n\nconst UpdateOptInStatusSchema = new SimpleSchema({\n  nameId: {\n    type: String\n  },\n  signature: {\n    type: String\n  },\n  host: {\n      type: String,\n      optional: true\n  }\n});\n\n\nconst updateOptInStatus = (data) => {\n  try {\n    const ourData = data;\n    logSend('confirm dApp confirms optIn:',JSON.stringify(data));\n    UpdateOptInStatusSchema.validate(ourData);\n    const optIn = OptIns.findOne({nameId: ourData.nameId});\n    if(optIn === undefined) throw \"Opt-In not found\";\n    logSend('confirm dApp confirms optIn:',ourData.nameId);\n\n    const recipient = Recipients.findOne({_id: optIn.recipient});\n    if(recipient === undefined) throw \"Recipient not found\";\n    const parts = recipient.email.split(\"@\");\n    const domain = parts[parts.length-1];\n    const publicKeyAndAddress = getPublicKeyAndAddress({domain:domain});\n\n    //TODO getting information from Bob that a certain nameId (DOI) got confirmed.\n    if(!verifySignature({publicKey: publicKeyAndAddress.publicKey, data: ourData.nameId, signature: ourData.signature})) {\n      throw \"Access denied\";\n    }\n    logSend('signature valid for publicKey', publicKeyAndAddress.publicKey);\n\n    OptIns.update({_id : optIn._id},{$set:{confirmedAt: new Date(), confirmedBy: ourData.host}});\n  } catch (exception) {\n    throw new Meteor.Error('dapps.send.updateOptInStatus.exception', exception);\n  }\n};\n\nexport default updateOptInStatus;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { VERIFY_CLIENT } from '../../../startup/server/doichain-configuration.js';\nimport { nameShow } from '../../../../server/api/doichain.js';\nimport getOptInProvider from '../dns/get_opt-in-provider.js';\nimport getOptInKey from '../dns/get_opt-in-key.js';\nimport verifySignature from '../doichain/verify_signature.js';\nimport {logVerify} from \"../../../startup/server/log-configuration\";\nimport getPublicKeyAndAddress from \"../doichain/get_publickey_and_address_by_domain\";\n\nconst VerifyOptInSchema = new SimpleSchema({\n  recipient_mail: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  sender_mail: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  name_id: {\n    type: String\n  },\n  recipient_public_key: {\n    type: String\n  }\n});\n\nconst verifyOptIn = (data) => {\n  try {\n    const ourData = data;\n    VerifyOptInSchema.validate(ourData);\n    const entry = nameShow(VERIFY_CLIENT, ourData.name_id);\n    if(entry === undefined) return false;\n    const entryData = JSON.parse(entry.value);\n    const firstCheck = verifySignature({\n      data: ourData.recipient_mail+ourData.sender_mail,\n      signature: entryData.signature,\n      publicKey: ourData.recipient_public_key\n    })\n\n    if(!firstCheck) return {firstCheck: false};\n    const parts = ourData.recipient_mail.split(\"@\"); //TODO put this into getPublicKeyAndAddress\n    const domain = parts[parts.length-1];\n    const publicKeyAndAddress = getPublicKeyAndAddress({domain: domain});\n\n    const secondCheck = verifySignature({\n      data: entryData.signature,\n      signature: entryData.doiSignature,\n      publicKey: publicKeyAndAddress.publicKey\n    })\n\n    if(!secondCheck) return {secondCheck: false};\n    return true;\n  } catch (exception) {\n    throw new Meteor.Error('opt-ins.verify.exception', exception);\n  }\n};\n\nexport default verifyOptIn\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { Recipients } from '../../../api/recipients/recipients.js';\nimport getKeyPair from '../doichain/get_key-pair.js';\n\nconst AddRecipientSchema = new SimpleSchema({\n  email: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  }\n});\n\nconst addRecipient = (recipient) => {\n  try {\n    const ourRecipient = recipient;\n    AddRecipientSchema.validate(ourRecipient);\n    const recipients = Recipients.find({email: recipient.email}).fetch();\n    if(recipients.length > 0) return recipients[0]._id;\n    const keyPair = getKeyPair();\n    return Recipients.insert({\n      email: ourRecipient.email,\n      privateKey: keyPair.privateKey,\n      publicKey: keyPair.publicKey\n    })\n  } catch (exception) {\n    throw new Meteor.Error('recipients.add.exception', exception);\n  }\n};\n\nexport default addRecipient;\n","import { Meteor } from 'meteor/meteor';\nimport SimpleSchema from 'simpl-schema';\nimport { Senders } from '../../../api/senders/senders.js';\n\nconst AddSenderSchema = new SimpleSchema({\n  email: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  }\n});\n\nconst addSender = (sender) => {\n  try {\n    const ourSender = sender;\n    AddSenderSchema.validate(ourSender);\n    const senders = Senders.find({email: sender.email}).fetch();\n    if(senders.length > 0) return senders[0]._id;\n    return Senders.insert({\n      email: ourSender.email\n    })\n  } catch (exception) {\n    throw new Meteor.Error('senders.add.exception', exception);\n  }\n};\n\nexport default addSender;\n","import { Meteor } from 'meteor/meteor';\n\nexport function isDebug() {\n  if(Meteor.settings !== undefined &&\n     Meteor.settings.app !== undefined &&\n     Meteor.settings.app.debug !== undefined) return Meteor.settings.app.debug\n  return false;\n}\n\nexport function isRegtest() {\n  if(Meteor.settings !== undefined &&\n     Meteor.settings.app !== undefined &&\n     Meteor.settings.app.regtest !== undefined) return Meteor.settings.app.regtest\n  return false;\n}\n\nexport function isTestnet() {\n    if(Meteor.settings !== undefined &&\n        Meteor.settings.app !== undefined &&\n        Meteor.settings.app.testnet !== undefined) return Meteor.settings.app.testnet\n    return false;\n}\n\nexport function getUrl() {\n  if(Meteor.settings !== undefined &&\n     Meteor.settings.app !== undefined &&\n     Meteor.settings.app.host !== undefined) {\n       let port = 3000;\n       if(Meteor.settings.app.port !== undefined) port = Meteor.settings.app.port\n       return \"http://\"+Meteor.settings.app.host+\":\"+port+\"/\";\n  }\n  return Meteor.absoluteUrl();\n}\n","export const FALLBACK_PROVIDER = \"doichain.org\";\n","import namecoin from 'namecoin';\nimport { SEND_APP, CONFIRM_APP, VERIFY_APP, isAppType } from './type-configuration.js';\n\nvar sendSettings = Meteor.settings.send;\nvar sendClient = undefined;\nif(isAppType(SEND_APP)) {\n  if(!sendSettings || !sendSettings.doichain)\n    throw new Meteor.Error(\"config.send.doichain\", \"Send app doichain settings not found\")\n  sendClient = createClient(sendSettings.doichain);\n}\nexport const SEND_CLIENT = sendClient;\n\nvar confirmSettings = Meteor.settings.confirm;\nvar confirmClient = undefined;\nvar confirmAddress = undefined;\nif(isAppType(CONFIRM_APP)) {\n  if(!confirmSettings || !confirmSettings.doichain)\n    throw new Meteor.Error(\"config.confirm.doichain\", \"Confirm app doichain settings not found\")\n  confirmClient = createClient(confirmSettings.doichain);\n  confirmAddress = confirmSettings.doichain.address;\n}\nexport const CONFIRM_CLIENT = confirmClient;\nexport const CONFIRM_ADDRESS = confirmAddress;\n\nvar verifySettings = Meteor.settings.verify;\nvar verifyClient = undefined;\nif(isAppType(VERIFY_APP)) {\n  if(!verifySettings || !verifySettings.doichain)\n    throw new Meteor.Error(\"config.verify.doichain\", \"Verify app doichain settings not found\")\n  verifyClient = createClient(verifySettings.doichain);\n}\nexport const VERIFY_CLIENT = verifyClient;\n\nfunction createClient(settings) {\n  return new namecoin.Client({\n    host: settings.host,\n    port: settings.port,\n    user: settings.username,\n    pass: settings.password\n  });\n}\n","import { Meteor } from 'meteor/meteor';\nimport { SEND_APP, CONFIRM_APP, isAppType } from './type-configuration.js';\nimport Hashids from 'hashids';\n//const Hashids = require('hashids').default;\nimport {logConfirm} from \"./log-configuration\";\n\nexport const HashIds = new Hashids('0xugmLe7Nyee6vk1iF88(6CmwpqoG4hQ*-T74tjYw^O2vOO(Xl-91wA8*nCg_lX$');\n\nvar sendSettings = Meteor.settings.send;\nvar doiMailFetchUrl = undefined;\n\nif(isAppType(SEND_APP)) {\n  if(!sendSettings || !sendSettings.doiMailFetchUrl)\n    throw new Meteor.Error(\"config.send.email\", \"Settings not found\");\n  doiMailFetchUrl = sendSettings.doiMailFetchUrl;\n}\nexport const DOI_MAIL_FETCH_URL = doiMailFetchUrl;\n\nvar defaultFrom = undefined;\nif(isAppType(CONFIRM_APP)) {\n  var confirmSettings = Meteor.settings.confirm;\n\n  if(!confirmSettings || !confirmSettings.smtp)\n        throw new Meteor.Error(\"config.confirm.smtp\", \"Confirm app email smtp settings not found\")\n\n  if(!confirmSettings.smtp.defaultFrom)\n        throw new Meteor.Error(\"config.confirm.defaultFrom\", \"Confirm app email defaultFrom not found\")\n\n  defaultFrom  =  confirmSettings.smtp.defaultFrom;\n\n  logConfirm('sending with defaultFrom:',defaultFrom);\n\n  Meteor.startup(() => {\n\n   if(confirmSettings.smtp.username === undefined){\n       process.env.MAIL_URL = 'smtp://' +\n           encodeURIComponent(confirmSettings.smtp.server) +\n           ':' +\n           confirmSettings.smtp.port;\n   }else{\n       process.env.MAIL_URL = 'smtp://' +\n           encodeURIComponent(confirmSettings.smtp.username) +\n           ':' + encodeURIComponent(confirmSettings.smtp.password) +\n           '@' + encodeURIComponent(confirmSettings.smtp.server) +\n           ':' +\n           confirmSettings.smtp.port;\n   }\n\n   logConfirm('using MAIL_URL:',process.env.MAIL_URL);\n\n   if(confirmSettings.smtp.NODE_TLS_REJECT_UNAUTHORIZED!==undefined)\n       process.env.NODE_TLS_REJECT_UNAUTHORIZED = confirmSettings.smtp.NODE_TLS_REJECT_UNAUTHORIZED; //0\n  });\n}\nexport const DOI_MAIL_DEFAULT_EMAIL_FROM = defaultFrom;\n","import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\n\nMeteor.startup(() => {\n  if(Meteor.users.find().count() === 0) {\n    const id = Accounts.createUser({\n      username: 'admin',\n      email: 'admin@sendeffect.de',\n      password: 'password'\n    });\n    Roles.addUsersToRoles(id, 'admin');\n  }\n});\n","import './log-configuration.js';\nimport './dapp-configuration.js';\nimport './type-configuration.js';\nimport './dns-configuration.js';\nimport './doichain-configuration.js';\nimport './fixtures.js';\nimport './register-api.js';\nimport './useraccounts-configuration.js';\nimport './security.js';\nimport './email-configuration.js';\nimport './jobs.js';\n","import { Meteor } from 'meteor/meteor';\nimport { MailJobs } from '../../../server/api/mail_jobs.js';\nimport { BlockchainJobs } from '../../../server/api/blockchain_jobs.js';\nimport { DAppJobs } from '../../../server/api/dapp_jobs.js';\nimport { CONFIRM_APP, isAppType } from './type-configuration.js';\nimport addCheckNewTransactionsBlockchainJob from '../../modules/server/jobs/add_check_new_transactions.js';\n\nMeteor.startup(() => {\n  MailJobs.startJobServer();\n  BlockchainJobs.startJobServer();\n  DAppJobs.startJobServer();\n  if(isAppType(CONFIRM_APP)) addCheckNewTransactionsBlockchainJob();\n});\n","import {isDebug} from \"./dapp-configuration\";\n\nrequire('scribe-js')();\n\nexport const console = process.console;\nexport const sendModeTagColor = {msg : 'send-mode', colors : ['yellow', 'inverse']};\nexport const confirmModeTagColor = {msg : 'confirm-mode', colors : ['blue', 'inverse']};\nexport const verifyModeTagColor = {msg : 'verify-mode', colors : ['green', 'inverse']};\nexport const blockchainModeTagColor = {msg : 'blockchain-mode', colors : ['white', 'inverse']};\nexport const testingModeTagColor = {msg : 'testing-mode', colors : ['orange', 'inverse']};\n\nexport function logSend(message,param) {\n    if(isDebug()) {console.time().tag(sendModeTagColor).log(message,param?param:'');}\n}\n\nexport function logConfirm(message,param) {\n    if(isDebug()) {console.time().tag(confirmModeTagColor).log(message, param?param:'');}\n}\n\nexport function logVerify(message, param) {\n    if(isDebug()) {console.time().tag(verifyModeTagColor).log(message, param?param:'');}\n}\n\nexport function logBlockchain(message, param) {\n    if(isDebug()){console.time().tag(blockchainModeTagColor).log(message, param?param:'');}\n}\n\nexport function logMain(message, param) {\n    if(isDebug()){console.time().tag(blockchainModeTagColor).log(message, param?param:'');}\n}\n\nexport function logError(message, param) {\n    if(isDebug()){console.time().tag(blockchainModeTagColor).error(message, param?param:'');}\n}\n\nexport function testLogging(message, param) {\n    if(isDebug()){console.time().tag(testingModeTagColor).log(message, param?param:'');}\n}","import '../../api/languages/methods.js';\nimport '../../api/doichain/methods.js';\nimport '../../api/recipients/server/publications.js';\nimport '../../api/opt-ins/methods.js';\nimport '../../api/opt-ins/server/publications.js';\n","import { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { _ } from 'meteor/underscore';\n\n// Don't let people write arbitrary data to their 'profile' field from the client\nMeteor.users.deny({\n  update() {\n    return true;\n  },\n});\n\n// Get a list of all accounts methods by running `Meteor.server.method_handlers` in meteor shell\nconst AUTH_METHODS = [\n  'login',\n  'logout',\n  'logoutOtherClients',\n  'getNewToken',\n  'removeOtherTokens',\n  'configureLoginService',\n  'changePassword',\n  'forgotPassword',\n  'resetPassword',\n  'verifyEmail',\n  'createUser',\n  'ATRemoveService',\n  'ATCreateUserServer',\n  'ATResendVerificationEmail',\n];\n\nif (Meteor.isServer) {\n  // Only allow 2 login attempts per connection per 5 seconds\n  DDPRateLimiter.addRule({\n    name(name) {\n      return _.contains(AUTH_METHODS, name);\n    },\n\n    // Rate limit per connection ID\n    connectionId() { return true; },\n  }, 2, 5000);\n}\n","import { Meteor } from 'meteor/meteor';\nexport const SEND_APP = \"send\";\nexport const CONFIRM_APP = \"confirm\";\nexport const VERIFY_APP = \"verify\";\nexport function isAppType(type) {\n  if(Meteor.settings === undefined || Meteor.settings.app === undefined) throw \"No settings found!\"\n  const types = Meteor.settings.app.types;\n  if(types !== undefined) return types.includes(type);\n  return false;\n}\n","import { Accounts } from 'meteor/accounts-base';\nAccounts.config({\n    sendVerificationEmail: true,\n    forbidClientAccountCreation: false\n});\n\n\n\nAccounts.emailTemplates.from='doichain@le-space.de';","import { Api, DOI_WALLETNOTIFY_ROUTE, DOI_CONFIRMATION_ROUTE } from '../rest.js';\nimport confirmOptIn from '../../../../imports/modules/server/opt-ins/confirm.js'\nimport checkNewTransaction from \"../../../../imports/modules/server/doichain/check_new_transactions\";\nimport {logConfirm} from \"../../../../imports/startup/server/log-configuration\";\n//doku of meteor-restivus https://github.com/kahmali/meteor-restivus\nApi.addRoute(DOI_CONFIRMATION_ROUTE+'/:hash', {authRequired: false}, {\n  get: {\n    action: function() {\n      const hash = this.urlParams.hash;\n      try {\n        let ip = this.request.headers['x-forwarded-for'] ||\n          this.request.connection.remoteAddress ||\n          this.request.socket.remoteAddress ||\n          (this.request.connection.socket ? this.request.connection.socket.remoteAddress: null);\n\n          if(ip.indexOf(',')!=-1)ip=ip.substring(0,ip.indexOf(','));\n\n          logConfirm('REST opt-in/confirm :',{hash:hash, host:ip});\n          const redirect = confirmOptIn({host: ip, hash: hash});\n\n        return {\n          statusCode: 303,\n          headers: {'Content-Type': 'text/plain', 'Location': redirect},\n          body: 'Location: '+redirect\n        };\n      } catch(error) {\n        return {statusCode: 500, body: {status: 'fail', message: error.message}};\n      }\n    }\n  }\n});\n\nApi.addRoute(DOI_WALLETNOTIFY_ROUTE, {\n    get: {\n        authRequired: false,\n        action: function() {\n            const params = this.queryParams;\n            const txid = params.tx;\n\n            try {\n                checkNewTransaction(txid);\n                return {status: 'success',  data:'txid:'+txid+' was read from blockchain'};\n            } catch(error) {\n                return {status: 'fail', error: error.message};\n            }\n        }\n    }\n});\n","import { Api } from '../rest.js';\nApi.addRoute('debug/mail', {authRequired: false}, {\n  get: {\n    action: function() {\n      const data = {\n        \"from\": \"noreply@doichain.org\",\n        \"subject\": \"Doichain.org Newsletter BestÃ¤tigung\",\n        \"redirect\": \"https://www.doichain.org/vielen-dank/\",\n        \"returnPath\": \"noreply@doichain.org\",\n        \"content\":\"<style type='text/css' media='screen'>\\n\" +\n            \"* {\\n\" +\n            \"\\tline-height: inherit;\\n\" +\n            \"}\\n\" +\n            \".ExternalClass * {\\n\" +\n            \"\\tline-height: 100%;\\n\" +\n            \"}\\n\" +\n            \"body, p {\\n\" +\n            \"\\tmargin: 0;\\n\" +\n            \"\\tpadding: 0;\\n\" +\n            \"\\tmargin-bottom: 0;\\n\" +\n            \"\\t-webkit-text-size-adjust: none;\\n\" +\n            \"\\t-ms-text-size-adjust: none;\\n\" +\n            \"}\\n\" +\n            \"img {\\n\" +\n            \"\\tline-height: 100%;\\n\" +\n            \"\\toutline: none;\\n\" +\n            \"\\ttext-decoration: none;\\n\" +\n            \"\\t-ms-interpolation-mode: bicubic;\\n\" +\n            \"}\\n\" +\n            \"a img {\\n\" +\n            \"\\tborder: none;\\n\" +\n            \"}\\n\" +\n            \"#backgroundTable {\\n\" +\n            \"\\tmargin: 0;\\n\" +\n            \"\\tpadding: 0;\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"a, a:link, .no-detect-local a, .appleLinks a {\\n\" +\n            \"\\tcolor: #5555ff !important;\\n\" +\n            \"\\ttext-decoration: underline;\\n\" +\n            \"}\\n\" +\n            \".ExternalClass {\\n\" +\n            \"\\tdisplay: block !important;\\n\" +\n            \"\\twidth: 100%;\\n\" +\n            \"}\\n\" +\n            \".ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div {\\n\" +\n            \"\\tline-height: inherit;\\n\" +\n            \"}\\n\" +\n            \"table td {\\n\" +\n            \"\\tborder-collapse: collapse;\\n\" +\n            \"\\tmso-table-lspace: 0pt;\\n\" +\n            \"\\tmso-table-rspace: 0pt;\\n\" +\n            \"}\\n\" +\n            \"sup {\\n\" +\n            \"\\tposition: relative;\\n\" +\n            \"\\ttop: 4px;\\n\" +\n            \"\\tline-height: 7px !important;\\n\" +\n            \"\\tfont-size: 11px !important;\\n\" +\n            \"}\\n\" +\n            \".mobile_link a[href^='tel'], .mobile_link a[href^='sms'] {\\n\" +\n            \"\\ttext-decoration: default;\\n\" +\n            \"\\tcolor: #5555ff !important;\\n\" +\n            \"\\tpointer-events: auto;\\n\" +\n            \"\\tcursor: default;\\n\" +\n            \"}\\n\" +\n            \".no-detect a {\\n\" +\n            \"\\ttext-decoration: none;\\n\" +\n            \"\\tcolor: #5555ff;\\n\" +\n            \"\\tpointer-events: auto;\\n\" +\n            \"\\tcursor: default;\\n\" +\n            \"}\\n\" +\n            \"{\\n\" +\n            \"color: #5555ff;\\n\" +\n            \"}\\n\" +\n            \"span {\\n\" +\n            \"\\tcolor: inherit;\\n\" +\n            \"\\tborder-bottom: none;\\n\" +\n            \"}\\n\" +\n            \"span:hover {\\n\" +\n            \"\\tbackground-color: transparent;\\n\" +\n            \"}\\n\" +\n            \".nounderline {\\n\" +\n            \"\\ttext-decoration: none !important;\\n\" +\n            \"}\\n\" +\n            \"h1, h2, h3 {\\n\" +\n            \"\\tmargin: 0;\\n\" +\n            \"\\tpadding: 0;\\n\" +\n            \"}\\n\" +\n            \"p {\\n\" +\n            \"\\tMargin: 0px !important;\\n\" +\n            \"}\\n\" +\n            \"table[class='email-root-wrapper'] {\\n\" +\n            \"\\twidth: 600px !important;\\n\" +\n            \"}\\n\" +\n            \"body {\\n\" +\n            \"}\\n\" +\n            \"body {\\n\" +\n            \"\\tmin-width: 280px;\\n\" +\n            \"\\twidth: 100%;\\n\" +\n            \"}\\n\" +\n            \"td[class='pattern'] .c112p20r {\\n\" +\n            \"\\twidth: 20%;\\n\" +\n            \"}\\n\" +\n            \"td[class='pattern'] .c336p60r {\\n\" +\n            \"\\twidth: 60.000000000000256%;\\n\" +\n            \"}\\n\" +\n            \"</style>\\n\" +\n            \"<style>\\n\" +\n            \"@media only screen and (max-width: 599px), only screen and (max-device-width: 599px), only screen and (max-width: 400px), only screen and (max-device-width: 400px) {\\n\" +\n            \".email-root-wrapper {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \".full-width {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\theight: auto !important;\\n\" +\n            \"\\ttext-align: center;\\n\" +\n            \"}\\n\" +\n            \".fullwidthhalfleft {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \".fullwidthhalfright {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \".fullwidthhalfinner {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\tmargin: 0 auto !important;\\n\" +\n            \"\\tfloat: none !important;\\n\" +\n            \"\\tmargin-left: auto !important;\\n\" +\n            \"\\tmargin-right: auto !important;\\n\" +\n            \"\\tclear: both !important;\\n\" +\n            \"}\\n\" +\n            \".hide {\\n\" +\n            \"\\tdisplay: none !important;\\n\" +\n            \"\\twidth: 0px !important;\\n\" +\n            \"\\theight: 0px !important;\\n\" +\n            \"\\toverflow: hidden;\\n\" +\n            \"}\\n\" +\n            \".desktop-hide {\\n\" +\n            \"\\tdisplay: block !important;\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\theight: auto !important;\\n\" +\n            \"\\toverflow: hidden;\\n\" +\n            \"\\tmax-height: inherit !important;\\n\" +\n            \"}\\n\" +\n            \".c112p20r {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\tfloat: none;\\n\" +\n            \"}\\n\" +\n            \".c336p60r {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\tfloat: none;\\n\" +\n            \"}\\n\" +\n            \"}\\n\" +\n            \"</style>\\n\" +\n            \"<style>\\n\" +\n            \"@media only screen and (min-width: 600px) {\\n\" +\n            \"td[class='pattern'] .c112p20r {\\n\" +\n            \"\\twidth: 112px !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='pattern'] .c336p60r {\\n\" +\n            \"\\twidth: 336px !important;\\n\" +\n            \"}\\n\" +\n            \"}\\n\" +\n            \"\\n\" +\n            \"@media only screen and (max-width: 599px), only screen and (max-device-width: 599px), only screen and (max-width: 400px), only screen and (max-device-width: 400px) {\\n\" +\n            \"table[class='email-root-wrapper'] {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='wrap'] .full-width {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\theight: auto !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='wrap'] .fullwidthhalfleft {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='wrap'] .fullwidthhalfright {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='wrap'] .fullwidthhalfinner {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"\\tmargin: 0 auto !important;\\n\" +\n            \"\\tfloat: none !important;\\n\" +\n            \"\\tmargin-left: auto !important;\\n\" +\n            \"\\tmargin-right: auto !important;\\n\" +\n            \"\\tclear: both !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='wrap'] .hide {\\n\" +\n            \"\\tdisplay: none !important;\\n\" +\n            \"\\twidth: 0px;\\n\" +\n            \"\\theight: 0px;\\n\" +\n            \"\\toverflow: hidden;\\n\" +\n            \"}\\n\" +\n            \"td[class='pattern'] .c112p20r {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"td[class='pattern'] .c336p60r {\\n\" +\n            \"\\twidth: 100% !important;\\n\" +\n            \"}\\n\" +\n            \"}\\n\" +\n            \"\\n\" +\n            \"@media yahoo {\\n\" +\n            \"table {\\n\" +\n            \"\\tfloat: none !important;\\n\" +\n            \"\\theight: auto;\\n\" +\n            \"}\\n\" +\n            \"table[align='left'] {\\n\" +\n            \"\\tfloat: left !important;\\n\" +\n            \"}\\n\" +\n            \"td[align='left'] {\\n\" +\n            \"\\tfloat: left !important;\\n\" +\n            \"\\theight: auto;\\n\" +\n            \"}\\n\" +\n            \"table[align='center'] {\\n\" +\n            \"\\tmargin: 0 auto;\\n\" +\n            \"}\\n\" +\n            \"td[align='center'] {\\n\" +\n            \"\\tmargin: 0 auto;\\n\" +\n            \"\\theight: auto;\\n\" +\n            \"}\\n\" +\n            \"table[align='right'] {\\n\" +\n            \"\\tfloat: right !important;\\n\" +\n            \"}\\n\" +\n            \"td[align='right'] {\\n\" +\n            \"\\tfloat: right !important;\\n\" +\n            \"\\theight: auto;\\n\" +\n            \"}\\n\" +\n            \"}\\n\" +\n            \"</style>\\n\" +\n            \"\\n\" +\n            \"<!--[if (gte IE 7) & (vml)]>\\n\" +\n            \"<style type='text/css'>\\n\" +\n            \"html, body {margin:0 !important; padding:0px !important;}\\n\" +\n            \"img.full-width { position: relative !important; }\\n\" +\n            \"\\n\" +\n            \".img240x30 { width: 240px !important; height: 30px !important;}\\n\" +\n            \".img20x20 { width: 20px !important; height: 20px !important;}\\n\" +\n            \"\\n\" +\n            \"</style>\\n\" +\n            \"<![endif]-->\\n\" +\n            \"\\n\" +\n            \"<!--[if gte mso 9]>\\n\" +\n            \"<style type='text/css'>\\n\" +\n            \".mso-font-fix-arial { font-family: Arial, sans-serif;}\\n\" +\n            \".mso-font-fix-georgia { font-family: Georgia, sans-serif;}\\n\" +\n            \".mso-font-fix-tahoma { font-family: Tahoma, sans-serif;}\\n\" +\n            \".mso-font-fix-times_new_roman { font-family: 'Times New Roman', sans-serif;}\\n\" +\n            \".mso-font-fix-trebuchet_ms { font-family: 'Trebuchet MS', sans-serif;}\\n\" +\n            \".mso-font-fix-verdana { font-family: Verdana, sans-serif;}\\n\" +\n            \"</style>\\n\" +\n            \"<![endif]-->\\n\" +\n            \"\\n\" +\n            \"<!--[if gte mso 9]>\\n\" +\n            \"<style type='text/css'>\\n\" +\n            \"table, td {\\n\" +\n            \"border-collapse: collapse !important;\\n\" +\n            \"mso-table-lspace: 0px !important;\\n\" +\n            \"mso-table-rspace: 0px !important;\\n\" +\n            \"}\\n\" +\n            \"\\n\" +\n            \".email-root-wrapper { width 600px !important;}\\n\" +\n            \".imglink { font-size: 0px; }\\n\" +\n            \".edm_button { font-size: 0px; }\\n\" +\n            \"</style>\\n\" +\n            \"<![endif]-->\\n\" +\n            \"\\n\" +\n            \"<!--[if gte mso 15]>\\n\" +\n            \"<style type='text/css'>\\n\" +\n            \"table {\\n\" +\n            \"font-size:0px;\\n\" +\n            \"mso-margin-top-alt:0px;\\n\" +\n            \"}\\n\" +\n            \"\\n\" +\n            \".fullwidthhalfleft {\\n\" +\n            \"width: 49% !important;\\n\" +\n            \"float:left !important;\\n\" +\n            \"}\\n\" +\n            \"\\n\" +\n            \".fullwidthhalfright {\\n\" +\n            \"width: 50% !important;\\n\" +\n            \"float:right !important;\\n\" +\n            \"}\\n\" +\n            \"</style>\\n\" +\n            \"<![endif]-->\\n\" +\n            \"<style type='text/css' media='(pointer) and (min-color-index:0)'>\\n\" +\n            \"html, body {\\n\" +\n            \"\\tbackground-image: none !important;\\n\" +\n            \"\\tbackground-color: #ebebeb !important;\\n\" +\n            \"\\tmargin: 0 !important;\\n\" +\n            \"\\tpadding: 0 !important;\\n\" +\n            \"}\\n\" +\n            \"</style>\\n\" +\n            \"</head>\\n\" +\n            \"<body leftmargin='0' marginwidth='0' topmargin='0' marginheight='0' offset='0' background=\\\"\\\" bgcolor='#ebebeb' style='font-family:Arial, sans-serif; font-size:0px;margin:0;padding:0; '>\\n\" +\n            \"<!--[if t]><![endif]--><!--[if t]><![endif]--><!--[if t]><![endif]--><!--[if t]><![endif]--><!--[if t]><![endif]--><!--[if t]><![endif]-->\\n\" +\n            \"<table align='center' border='0' cellpadding='0' cellspacing='0' background=\\\"\\\"  height='100%' width='100%' id='backgroundTable'>\\n\" +\n            \"  <tr>\\n\" +\n            \"    <td class='wrap' align='center' valign='top' width='100%'>\\n\" +\n            \"\\t\\t<center>\\n\" +\n            \"        <!-- content -->\\n\" +\n            \"        \\t<div style='padding: 0px;'>\\n\" +\n            \"        \\t  <table cellpadding='0' cellspacing='0' border='0' width='100%' bgcolor='#ebebeb'>\\n\" +\n            \"           \\t\\t <tr>\\n\" +\n            \"            \\t\\t  <td valign='top' style='padding: 0px;'>\\n\" +\n            \"\\t\\t\\t\\t\\t\\t  <table cellpadding='0' cellspacing='0' width='600' align='center' style='max-width: 600px;min-width: 240px;margin: 0 auto;' class='email-root-wrapper'>\\n\" +\n            \"                 \\t\\t \\t\\t<tr>\\n\" +\n            \"                   \\t\\t\\t\\t\\t <td valign='top' style='padding: 0px;'>\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t \\t\\t<table cellpadding='0' cellspacing='0' border='0' width='100%' bgcolor='#FFFFFF' style='border: 0px none;background-color: #FFFFFF;'>\\n\" +\n            \"                       \\t\\t\\t\\t\\t\\t <tr>\\n\" +\n            \"                       \\t\\t\\t  \\t\\t\\t\\t <td valign='top' style='padding-top: 30px;padding-right: 20px;padding-bottom: 35px;padding-left: 20px;'>\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t\\t   \\t\\t\\t\\t\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<table cellpadding='0'\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tcellspacing='0' border='0' align='center' width='240'  style='border: 0px none;height: auto;' class='full-width'>\\n\" +\n            \"                                         \\t \\t\\t\\t\\t\\t\\t\\t\\t\\t<tr>\\n\" +\n            \"                                            \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<td valign='top' style='padding: 0px;'><img src='https://sf26.sendsfx.com/admin/temp/user/17/doichain_100h.png' width='240' height='30' alt=\\\"\\\" border='0' style='display: block;width: 100%;height: auto;' class='full-width img240x30' /></td>\\n\" +\n            \"                                         \\t \\t\\t\\t\\t\\t\\t\\t\\t\\t</tr>\\n\" +\n            \"                                        \\t\\t\\t\\t\\t\\t\\t\\t\\t</table>\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</td>\\n\" +\n            \"                      \\t\\t  \\t\\t\\t\\t</tr>\\n\" +\n            \"                      \\t\\t\\t\\t\\t</table>\\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t \\n\" +\n            \"\\t\\t\\t\\t\\t\\t\\t\\t \\n\" +\n            \"                      <table cellpadding='0' cellspacing='0' border='0' width='100%' bgcolor='#0071aa' style='border: 0px none;background-color: #0071aa;background-image: url('https://sf26.sendsfx.com/admin/temp/user/17/blue-bg.jpg');background-repeat: no-repeat ;background-position: center;'>\\n\" +\n            \"                        <tr>\\n\" +\n            \"                          <td valign='top' style='padding-top: 40px;padding-right: 20px;padding-bottom: 45px;padding-left: 20px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                              <tr>\\n\" +\n            \"                                <td style='padding: 0px;' class='pattern'><table cellpadding='0' cellspacing='0' border='0' width='100%'>\\n\" +\n            \"                                    <tr>\\n\" +\n            \"                                      <td valign='top' style='padding-bottom: 10px;'><div style='text-align: left;font-family: arial;font-size: 20px;color: #ffffff;line-height: 30px;mso-line-height: exactly;mso-text-raise: 5px;'>\\n\" +\n            \"                                          <p\\n\" +\n            \"style='padding: 0; margin: 0;text-align: center;'>Bitte bestÃ¤tigen Sie Ihre Anmeldung</p>\\n\" +\n            \"                                        </div></td>\\n\" +\n            \"                                    </tr>\\n\" +\n            \"                                  </table>\\n\" +\n            \"                                  <table cellpadding='0' cellspacing='0' border='0' width='100%'>\\n\" +\n            \"                                    <tr>\\n\" +\n            \"                                      <td valign='top' style='padding: 0;mso-cellspacing: 0in;'><table cellpadding='0' cellspacing='0' border='0' align='left' width='112'  style='float: left;' class='c112p20r'>\\n\" +\n            \"                                          <tr>\\n\" +\n            \"                                            <td valign='top' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' width='100%' style='border: 0px none;' class='hide'>\\n\" +\n            \"                                                <tr>\\n\" +\n            \"                                                  <td valign='top' style='padding: 0px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                      <tr>\\n\" +\n            \"                                                        <td style='padding: 0px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                            <tr>\\n\" +\n            \"                                                              <td align='center' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' align='center' width='20'  style='border: 0px none;height: auto;'>\\n\" +\n            \"                                                                  <tr>\\n\" +\n            \"                                                                    <td valign='top' style='padding: 0px;'><img\\n\" +\n            \"src='https://sf26.sendsfx.com/admin/temp/user/17/img_89837318.png' width='20' height='20' alt=\\\"\\\" border='0' style='display: block;' class='img20x20' /></td>\\n\" +\n            \"                                                                  </tr>\\n\" +\n            \"                                                                </table></td>\\n\" +\n            \"                                                            </tr>\\n\" +\n            \"                                                          </table></td>\\n\" +\n            \"                                                      </tr>\\n\" +\n            \"                                                    </table></td>\\n\" +\n            \"                                                </tr>\\n\" +\n            \"                                              </table></td>\\n\" +\n            \"                                          </tr>\\n\" +\n            \"                                        </table>\\n\" +\n            \"                                        \\n\" +\n            \"                                        <!--[if gte mso 9]></td><td valign='top' style='padding:0;'><![endif]-->\\n\" +\n            \"                                        \\n\" +\n            \"                                        <table cellpadding='0' cellspacing='0' border='0' align='left' width='336'  style='float: left;' class='c336p60r'>\\n\" +\n            \"                                          <tr>\\n\" +\n            \"                                            <td valign='top' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' width='100%'>\\n\" +\n            \"                                                <tr>\\n\" +\n            \"                                                  <td valign='top' style='padding-bottom: 30px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                      <tr>\\n\" +\n            \"                                                        <td style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' width='100%' style='border-top: 2px solid #ffffff;'>\\n\" +\n            \"                                                            <tr>\\n\" +\n            \"                                                              <td valign='top'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                                  <tr>\\n\" +\n            \"                                                                    <td style='padding: 0px;'></td>\\n\" +\n            \"                                                                  </tr>\\n\" +\n            \"                                                                </table></td>\\n\" +\n            \"                                                            </tr>\\n\" +\n            \"                                                          </table></td>\\n\" +\n            \"                                                      </tr>\\n\" +\n            \"                                                    </table></td>\\n\" +\n            \"                                                </tr>\\n\" +\n            \"                                              </table></td>\\n\" +\n            \"                                          </tr>\\n\" +\n            \"                                        </table>\\n\" +\n            \"                                        \\n\" +\n            \"                                        <!--[if gte mso 9]></td><td valign='top' style='padding:0;'><![endif]-->\\n\" +\n            \"                                        \\n\" +\n            \"                                        <table cellpadding='0' cellspacing='0' border='0' align='left' width='112'  style='float: left;' class='c112p20r'>\\n\" +\n            \"                                          <tr>\\n\" +\n            \"                                            <td valign='top' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' width='100%' style='border: 0px none;' class='hide'>\\n\" +\n            \"                                                <tr>\\n\" +\n            \"                                                  <td valign='top' style='padding: 0px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                      <tr>\\n\" +\n            \"                                                        <td style='padding: 0px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                                            <tr>\\n\" +\n            \"                                                              <td align='center' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' align='center' width='20'  style='border: 0px none;height: auto;'>\\n\" +\n            \"                                                                  <tr>\\n\" +\n            \"                                                                    <td valign='top' style='padding: 0px;'><img src='https://sf26.sendsfx.com/admin/temp/user/17/img_89837318.png' width='20' height='20' alt=\\\"\\\" border='0' style='display: block;' class='img20x20'\\n\" +\n            \"/></td>\\n\" +\n            \"                                                                  </tr>\\n\" +\n            \"                                                                </table></td>\\n\" +\n            \"                                                            </tr>\\n\" +\n            \"                                                          </table></td>\\n\" +\n            \"                                                      </tr>\\n\" +\n            \"                                                    </table></td>\\n\" +\n            \"                                                </tr>\\n\" +\n            \"                                              </table></td>\\n\" +\n            \"                                          </tr>\\n\" +\n            \"                                        </table></td>\\n\" +\n            \"                                    </tr>\\n\" +\n            \"                                  </table>\\n\" +\n            \"                                  <table cellpadding='0' cellspacing='0' border='0' width='100%'>\\n\" +\n            \"                                    <tr>\\n\" +\n            \"                                      <td valign='top' style='padding-bottom: 20px;'><div style='text-align: left;font-family: arial;font-size: 16px;color: #ffffff;line-height: 26px;mso-line-height: exactly;mso-text-raise: 5px;'>\\n\" +\n            \"                                          <p style='padding: 0; margin: 0;text-align: center;'>Vielen Dank, dass Sie sich fÃ¼r unseren Newsletter angemeldet haben.</p>\\n\" +\n            \"                                          <p style='padding: 0; margin: 0;text-align: center;'>Um diese E-Mail-Adresse und Ihre kostenlose Anmeldung zu bestÃ¤tigen, klicken Sie bitte jetzt auf den folgenden Button:</p>\\n\" +\n            \"                                        </div></td>\\n\" +\n            \"                                    </tr>\\n\" +\n            \"                                  </table>\\n\" +\n            \"                                  <table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                                    <tr>\\n\" +\n            \"                                      <td align='center' style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' align='center' style='text-align: center;color: #000;' class='full-width'>\\n\" +\n            \"                                          <tr>\\n\" +\n            \"                                            <td valign='top' align='center' style='padding-right: 10px;padding-bottom: 30px;padding-left: 10px;'><table cellpadding='0' cellspacing='0' border='0' bgcolor='#85ac1c' style='border: 0px none;border-radius: 5px;border-collapse: separate !important;background-color: #85ac1c;' class='full-width'>\\n\" +\n            \"                                                <tr>\\n\" +\n            \"                                                  <td valign='top' align='center' style='padding: 12px;'><a href='${confirmation_url}' target='_blank' style='text-decoration: none;' class='edm_button'><span style='font-family: arial;font-size: 18px;color: #ffffff;line-height: 28px;text-decoration: none;'><span\\n\" +\n            \"style='font-size: 18px;'>Jetzt Anmeldung best&auml;tigen</span></span> </a></td>\\n\" +\n            \"                                                </tr>\\n\" +\n            \"                                              </table></td>\\n\" +\n            \"                                          </tr>\\n\" +\n            \"                                        </table></td>\\n\" +\n            \"                                    </tr>\\n\" +\n            \"                                  </table>\\n\" +\n            \"                                  <div style='text-align: left;font-family: arial;font-size: 12px;color: #ffffff;line-height: 22px;mso-line-height: exactly;mso-text-raise: 5px;'>\\n\" +\n            \"                                    <p style='padding: 0; margin: 0;text-align: center;'>Wenn Sie ihre E-Mail-Adresse nicht bestÃ¤tigen, kÃ¶nnen keine Newsletter zugestellt werden. Ihr EinverstÃ¤ndnis kÃ¶nnen Sie selbstverstÃ¤ndlich jederzeit widerrufen. Sollte es sich bei der Anmeldung um ein Versehen handeln oder wurde der Newsletter nicht in Ihrem Namen bestellt, kÃ¶nnen Sie diese E-Mail einfach ignorieren. Ihnen werden keine weiteren Nachrichten zugeschickt.</p>\\n\" +\n            \"                                  </div></td>\\n\" +\n            \"                              </tr>\\n\" +\n            \"                            </table></td>\\n\" +\n            \"                        </tr>\\n\" +\n            \"                      </table>\\n\" +\n            \"                      <table cellpadding='0' cellspacing='0' border='0' width='100%' bgcolor='#ffffff' style='border: 0px none;background-color: #ffffff;'>\\n\" +\n            \"                        <tr>\\n\" +\n            \"                          <td valign='top' style='padding-top: 30px;padding-right: 20px;padding-bottom: 35px;padding-left: 20px;'><table cellpadding='0' cellspacing='0' width='100%'>\\n\" +\n            \"                              <tr>\\n\" +\n            \"                                <td style='padding: 0px;'><table cellpadding='0' cellspacing='0' border='0' width='100%'>\\n\" +\n            \"                                    <tr>\\n\" +\n            \"                                      <td valign='top' style='padding-bottom: 25px;'><div style='text-align: left;font-family: arial;font-size: 12px;color: #333333;line-height: 22px;mso-line-height: exactly;mso-text-raise: 5px;'>\\n\" +\n            \"                                          <p style='padding: 0; margin: 0;text-align: center;'><span style='line-height: 3;'><strong>Kontakt</strong></span><br>\\n\" +\n            \"                                            service@sendeffect.de<br>\\n\" +\n            \"                                            www.sendeffect.de<br>\\n\" +\n            \"                                            Telefon: +49 (0) 8571 - 97 39 - 69-0</p>\\n\" +\n            \"                                        </div></td>\\n\" +\n            \"                                    </tr>\\n\" +\n            \"                                  </table>\\n\" +\n            \"                                  <div style='text-align: left;font-family: arial;font-size: 12px;color: #333333;line-height: 22px;mso-line-height: exactly;mso-text-raise: 5px;'>\\n\" +\n            \"                                    <p style='padding: 0; margin: 0;text-align: center;'><span style='line-height: 3;'><strong>Impressum</strong></span><br>\\n\" +\n            \"                                      Anschrift: Schulgasse 5, D-84359 Simbach am Inn, eMail: service@sendeffect.de<br>\\n\" +\n            \"                                      Betreiber: WEBanizer AG, Registergericht: Amtsgericht Landshut HRB 5177, UstId.: DE 2068 62 070<br>\\n\" +\n            \"                                      Vorstand: Ottmar Neuburger, Aufsichtsrat: Tobias Neuburger</p>\\n\" +\n            \"                                  </div></td>\\n\" +\n            \"                              </tr>\\n\" +\n            \"                            </table></td>\\n\" +\n            \"                        </tr>\\n\" +\n            \"                      </table></td>\\n\" +\n            \"                  </tr>\\n\" +\n            \"                </table></td>\\n\" +\n            \"            </tr>\\n\" +\n            \"          </table>\\n\" +\n            \"        </div>\\n\" +\n            \"        <!-- content end -->\\n\" +\n            \"      </center></td>\\n\" +\n            \"  </tr>\\n\" +\n            \"</table>\"\n      }\n\n      return {\"status\": \"success\", \"data\": data};\n    }\n  }\n});\n","import { Api, DOI_FETCH_ROUTE, DOI_CONFIRMATION_NOTIFY_ROUTE } from '../rest.js';\nimport addOptIn from '../../../../imports/modules/server/opt-ins/add_and_write_to_blockchain.js';\nimport updateOptInStatus from '../../../../imports/modules/server/opt-ins/update_status.js';\nimport getDoiMailData from '../../../../imports/modules/server/dapps/get_doi-mail-data.js';\nimport {logError, logSend} from \"../../../../imports/startup/server/log-configuration\";\nimport {DOI_EXPORT_ROUTE} from \"../rest\";\nimport exportDois from \"../../../../imports/modules/server/dapps/export_dois\";\nimport {OptIns} from \"../../../../imports/api/opt-ins/opt-ins\";\nimport {Roles} from \"meteor/alanning:roles\";\n\n//doku of meteor-restivus https://github.com/kahmali/meteor-restivus\n\nApi.addRoute(DOI_CONFIRMATION_NOTIFY_ROUTE, {\n  post: {\n    authRequired: true,\n    //roleRequired: ['admin'],\n    action: function() {\n      const qParams = this.queryParams;\n      const bParams = this.bodyParams;\n      let params = {}\n      if(qParams !== undefined) params = {...qParams}\n      if(bParams !== undefined) params = {...params, ...bParams}\n\n      const uid = this.userId;\n\n      if(!Roles.userIsInRole(uid, 'admin') || //if its not an admin always use uid as ownerId\n          (Roles.userIsInRole(uid, 'admin') && (params[\"ownerId\"]==null || params[\"ownerId\"]==undefined))) {  //if its an admin only use uid in case no ownerId was given\n          params[\"ownerId\"] = uid;\n      }\n\n      logSend('parameter received from browser:',params);\n      if(params.sender_mail.constructor === Array){ //this is a SOI with co-sponsors first email is main sponsor\n          return prepareCoDOI(params);\n      }else{\n         return prepareAdd(params);\n      }\n    }\n  },\n  put: {\n    authRequired: false,\n    action: function() {\n      const qParams = this.queryParams;\n      const bParams = this.bodyParams;\n\n      logSend('qParams:',qParams);\n      logSend('bParams:',bParams);\n\n      let params = {}\n      if(qParams !== undefined) params = {...qParams}\n      if(bParams !== undefined) params = {...params, ...bParams}\n      try {\n        const val = updateOptInStatus(params);\n        logSend('opt-In status updated',val);\n        return {status: 'success', data: {message: 'Opt-In status updated'}};\n      } catch(error) {\n        return {statusCode: 500, body: {status: 'fail', message: error.message}};\n      }\n    }\n  }\n});\n\nApi.addRoute(DOI_FETCH_ROUTE, {authRequired: false}, {\n  get: {\n    action: function() {\n      const params = this.queryParams;\n      try {\n          logSend('rest api - DOI_FETCH_ROUTE called by bob to request email template',JSON.stringify(params));\n          const data = getDoiMailData(params);\n          logSend('got doi-mail-data (including templalte) returning to bob',{subject:data.subject, recipient:data.recipient});\n        return {status: 'success', data};\n      } catch(error) {\n        logError('error while getting DoiMailData',error);\n        return {status: 'fail', error: error.message};\n      }\n    }\n  }\n});\n\nApi.addRoute(DOI_EXPORT_ROUTE, {\n    get: {\n        authRequired: true,\n        //roleRequired: ['admin'],\n        action: function() {\n            let params = this.queryParams;\n            const uid = this.userId;\n            if(!Roles.userIsInRole(uid, 'admin')){\n                params = {userid:uid,role:'user'};\n            }\n            else{\n                params = {...params,role:'admin'}\n            }\n            try {\n                logSend('rest api - DOI_EXPORT_ROUTE called',JSON.stringify(params));\n                const data = exportDois(params);\n                logSend('got dois from database',JSON.stringify(data));\n                return {status: 'success', data};\n            } catch(error) {\n                logError('error while exporting confirmed dois',error);\n                return {status: 'fail', error: error.message};\n            }\n        }\n    }\n});\n\nfunction prepareCoDOI(params){\n\n    logSend('is array ',params.sender_mail);\n\n    const senders = params.sender_mail;\n    const recipient_mail = params.recipient_mail;\n    const data = params.data;\n    const ownerID = params.ownerId;\n\n    let currentOptInId;\n    let retResponse = [];\n    let master_doi;\n    senders.forEach((sender,index) => {\n\n        const ret_response = prepareAdd({sender_mail:sender,recipient_mail:recipient_mail,data:data, master_doi:master_doi, index: index, ownerId:ownerID});\n        logSend('CoDOI:',ret_response);\n        if(ret_response.status === undefined || ret_response.status===\"failed\") throw \"could not add co-opt-in\";\n        retResponse.push(ret_response);\n        currentOptInId = ret_response.data.id;\n\n        if(index===0)\n        {\n            logSend('main sponsor optInId:',currentOptInId);\n            const optIn = OptIns.findOne({_id: currentOptInId});\n            master_doi = optIn.nameId;\n            logSend('main sponsor nameId:',master_doi);\n        }\n\n    });\n\n    logSend(retResponse);\n\n    return retResponse;\n}\n\nfunction prepareAdd(params){\n\n    try {\n        const val = addOptIn(params);\n        logSend('opt-In added ID:',val);\n        return {status: 'success', data: {id: val, status: 'success', message: 'Opt-In added.'}};\n    } catch(error) {\n        return {statusCode: 500, body: {status: 'fail', message: error.message}};\n    }\n}","import { Api } from '../rest.js';\nimport {Meteor} from 'meteor/meteor';\nimport {Accounts} from 'meteor/accounts-base'\nimport SimpleSchema from 'simpl-schema';\nimport {Roles} from \"meteor/alanning:roles\";\nimport {logMain} from \"../../../../imports/startup/server/log-configuration\";\n\nconst mailTemplateSchema = new SimpleSchema({\n    subject: {\n        type: String,\n        optional:true \n    },\n    redirect: {\n        type: String,\n        regEx: \"@(https?|ftp)://(-\\\\.)?([^\\\\s/?\\\\.#-]+\\\\.?)+(/[^\\\\s]*)?$@\",\n        optional:true \n    },\n    returnPath: {\n        type: String,\n        regEx: SimpleSchema.RegEx.Email,\n        optional:true \n    },\n    templateURL:{\n        type: String,\n        regEx: \"@(https?|ftp)://(-\\\\.)?([^\\\\s/?\\\\.#-]+\\\\.?)+(/[^\\\\s]*)?$@\",\n        optional:true \n    }\n});\n\nconst createUserSchema = new SimpleSchema({\n    username: {\n      type: String,\n      regEx: \"^[A-Z,a-z,0-9,!,_,$,#]{4,24}$\"  //Only usernames between 4-24 characters from A-Z,a-z,0-9,!,_,$,# allowed\n    },\n    email: {\n      type: String,\n      regEx: SimpleSchema.RegEx.Email\n    },\n    password: {\n      type: String,\n      regEx: \"^[A-Z,a-z,0-9,!,_,$,#]{8,24}$\" //Only passwords between 8-24 characters from A-Z,a-z,0-9,!,_,$,# allowed\n    },\n    mailTemplate:{\n        type: mailTemplateSchema,\n        optional:true \n    }\n  });\n  const updateUserSchema = new SimpleSchema({\n    mailTemplate:{\n        type: mailTemplateSchema\n    }\n});\n\n//TODO: collection options separate\nconst collectionOptions =\n  {\n    path:\"users\",\n    routeOptions:\n    {\n        authRequired : true\n        //,roleRequired : \"admin\"\n    },\n    excludedEndpoints: ['patch','deleteAll'],\n    endpoints:\n    {\n        delete:{roleRequired : \"admin\"},\n        post:\n        {\n            roleRequired : \"admin\",\n            action: function(){\n                const qParams = this.queryParams;\n                const bParams = this.bodyParams;\n                let params = {};\n                if(qParams !== undefined) params = {...qParams}\n                if(bParams !== undefined) params = {...params, ...bParams}\n                try{\n                    let userId;\n                    createUserSchema.validate(params);\n                    logMain('validated',params);\n                    if(params.mailTemplate !== undefined){\n                        userId = Accounts.createUser({username:params.username,\n                            email:params.email,\n                            password:params.password,\n                            profile:{mailTemplate:params.mailTemplate}});\n                    }\n                    else{\n                        userId = Accounts.createUser({username:params.username,email:params.email,password:params.password, profile:{}});\n                    }    \n                    return {status: 'success', data: {userid: userId}};\n                } catch(error) {\n                  return {statusCode: 400, body: {status: 'fail', message: error.message}};\n                }\n                \n            }\n        },\n        put:\n        {\n            action: function(){      \n                const qParams = this.queryParams;\n                const bParams = this.bodyParams;\n                let params = {};\n                let uid=this.userId;\n                const paramId=this.urlParams.id;\n                if(qParams !== undefined) params = {...qParams}\n                if(bParams !== undefined) params = {...params, ...bParams}\n\n                try{ //TODO this is not necessary here and can probably go right into the definition of the REST METHOD next to put (!?!)\n                    if(!Roles.userIsInRole(uid, 'admin')){\n                        if(uid!==paramId){\n                            throw Error(\"No Permission\");\n                        }\n                    }\n                    updateUserSchema.validate(params);\n                    if(!Meteor.users.update(this.urlParams.id,{$set:{\"profile.mailTemplate\":params.mailTemplate}})){\n                        throw Error(\"Failed to update user\");\n                    }\n                    return {status: 'success', data: {userid: this.urlParams.id, mailTemplate:params.mailTemplate}};\n                } catch(error) {\n                  return {statusCode: 400, body: {status: 'fail', message: error.message}};\n                }\n            }\n        }\n    }\n}\nApi.addCollection(Meteor.users,collectionOptions);","import { Api } from '../rest.js';\nimport verifyOptIn from '../../../../imports/modules/server/opt-ins/verify.js';\n\nApi.addRoute('opt-in/verify', {authRequired: true}, {\n  get: {\n    authRequired: false,\n    action: function() {\n        const qParams = this.queryParams;\n        const bParams = this.bodyParams;\n        let params = {}\n        if(qParams !== undefined) params = {...qParams}\n        if(bParams !== undefined) params = {...params, ...bParams}\n\n      try {\n        const val = verifyOptIn(params);\n        return {status: \"success\", data: {val}};\n      } catch(error) {\n        return {statusCode: 500, body: {status: 'fail', message: error.message}};\n      }\n    }\n  }\n});\n","import { Restivus } from 'meteor/nimble:restivus';\nimport { isDebug } from '../../../imports/startup/server/dapp-configuration.js';\nimport { SEND_APP, CONFIRM_APP, VERIFY_APP, isAppType } from '../../../imports/startup/server/type-configuration.js';\n\nexport const DOI_CONFIRMATION_ROUTE = \"opt-in/confirm\";\nexport const DOI_CONFIRMATION_NOTIFY_ROUTE = \"opt-in\";\nexport const DOI_WALLETNOTIFY_ROUTE = \"walletnotify\";\nexport const DOI_FETCH_ROUTE = \"doi-mail\";\nexport const DOI_EXPORT_ROUTE = \"export\";\nexport const USERS_COLLECTION_ROUTE = \"users\"\nexport const API_PATH = \"api/\";\nexport const VERSION = \"v1\";\n\nexport const Api = new Restivus({\n  apiPath: API_PATH,\n  version: VERSION,\n  useDefaultAuth: true,\n  prettyJson: true\n});\n\nif(isDebug()) require('./imports/debug.js');\nif(isAppType(SEND_APP)) require('./imports/send.js');\nif(isAppType(CONFIRM_APP)) require('./imports/confirm.js');\nif(isAppType(VERIFY_APP)) require('./imports/verify.js');\nrequire('./imports/user.js');\n","\nimport { JobCollection,Job } from 'meteor/vsivsi:job-collection';\nexport const BlockchainJobs = JobCollection('blockchain');\nimport { Meteor } from 'meteor/meteor';\nimport insert from '../../imports/modules/server/doichain/insert.js';\nimport update from '../../imports/modules/server/doichain/update.js';\n/* eslint-disable no-unused-vars */ //TODO re-enable this!\nimport checkNewTransaction from '../../imports/modules/server/doichain/check_new_transactions.js';\nimport { CONFIRM_APP, isAppType } from '../../imports/startup/server/type-configuration.js';\nimport {logMain} from \"../../imports/startup/server/log-configuration\";\n\nBlockchainJobs.processJobs('insert', {workTimeout: 30*1000},function (job, cb) {\n  try {\n    const entry = job.data;\n    insert(entry);\n    job.done();\n  } catch(exception) {\n    job.fail();\n\n      throw new Meteor.Error('jobs.blockchain.insert.exception', exception);\n  } finally {\n    cb();\n  }\n});\n\nBlockchainJobs.processJobs('update', {workTimeout: 30*1000},function (job, cb) {\n  try {\n    const entry = job.data;\n    update(entry,job);\n  } catch(exception) {\n    job.fail();\n    throw new Meteor.Error('jobs.blockchain.update.exception', exception);\n  } finally {\n    cb();\n  }\n});\n\nBlockchainJobs.processJobs('checkNewTransaction', {workTimeout: 30*1000},function (job, cb) {\n  try {\n    if(!isAppType(CONFIRM_APP)) {\n      job.pause();\n      job.cancel();\n      job.remove();\n    } else {\n      //checkNewTransaction(null,job);\n    }\n  } catch(exception) {\n    job.fail();\n    throw new Meteor.Error('jobs.blockchain.checkNewTransactions.exception', exception);\n  } finally {\n    cb();\n  }\n});\n\nnew Job(BlockchainJobs, 'cleanup', {})\n    .repeat({ schedule: BlockchainJobs.later.parse.text(\"every 5 minutes\") })\n    .save({cancelRepeats: true});\n\nlet q = BlockchainJobs.processJobs('cleanup',{ pollInterval: false, workTimeout: 60*1000 } ,function (job, cb) {\n  const current = new Date()\n    current.setMinutes(current.getMinutes() - 5);\n\n  const ids = BlockchainJobs.find({\n          status: {$in: Job.jobStatusRemovable},\n          updated: {$lt: current}},\n          {fields: { _id: 1 }});\n\n    logMain('found  removable blockchain jobs:',ids);\n    BlockchainJobs.removeJobs(ids);\n    if(ids.length > 0){\n      job.done(\"Removed #{ids.length} old jobs\");\n    }\n    cb();\n});\n\nBlockchainJobs.find({ type: 'jobType', status: 'ready' })\n    .observe({\n        added: function () { q.trigger(); }\n    });\n","import { JobCollection, Job } from 'meteor/vsivsi:job-collection';\nimport fetchDoiMailData from '../../imports/modules/server/dapps/fetch_doi-mail-data.js';\nimport { Meteor } from 'meteor/meteor';\nimport {logMain} from \"../../imports/startup/server/log-configuration\";\nimport {BlockchainJobs} from \"./blockchain_jobs\";\n\nexport const DAppJobs = JobCollection('dapp');\n\nDAppJobs.processJobs('fetchDoiMailData', function (job, cb) {\n  try {\n    const data = job.data;\n    fetchDoiMailData(data);\n    job.done();\n  } catch(exception) {\n    job.fail();\n    throw new Meteor.Error('jobs.dapp.fetchDoiMailData.exception', exception);\n  } finally {\n    cb();\n  }\n});\n\n\nnew Job(DAppJobs, 'cleanup', {})\n    .repeat({ schedule: DAppJobs.later.parse.text(\"every 5 minutes\") })\n    .save({cancelRepeats: true});\n\nlet q = DAppJobs.processJobs('cleanup',{ pollInterval: false, workTimeout: 60*1000 } ,function (job, cb) {\n    const current = new Date()\n    current.setMinutes(current.getMinutes() - 5);\n\n    const ids = DAppJobs.find({\n            status: {$in: Job.jobStatusRemovable},\n            updated: {$lt: current}},\n        {fields: { _id: 1 }});\n\n    logMain('found  removable blockchain jobs:',ids);\n    DAppJobs.removeJobs(ids);\n    if(ids.length > 0){\n        job.done(\"Removed #{ids.length} old jobs\");\n    }\n    cb();\n});\n\nDAppJobs.find({ type: 'jobType', status: 'ready' })\n    .observe({\n        added: function () { q.trigger(); }\n    });\n","import { Meteor } from 'meteor/meteor';\nimport dns from 'dns';\nimport {logSend} from \"../../imports/startup/server/log-configuration\";\n\nexport function resolveTxt(key, domain) {\n  const syncFunc = Meteor.wrapAsync(dns_resolveTxt);\n  try {\n    const records = syncFunc(key, domain);\n    if(records === undefined) return undefined;\n    let value = undefined;\n    records.forEach(record => {\n      if(record[0].startsWith(key)) {\n        const val = record[0].substring(key.length+1);\n        value = val.trim();\n\n      }\n    });\n    return value;\n  } catch(error) {\n    if(error.message.startsWith(\"queryTxt ENODATA\") ||\n        error.message.startsWith(\"queryTxt ENOTFOUND\")) return undefined;\n    else throw error;\n  }\n}\n\nfunction dns_resolveTxt(key, domain, callback) {\n    logSend(\"resolving dns txt attribute: \", {key:key,domain:domain});\n    dns.resolveTxt(domain, (err, records) => {\n    callback(err, records);\n  });\n}\n","import { Meteor } from 'meteor/meteor';\nimport {logBlockchain, logConfirm, logError} from \"../../imports/startup/server/log-configuration\";\n\n\nconst NAMESPACE = 'e/';\n\n\nexport function getWif(client, address) {\n  if(!address){\n        address = getAddressesByAccount(\"\")[0];\n        logBlockchain('address was not defined so getting the first existing one of the wallet:',address);\n  }\n  if(!address){\n        address = getNewAddress(\"\");\n        logBlockchain('address was never defined  at all generated new address for this wallet:',address);\n  }\n  const syncFunc = Meteor.wrapAsync(doichain_dumpprivkey);\n  return syncFunc(client, address);\n}\n\nfunction doichain_dumpprivkey(client, address, callback) {\n  const ourAddress = address;\n  client.cmd('dumpprivkey', ourAddress, function(err, data) {\n    if(err)  logError('doichain_dumpprivkey:',err);\n    callback(err, data);\n  });\n}\n\nexport function getAddressesByAccount(client, accout) {\n    const syncFunc = Meteor.wrapAsync(doichain_getaddressesbyaccount);\n    return syncFunc(client, accout);\n}\n\nfunction doichain_getaddressesbyaccount(client, account, callback) {\n    const ourAccount = account;\n    client.cmd('getaddressesbyaccount', ourAccount, function(err, data) {\n        if(err)  logError('getaddressesbyaccount:',err);\n        callback(err, data);\n    });\n}\n\nexport function getNewAddress(client, accout) {\n    const syncFunc = Meteor.wrapAsync(doichain_getnewaddress);\n    return syncFunc(client, accout);\n}\nfunction doichain_getnewaddress(client, account, callback) {\n    const ourAccount = account;\n    client.cmd('getnewaddresss', ourAccount, function(err, data) {\n        if(err)  logError('getnewaddresss:',err);\n        callback(err, data);\n    });\n}\n\n\nexport function signMessage(client, address, message) {\n    const syncFunc = Meteor.wrapAsync(doichain_signMessage);\n    return syncFunc(client, address, message);\n}\n\nfunction doichain_signMessage(client, address, message, callback) {\n    const ourAddress = address;\n    const ourMessage = message;\n    client.cmd('signmessage', ourAddress, ourMessage, function(err, data) {\n        callback(err, data);\n    });\n}\n\nexport function nameShow(client, id) {\n  const syncFunc = Meteor.wrapAsync(doichain_nameShow);\n  return syncFunc(client, id);\n}\n\nfunction doichain_nameShow(client, id, callback) {\n  const ourId = checkId(id);\n  logConfirm('doichain-cli name_show :',ourId);\n  client.cmd('name_show', ourId, function(err, data) {\n    if(err !== undefined && err !== null && err.message.startsWith(\"name not found\")) {\n      err = undefined,\n      data = undefined\n    }\n    callback(err, data);\n  });\n}\n\nexport function feeDoi(client, address) {\n    const syncFunc = Meteor.wrapAsync(doichain_feeDoi);\n    return syncFunc(client, address);\n}\n\nfunction doichain_feeDoi(client, address, callback) {\n    const destAddress = address;\n    client.cmd('sendtoaddress', destAddress, '0.02', function(err, data) {\n        callback(err, data);\n    });\n}\n\nexport function nameDoi(client, name, value, address) {\n    const syncFunc = Meteor.wrapAsync(doichain_nameDoi);\n    return syncFunc(client, name, value, address);\n}\n\nfunction doichain_nameDoi(client, name, value, address, callback) {\n    const ourName = checkId(name);\n    const ourValue = value;\n    const destAddress = address;\n    if(!address) {\n        client.cmd('name_doi', ourName, ourValue, function (err, data) {\n            callback(err, data);\n        });\n    }else{\n        client.cmd('name_doi', ourName, ourValue, destAddress, function(err, data) {\n            callback(err, data);\n        });\n    }\n}\n\nexport function listSinceBlock(client, block) {\n    const syncFunc = Meteor.wrapAsync(doichain_listSinceBlock);\n    var ourBlock = block;\n    if(ourBlock === undefined) ourBlock = null;\n    return syncFunc(client, ourBlock);\n}\n\nfunction doichain_listSinceBlock(client, block, callback) {\n    var ourBlock = block;\n    if(ourBlock === null) client.cmd('listsinceblock', function(err, data) {\n        callback(err, data);\n    });\n    else client.cmd('listsinceblock', ourBlock, function(err, data) {\n        callback(err, data);\n    });\n}\n\nexport function getTransaction(client, txid) {\n    const syncFunc = Meteor.wrapAsync(doichain_gettransaction);\n    return syncFunc(client, txid);\n}\n\nfunction doichain_gettransaction(client, txid, callback) {\n    logConfirm('doichain_gettransaction:',txid);\n    client.cmd('gettransaction', txid, function(err, data) {\n        if(err)  logError('doichain_gettransaction:',err);\n        callback(err, data);\n    });\n}\n\nexport function getRawTransaction(client, txid) {\n    const syncFunc = Meteor.wrapAsync(doichain_getrawtransaction);\n    return syncFunc(client, txid);\n}\n\nfunction doichain_getrawtransaction(client, txid, callback) {\n    logBlockchain('doichain_getrawtransaction:',txid);\n    client.cmd('getrawtransaction', txid, 1, function(err, data) {\n        if(err)  logError('doichain_getrawtransaction:',err);\n        callback(err, data);\n    });\n}\nexport function getBalance(client) {\n    const syncFunc = Meteor.wrapAsync(doichain_getbalance);\n    return syncFunc(client);\n}\n\nfunction doichain_getbalance(client, callback) {\n    client.cmd('getbalance', function(err, data) {\n        if(err) { logError('doichain_getbalance:',err);}\n        callback(err, data);\n    });\n}\n\nfunction checkId(id) {\n    const DOI_PREFIX = \"doi: \";\n    let ret_val = id; //default value\n\n    if(id.startsWith(DOI_PREFIX)) ret_val = id.substring(DOI_PREFIX.length); //in case it starts with doi: cut  this away\n    if(!id.startsWith(NAMESPACE)) ret_val = NAMESPACE+id; //in case it doesn't start with e/ put it in front now.\n  return ret_val;\n}\n","import { Meteor } from 'meteor/meteor';\nimport { HTTP } from 'meteor/http'\n\nexport function getHttpGET(url, query) {\n  const syncFunc = Meteor.wrapAsync(_get);\n  return syncFunc(url, query);\n}\n\nexport function getHttpGETdata(url, data) {\n    const syncFunc = Meteor.wrapAsync(_getData);\n    return syncFunc(url, data);\n}\n\nexport function getHttpPOST(url, data) {\n    const syncFunc = Meteor.wrapAsync(_post);\n    return syncFunc(url, data);\n}\n\nexport function getHttpPUT(url, data) {\n    const syncFunc = Meteor.wrapAsync(_put);\n    return syncFunc(url, data);\n}\n\nfunction _get(url, query, callback) {\n  const ourUrl = url;\n  const ourQuery = query;\n  HTTP.get(ourUrl, {query: ourQuery}, function(err, ret) {\n    callback(err, ret);\n  });\n}\n\nfunction _getData(url, data, callback) {\n    const ourUrl = url;\n    const ourData = data;\n    HTTP.get(ourUrl, ourData, function(err, ret) {\n        callback(err, ret);\n    });\n}\n\nfunction _post(url, data, callback) {\n    const ourUrl = url;\n    const ourData =  data;\n\n    HTTP.post(ourUrl, ourData, function(err, ret) {\n        callback(err, ret);\n    });\n}\n\nfunction _put(url, updateData, callback) {\n    const ourUrl = url;\n    const ourData = {\n        data: updateData\n    }\n\n    HTTP.put(ourUrl, ourData, function(err, ret) {\n      callback(err, ret);\n    });\n}\n","import './mail_jobs.js';\nimport './doichain.js';\nimport './blockchain_jobs.js';\nimport './dapp_jobs.js';\nimport './dns.js';\nimport './rest/rest.js';\n","import { Meteor } from 'meteor/meteor';\nimport { JobCollection, Job } from 'meteor/vsivsi:job-collection';\nexport const MailJobs = JobCollection('emails');\nimport sendMail from '../../imports/modules/server/emails/send.js';\nimport {logMain} from \"../../imports/startup/server/log-configuration\";\nimport {BlockchainJobs} from \"./blockchain_jobs\";\n\n\n\nMailJobs.processJobs('send', function (job, cb) {\n  try {\n    const email = job.data;\n    sendMail(email);\n    job.done();\n  } catch(exception) {\n    job.fail();\n    throw new Meteor.Error('jobs.mail.send.exception', exception);\n  } finally {\n    cb();\n  }\n});\n\n\nnew Job(MailJobs, 'cleanup', {})\n    .repeat({ schedule: MailJobs.later.parse.text(\"every 5 minutes\") })\n    .save({cancelRepeats: true})\n\nlet q = MailJobs.processJobs('cleanup',{ pollInterval: false, workTimeout: 60*1000 } ,function (job, cb) {\n    const current = new Date()\n    current.setMinutes(current.getMinutes() - 5);\n\n    const ids = MailJobs.find({\n            status: {$in: Job.jobStatusRemovable},\n            updated: {$lt: current}},\n        {fields: { _id: 1 }});\n\n    logMain('found  removable blockchain jobs:',ids);\n    MailJobs.removeJobs(ids);\n    if(ids.length > 0){\n        job.done(\"Removed #{ids.length} old jobs\");\n    }\n    cb();\n});\n\nMailJobs.find({ type: 'jobType', status: 'ready' })\n    .observe({\n        added: function () { q.trigger(); }\n    });\n\n","import '/imports/startup/server';\nimport './api/index.js';\n"]}